{"remainingRequest":"C:\\k1-services\\node_modules\\babel-loader\\lib\\index.js!C:\\k1-services\\src\\store\\anon.js","dependencies":[{"path":"C:\\k1-services\\src\\store\\anon.js","mtime":1670977910676},{"path":"C:\\k1-services\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1670977934221},{"path":"C:\\k1-services\\node_modules\\babel-loader\\lib\\index.js","mtime":1670977935138}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8gaW1wb3J0IFZ1ZSBmcm9tICJ2dWUiOwppbXBvcnQgSnd0U2VydmljZSBmcm9tICIuLi9zZXJ2aWNlcy9qd3Quc2VydmljZSI7CmltcG9ydCBBcGlTZXJ2aWNlIGZyb20gIi4uL3NlcnZpY2VzL2FwaS5zZXJ2aWNlIjsKaW1wb3J0IFZ1ZUNvb2tpZXMgZnJvbSAidnVlLWNvb2tpZXMiOwpsZXQgbHNBbm9uID0gSnd0U2VydmljZS5nZXRMb2dpbkFub24oKTsKaWYgKCFsc0Fub24pIGxzQW5vbiA9IHsKICB0b2tlbjogbnVsbCwKICBhdXRoOiBmYWxzZSwKICBsYXN0TG9naW46IG51bGwKfTsgLy8gc2UgZXN0w6EgZXhwaXJhZG8gbGltcGEgb3MgZGFkb3MgLi4uCgppZiAobHNBbm9uICYmIGxzQW5vbi52YWxpZGF0ZSA8IG5ldyBEYXRlKCkpIGxzQW5vbiA9IHsKICB0b2tlbjogbnVsbCwKICBhdXRoOiBmYWxzZSwKICBsYXN0TG9naW46IG51bGwKfTsKY29uc3Qgc3RhdGUgPSB7CiAgbG9naW5Bbm9uOiB7CiAgICB0b2tlbjogbHNBbm9uLnRva2VuIHx8IG51bGwsCiAgICBhdXRoOiBsc0Fub24uYXV0aCB8fCBmYWxzZSwKICAgIGxhc3RMb2dpbjogbHNBbm9uLmxhc3RMb2dpbiB8fCBudWxsLAogICAgdmFsaWRhdGU6IGxzQW5vbi52YWxpZGF0ZSB8fCBudWxsCiAgfQp9Owpjb25zdCBnZXR0ZXJzID0gewogIGd0eEFub25Ub2tlbjogc3RhdGUgPT4gc3RhdGUubG9naW5Bbm9uLnRva2VuLAogIGd0eGxvZ2luQW5vbjogc3RhdGUgPT4gc3RhdGUubG9naW5Bbm9uLAogIGd0eFN5c3RlbUFub25Ub2tlbjogc3RhdGUgPT4gc3RhdGUuc3lzdGVtLmFub25Ub2tlbgp9Owpjb25zdCBtdXRhdGlvbnMgPSB7CiAgc2V0TG9naW5Bbm9uOiAoc3RhdGUsIGp3dCkgPT4gewogICAgc3RhdGUubG9naW5Bbm9uLnRva2VuID0gand0ID8gand0LnRva2VuIHx8ICIiIDogIiI7CiAgICBzdGF0ZS5sb2dpbkFub24uYXV0aCA9IGp3dCA/IHRydWUgOiBmYWxzZTsKICAgIHN0YXRlLmxvZ2luQW5vbi5sYXN0TG9naW4gPSBuZXcgRGF0ZSgpOwogICAgc3RhdGUubG9naW5Bbm9uLnZhbGlkYXRlID0gand0ID8gbmV3IERhdGUoand0LmV4cCkgKiAxMDAwIDogMDsKICAgIHN0YXRlLmxvZ2luQW5vbi5wYXlsb2FkID0gand0ID8gand0LnBheWxvYWQgfHwgbnVsbCA6IG51bGw7IC8vIGNvbnNvbGUubG9nKCdzZXRMb2dpbkFub24nLCBzdGF0ZS5sb2dpbkFub24pCiAgfSwKICBzZXRMb2dpbkFub25PZmY6IHN0YXRlID0+IHsKICAgIHN0YXRlLmxvZ2luQW5vbi50b2tlbiA9ICIiOwogICAgc3RhdGUubG9naW5Bbm9uLmF1dGggPSBmYWxzZTsgLy8gcmVtb3ZlIG5vIGxvY2FsU3RvcmFnZSAuLi4KCiAgICBsb2NhbFN0b3JhZ2UucmVtb3ZlSXRlbSgibG9naW5Bbm9uIik7CiAgfSwKICBzZXRBbm9uVG9rZW46IHN0YXRlID0+IHsKICAgIHN0YXRlLnN5c3RlbS5hbm9uVG9rZW4gPSBBcGlTZXJ2aWNlLmdldCgiQXV0aGVudGljYXRpb24vR2V0QW5vbnltb3VzVG9rZW4iKS50aGVuKHRva2VuID0+IHRva2VuKTsKICB9Cn07CmNvbnN0IGFjdGlvbnMgPSB7CiAgYWN0TG9naW5Bbm9uOiBzdGF0ZSA9PiB7CiAgICBpZiAoIUp3dFNlcnZpY2UuaXNUb2tlblZhbGlkKEp3dFNlcnZpY2UuZ2V0QW5vblRva2VuKCkpKSB7CiAgICAgIEFwaVNlcnZpY2Uuc2V0QmFzaWNIZWFkZXIoKTsKICAgICAgQXBpU2VydmljZS5wb3N0KCJBdXRoZW50aWNhdGlvbi9HZXRBbm9ueW1vdXNUb2tlbiIpLnRoZW4ocmVzID0+IHsKICAgICAgICBsZXQgdG9rZW4gPSB7CiAgICAgICAgICB0b2tlbjogcmVzLmRhdGEuVG9rZW5BY2Nlc3MKICAgICAgICB9OwogICAgICAgIGxldCBwYXlsb2FkID0gSnd0U2VydmljZS5wYXJzZVBheWxvYWQocmVzLmRhdGEuVG9rZW5BY2Nlc3MpOwoKICAgICAgICBpZiAocGF5bG9hZCkgewogICAgICAgICAgdG9rZW4uZXhwID0gcGF5bG9hZC5leHA7CiAgICAgICAgICB0b2tlbi5wYXlsb2FkID0gcGF5bG9hZDsKICAgICAgICB9IC8vIGNvbnNvbGUubG9nKCdhY3RMb2dpbkFub246JywgdG9rZW4pCgoKICAgICAgICBzdGF0ZS5jb21taXQoInNldExvZ2luQW5vbiIsIHRva2VuKTsKICAgICAgICBBcGlTZXJ2aWNlLnNhdmVTdG9yZSgibG9naW5Bbm9uIiwgc3RhdGUuc3RhdGUubG9naW5Bbm9uKTsKICAgICAgfSkuY2F0Y2goZXJyb3IgPT4gewogICAgICAgIGNvbnNvbGUubG9nKCJlcnJvcjogIiwgZXJyb3IpOwogICAgICAgIHRocm93IG5ldyBFcnJvcihgW1ZVRVhdICR7ZXJyb3J9YCk7CiAgICAgIH0pOwogICAgfQogIH0sCiAgYWN0TG9naW5Bbm9uT2ZmOiBzdGF0ZSA9PiB7CiAgICBzdGF0ZS5jb21taXQoInNldExvZ2luQW5vbk9mZiIpOwogICAgbG9jYWxTdG9yYWdlLnJlbW92ZUl0ZW0oImxvZ2luQW5vbiIpOwogIH0sCiAgYWN0QW5vbkFwaTogc3RhdGUgPT4gewogICAgc3RhdGUuY29tbWl0KCJzZXRBbm9uVG9rZW4iKTsKICB9Cn07IC8vIGJ1c2NhIG8gdG9rZW4gYW5vbmltbyBuYSBpbnN0YWxhw6fDo28gLi4uCgpleHBvcnQgZGVmYXVsdCB7CiAgc3RhdGUsCiAgbXV0YXRpb25zLAogIGdldHRlcnMsCiAgYWN0aW9ucwp9Ow=="},{"version":3,"names":["JwtService","ApiService","VueCookies","lsAnon","getLoginAnon","token","auth","lastLogin","validate","Date","state","loginAnon","getters","gtxAnonToken","gtxloginAnon","gtxSystemAnonToken","system","anonToken","mutations","setLoginAnon","jwt","exp","payload","setLoginAnonOff","localStorage","removeItem","setAnonToken","get","then","actions","actLoginAnon","isTokenValid","getAnonToken","setBasicHeader","post","res","data","TokenAccess","parsePayload","commit","saveStore","catch","error","console","log","Error","actLoginAnonOff","actAnonApi"],"sources":["C:/k1-services/src/store/anon.js"],"sourcesContent":["// import Vue from \"vue\";\r\nimport JwtService from \"../services/jwt.service\";\r\nimport ApiService from \"../services/api.service\";\r\nimport VueCookies from \"vue-cookies\";\r\n\r\nlet lsAnon = JwtService.getLoginAnon();\r\nif (!lsAnon) lsAnon = { token: null, auth: false, lastLogin: null };\r\n\r\n// se está expirado limpa os dados ...\r\nif (lsAnon && lsAnon.validate < new Date())\r\n  lsAnon = { token: null, auth: false, lastLogin: null };\r\n\r\nconst state = {\r\n  loginAnon: {\r\n    token: lsAnon.token || null,\r\n    auth: lsAnon.auth || false,\r\n    lastLogin: lsAnon.lastLogin || null,\r\n    validate: lsAnon.validate || null,\r\n  },\r\n};\r\n\r\nconst getters = {\r\n  gtxAnonToken: (state) => state.loginAnon.token,\r\n\r\n  gtxloginAnon: (state) => state.loginAnon,\r\n\r\n  gtxSystemAnonToken: (state) => state.system.anonToken,\r\n};\r\n\r\nconst mutations = {\r\n  setLoginAnon: (state, jwt) => {\r\n    state.loginAnon.token = jwt ? jwt.token || \"\" : \"\";\r\n    state.loginAnon.auth = jwt ? true : false;\r\n    state.loginAnon.lastLogin = new Date();\r\n    state.loginAnon.validate = jwt ? new Date(jwt.exp) * 1000 : 0;\r\n    state.loginAnon.payload = jwt ? jwt.payload || null : null;\r\n\r\n    // console.log('setLoginAnon', state.loginAnon)\r\n  },\r\n\r\n  setLoginAnonOff: (state) => {\r\n    state.loginAnon.token = \"\";\r\n    state.loginAnon.auth = false;\r\n\r\n    // remove no localStorage ...\r\n    localStorage.removeItem(\"loginAnon\");\r\n  },\r\n\r\n  setAnonToken: (state) => {\r\n    state.system.anonToken = ApiService.get(\r\n      \"Authentication/GetAnonymousToken\"\r\n    ).then((token) => token);\r\n  },\r\n};\r\n\r\nconst actions = {\r\n  actLoginAnon: (state) => {\r\n    if (!JwtService.isTokenValid(JwtService.getAnonToken())) {\r\n      ApiService.setBasicHeader();\r\n      ApiService.post(\"Authentication/GetAnonymousToken\")\r\n        .then((res) => {\r\n          let token = { token: res.data.TokenAccess };\r\n\r\n          let payload = JwtService.parsePayload(res.data.TokenAccess);\r\n\r\n          if (payload) {\r\n            token.exp = payload.exp;\r\n            token.payload = payload;\r\n          }\r\n\r\n          // console.log('actLoginAnon:', token)\r\n\r\n          state.commit(\"setLoginAnon\", token);\r\n\r\n          ApiService.saveStore(\"loginAnon\", state.state.loginAnon);\r\n        })\r\n        .catch((error) => {\r\n          console.log(\"error: \", error);\r\n\r\n          throw new Error(`[VUEX] ${error}`);\r\n        });\r\n    }\r\n  },\r\n\r\n  actLoginAnonOff: (state) => {\r\n    state.commit(\"setLoginAnonOff\");\r\n    localStorage.removeItem(\"loginAnon\");\r\n  },\r\n\r\n  actAnonApi: (state) => {\r\n    state.commit(\"setAnonToken\");\r\n  },\r\n};\r\n\r\n// busca o token anonimo na instalação ...\r\n\r\nexport default { state, mutations, getters, actions };\r\n"],"mappings":"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"}]}