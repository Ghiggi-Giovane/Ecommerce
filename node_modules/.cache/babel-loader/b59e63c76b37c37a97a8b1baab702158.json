{"remainingRequest":"C:\\k1-services\\node_modules\\babel-loader\\lib\\index.js!C:\\k1-services\\node_modules\\cache-loader\\dist\\cjs.js??ref--1-0!C:\\k1-services\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\k1-services\\src\\pages\\consultas\\views\\index.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\k1-services\\src\\pages\\consultas\\views\\index.vue","mtime":1670977910613},{"path":"C:\\k1-services\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1670977934221},{"path":"C:\\k1-services\\node_modules\\babel-loader\\lib\\index.js","mtime":1670977935138},{"path":"C:\\k1-services\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1670977934221},{"path":"C:\\k1-services\\node_modules\\vue-loader\\lib\\index.js","mtime":1670977935327}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KaW1wb3J0IEFQSSBmcm9tICIuLi8uLi8uLi9zZXJ2aWNlcy9hcGkuc2VydmljZSI7CmltcG9ydCBQYXJhbXMgZnJvbSAiLi4vY29tcG9uZW50cy9wYXJhbXMiOwppbXBvcnQgUmVzdWx0UXVlcnkgZnJvbSAiLi4vY29tcG9uZW50cy9yZXN1bHRxdWVyeSI7CmV4cG9ydCBkZWZhdWx0IHsKICBuYW1lOiAiY29uc3VsdGFzIiwKICBjb21wb25lbnRzOiB7CiAgICBQYXJhbXMsCiAgICBSZXN1bHRRdWVyeQogIH0sCgogIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICBjb25zdWx0YXM6IHsKICAgICAgICBmaWx0cm86ICIiLAogICAgICAgIHNlbGVjdGVkOiBudWxsLAogICAgICAgIGRhdGE6IFtdCiAgICAgIH0KICAgIH07CiAgfSwKCiAgY29tcHV0ZWQ6IHsKICAgIGNvbnN1bHRhc3NlbGVjdGVkKCkgewogICAgICByZXR1cm4gdGhpcy5jb25zdWx0YXMgPyB0aGlzLmNvbnN1bHRhcy5zZWxlY3RlZCA6ICIiOwogICAgfSwKCiAgICBjb25zdWx0YXNoZWFkZXIoKSB7CiAgICAgIGxldCByZXQgPSB7CiAgICAgICAgbmFtZTogbnVsbCwKICAgICAgICBjYXB0aW9uOiBudWxsLAogICAgICAgIHNlc3Npb246IG51bGwsCiAgICAgICAgaWNvbjogbnVsbCwKICAgICAgICBpZDogbnVsbAogICAgICB9OwoKICAgICAgaWYgKHRoaXMuY29uc3VsdGFzc2VsZWN0ZWQpIHsKICAgICAgICByZXQubmFtZSA9IHRoaXMuY29uc3VsdGFzc2VsZWN0ZWQubmFtZTsKICAgICAgICByZXQuY2FwdGlvbiA9IHRoaXMuY29uc3VsdGFzc2VsZWN0ZWQuY2FwdGlvbjsKICAgICAgICByZXQuc2Vzc2lvbiA9IHRoaXMuY29uc3VsdGFzc2VsZWN0ZWQuc2Vzc2lvbjsKICAgICAgICByZXQuaWNvbiA9IHRoaXMuY29uc3VsdGFzc2VsZWN0ZWQuaWNvbjsKICAgICAgICByZXQuaWQgPSB0aGlzLmNvbnN1bHRhc3NlbGVjdGVkLmlkOwogICAgICB9CgogICAgICByZXR1cm4gcmV0OwogICAgfSwKCiAgICBjb25zdWx0YXNhcGkoKSB7CiAgICAgIHJldHVybiB0aGlzLmNvbnN1bHRhc3NlbGVjdGVkID8gYHYyL1NlcnZpY29zL0NPTlNfLyR7dGhpcy5jb25zdWx0YXNzZWxlY3RlZC5uYW1lfWAgOiAiIjsKICAgIH0sCgogICAgY29uc3VsdGFzcGFyYW1zKCkgewogICAgICBpZiAodGhpcy5jb25zdWx0YXNzZWxlY3RlZCkgewogICAgICAgIGxldCByZXQgPSB7fTsKICAgICAgICB0aGlzLmNvbnN1bHRhc3NlbGVjdGVkLnBhcmFtcy5tYXAocCA9PiB7CiAgICAgICAgICByZXQgPSB7IC4uLnJldCwKICAgICAgICAgICAgLi4uewogICAgICAgICAgICAgIFtwLm5hbWUucmVwbGFjZSgiQCIsICIiKV06IHAudmFsdWUKICAgICAgICAgICAgfQogICAgICAgICAgfTsKICAgICAgICB9KTsKICAgICAgICByZXR1cm4gcmV0OwogICAgICB9IGVsc2UgewogICAgICAgIHJldHVybiB7fTsKICAgICAgfQogICAgfSwKCiAgICBjb25zdWx0YXNsaXN0KCkgewogICAgICByZXR1cm4gdGhpcy5jb25zdWx0YXMuZGF0YS5maWx0ZXIoZiA9PiB0aGlzLmNvbnN1bHRhcy5maWx0cm8gPT0gIiIgfHwgZi5uYW1lLnRvVXBwZXJDYXNlKCkuaW5jbHVkZXModGhpcy5jb25zdWx0YXMuZmlsdHJvLnRvVXBwZXJDYXNlKCkpIHx8IGYuY2FwdGlvbiAmJiBmLmNhcHRpb24udG9VcHBlckNhc2UoKS5pbmNsdWRlcyh0aGlzLmNvbnN1bHRhcy5maWx0cm8udG9VcHBlckNhc2UoKSkpOwogICAgfQoKICB9LAoKICBiZWZvcmVNb3VudCgpIHsKICAgIHRoaXMuY29uc3V0YXNHZXQoKTsKICB9LAoKICBtZXRob2RzOiB7CiAgICBzY3JvbGxNZVRvKHJlZk5hbWUpIHsKICAgICAgY29uc29sZS5sb2coInNjcm9sbE1lVG8iKTsKICAgICAgbGV0IGVsZW1lbnQgPSB0aGlzLiRyZWZzW3JlZk5hbWVdOwogICAgICBlbGVtZW50LnNjcm9sbEludG9WaWV3KHsKICAgICAgICBiZWhhdmlvcjogInNtb290aCIKICAgICAgfSk7CiAgICB9LAoKICAgIGNvbnN1bHRhc3NlbGVjdGVkYWRkKGNvbnMpIHsKICAgICAgdGhpcy5jb25zdWx0YXMuc2VsZWN0ZWQgPSBjb25zOwogICAgICB0aGlzLmNvbnN1bHRhcy5zZWxlY3RlZC5wYXJhbXMubWFwKHBhcmFtID0+IHsKICAgICAgICBBUEkubG9jYWxEQi5jb2xsZWN0aW9uKHRoaXMuY29uc3VsdGFzc2VsZWN0ZWQubmFtZSkuZG9jKHBhcmFtLm5hbWUpLmdldCgpLnRoZW4ocCA9PiB7CiAgICAgICAgICBpZiAocCkgcGFyYW0udmFsdWUgPSBwLnZhbHVlOwogICAgICAgIH0pOwogICAgICB9KTsKICAgIH0sCgogICAgY29uc3V0YXNHZXQoKSB7CiAgICAgIEFQSS5nZXQoInYyL1NlcnZpY29zL0NPTlNfQ29uc3VsdGFzL1VzdWFyaW8iLCB0aGlzLnBhcmFtcykudGhlbihyZXMgPT4gewogICAgICAgIGlmIChyZXMuZGF0YS5TdWNjZXNzKSB7CiAgICAgICAgICB0aGlzLmNvbnN1bHRhcy5kYXRhID0gcmVzLmRhdGEuRGF0YTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgdGhpcy5jb25zdWx0YXMuZGF0YSA9IFtdOwogICAgICAgIH0KICAgICAgfSk7CiAgICB9LAoKICAgIGNvbnN1bHRhc2V4ZWMoKSB7CiAgICAgIHRoaXMuY29uc3VsdGFzc2VsZWN0ZWQucGFyYW1zLm1hcChwID0+IHsKICAgICAgICBBUEkubG9jYWxEQi5jb2xsZWN0aW9uKHRoaXMuY29uc3VsdGFzc2VsZWN0ZWQubmFtZSkuYWRkKHsKICAgICAgICAgIHZhbHVlOiBwLnZhbHVlCiAgICAgICAgfSwgcC5uYW1lKTsKICAgICAgfSk7CiAgICAgIHRoaXMuJGJ2TW9kYWwuc2hvdygibW9kYWwtcmVzdWx0Iik7CiAgICB9CgogIH0KfTs="},{"version":3,"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA2GA;AACA;AACA;AACA;EACAA,iBADA;EAEAC;IACAC,MADA;IAEAC;EAFA,CAFA;;EAMAC;IACA;MACAC;QACAC,UADA;QAEAC,cAFA;QAGAH;MAHA;IADA;EAOA,CAdA;;EAeAI;IACAC;MACA;IACA,CAHA;;IAIAC;MACA;QACAV,UADA;QAEAW,aAFA;QAGAC,aAHA;QAIAC,UAJA;QAKAC;MALA;;MAOA;QACAC;QACAA;QACAA;QACAA;QACAA;MACA;;MACA;IACA,CApBA;;IAqBAC;MACA,gCACA,kDADA,GAEA,EAFA;IAGA,CAzBA;;IA0BAC;MACA;QACA;QACA;UACAF;YAAA;cAAA;YAAA;UAAA;QACA,CAFA;QAGA;MACA,CANA,MAMA;QACA;MACA;IACA,CApCA;;IAqCAG;MACA,kCACAC,KACA,+BACAA,kEADA,IAEAA,aACAA,UACAC,WADA,GAEAC,QAFA,CAEA,mCAFA,CALA;IASA;;EA/CA,CAfA;;EAgEAC;IACA;EACA,CAlEA;;EAmEAC;IACAC;MACAC;MACA;MACAC;QAAAC;MAAA;IACA,CALA;;IAMAC;MACA;MAEA;QACAC,YACAC,UADA,CACA,2BADA,EAEAC,GAFA,CAEAC,UAFA,EAGAC,GAHA,GAIAC,IAJA,CAIAC;UACA;QACA,CANA;MAOA,CARA;IASA,CAlBA;;IAmBAC;MACAP;QACA;UACA;QACA,CAFA,MAEA;UACA;QACA;MACA,CANA;IAOA,CA3BA;;IA4BAQ;MACA;QACAR,YACAC,UADA,CACA,2BADA,EAEAQ,GAFA,CAEA;UAAAC;QAAA,CAFA,EAEAJ,MAFA;MAGA,CAJA;MAKA;IACA;;EAnCA;AAnEA","names":["name","components","Params","ResultQuery","data","consultas","filtro","selected","computed","consultasselected","consultasheader","caption","session","icon","id","ret","consultasapi","consultasparams","consultaslist","f","toUpperCase","includes","beforeMount","methods","scrollMeTo","console","element","behavior","consultasselectedadd","API","collection","doc","param","get","then","p","consutasGet","consultasexec","add","value"],"sourceRoot":"src/pages/consultas/views","sources":["index.vue"],"sourcesContent":["<template>\r\n  <div>\r\n    <b-card class=\"m-2\">\r\n      <h1>Consultas</h1>\r\n      <b-row>\r\n        <b-col>\r\n          <b-input-group prepend=\"Filtro\" size=\"sm\" class=\"mb-2\">\r\n            <b-form-input\r\n              id=\"input-filtro\"\r\n              type=\"search\"\r\n              v-model=\"consultas.filtro\"\r\n              placeholder=\"Informe o nome da consulta\"\r\n            ></b-form-input>\r\n          </b-input-group>\r\n        </b-col>\r\n      </b-row>\r\n      <b-row>\r\n        <b-col>\r\n          <b-list-group>\r\n            <b-list-group-item\r\n              v-for=\"cons of consultaslist\"\r\n              :key=\"cons.id\"\r\n              :ref=\"`_${cons.id}`\"\r\n              :active=\"consultasselected == cons\"\r\n              href=\"#\"\r\n              class=\"flex-column align-items-start\"\r\n            >\r\n              <div\r\n                class=\"d-flex w-100 justify-content-between\"\r\n                v-b-toggle=\"`par_${cons.id}`\"\r\n                @click=\"consultasselectedadd(cons)\"\r\n              >\r\n                <h5>\r\n                  <b-icon :icon=\"cons.icon || 'question-square'\" />\r\n                  {{ cons.caption || cons.name }}\r\n                </h5>\r\n                <!-- <small>\r\n                  <b-badge\r\n                    variant=\"light\"\r\n                    @click.stop.prevent=\"$bvModal.show('modal-details')\"\r\n                  >\r\n                    detalhes\r\n                  </b-badge>\r\n                </small> -->\r\n              </div>\r\n\r\n              <!-- parametros da consulta -->\r\n              <b-collapse :id=\"`par_${cons.id}`\" @shown=\"\">\r\n                <b-card class=\"text-dark\">\r\n                  <Params v-model=\"cons.params\" />\r\n                  <b-button variant=\"primary\" @click=\"consultasexec\"\r\n                    >Pesquisar</b-button\r\n                  >\r\n                  <b-button\r\n                    variant=\"secondary\"\r\n                    @click.stop.prevent=\"$bvModal.show('modal-details')\"\r\n                    >Detalhes</b-button\r\n                  >\r\n                </b-card>\r\n              </b-collapse>\r\n            </b-list-group-item>\r\n          </b-list-group>\r\n        </b-col>\r\n      </b-row>\r\n    </b-card>\r\n\r\n    <!-- MODAIS -->\r\n    <b-modal\r\n      id=\"modal-result\"\r\n      ref=\"modal-result\"\r\n      size=\"xl\"\r\n      :title=\"consultasheader.caption\"\r\n      header-bg-variant=\"primary\"\r\n      header-text-variant=\"light\"\r\n    >\r\n      <ResultQuery\r\n        :api=\"consultasapi\"\r\n        :params=\"consultasparams\"\r\n        :consulta=\"consultasheader\"\r\n      />\r\n    </b-modal>\r\n\r\n    <b-modal\r\n      id=\"modal-details\"\r\n      ref=\"modal-details\"\r\n      size=\"md\"\r\n      :title=\"consultasheader.caption\"\r\n      header-bg-variant=\"primary\"\r\n      header-text-variant=\"light\"\r\n    >\r\n      <div class=\"mb-1\" v-if=\"consultasselected\">\r\n        <p>#ID: {{ consultasselected.id }}</p>\r\n        <p>Nome: {{ consultasselected.name }}</p>\r\n        <p>Caption: {{ consultasselected.caption }}</p>\r\n        <p>Session: {{ consultasselected.session }}</p>\r\n        <p>Icon: {{ consultasselected.icon }}</p>\r\n        <small>{{ consultasselected.session }}</small>\r\n      </div>\r\n      <div v-else>\r\n        <p>Nenhuma consulta selecionada...</p>\r\n        consultasselected: {{ consultasselected }}\r\n      </div>\r\n    </b-modal>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport API from \"../../../services/api.service\";\r\nimport Params from \"../components/params\";\r\nimport ResultQuery from \"../components/resultquery\";\r\nexport default {\r\n  name: \"consultas\",\r\n  components: {\r\n    Params,\r\n    ResultQuery,\r\n  },\r\n  data() {\r\n    return {\r\n      consultas: {\r\n        filtro: \"\",\r\n        selected: null,\r\n        data: [],\r\n      },\r\n    };\r\n  },\r\n  computed: {\r\n    consultasselected() {\r\n      return this.consultas ? this.consultas.selected : \"\";\r\n    },\r\n    consultasheader() {\r\n      let ret = {\r\n        name: null,\r\n        caption: null,\r\n        session: null,\r\n        icon: null,\r\n        id: null,\r\n      };\r\n      if (this.consultasselected) {\r\n        ret.name = this.consultasselected.name;\r\n        ret.caption = this.consultasselected.caption;\r\n        ret.session = this.consultasselected.session;\r\n        ret.icon = this.consultasselected.icon;\r\n        ret.id = this.consultasselected.id;\r\n      }\r\n      return ret;\r\n    },\r\n    consultasapi() {\r\n      return this.consultasselected\r\n        ? `v2/Servicos/CONS_/${this.consultasselected.name}`\r\n        : \"\";\r\n    },\r\n    consultasparams() {\r\n      if (this.consultasselected) {\r\n        let ret = {};\r\n        this.consultasselected.params.map((p) => {\r\n          ret = { ...ret, ...{ [p.name.replace(\"@\", \"\")]: p.value } };\r\n        });\r\n        return ret;\r\n      } else {\r\n        return {};\r\n      }\r\n    },\r\n    consultaslist() {\r\n      return this.consultas.data.filter(\r\n        (f) =>\r\n          this.consultas.filtro == \"\" ||\r\n          f.name.toUpperCase().includes(this.consultas.filtro.toUpperCase()) ||\r\n          (f.caption &&\r\n            f.caption\r\n              .toUpperCase()\r\n              .includes(this.consultas.filtro.toUpperCase()))\r\n      );\r\n    },\r\n  },\r\n  beforeMount() {\r\n    this.consutasGet();\r\n  },\r\n  methods: {\r\n    scrollMeTo(refName) {\r\n      console.log(\"scrollMeTo\");\r\n      let element = this.$refs[refName];\r\n      element.scrollIntoView({ behavior: \"smooth\" });\r\n    },\r\n    consultasselectedadd(cons) {\r\n      this.consultas.selected = cons;\r\n\r\n      this.consultas.selected.params.map((param) => {\r\n        API.localDB\r\n          .collection(this.consultasselected.name)\r\n          .doc(param.name)\r\n          .get()\r\n          .then((p) => {\r\n            if (p) param.value = p.value;\r\n          });\r\n      });\r\n    },\r\n    consutasGet() {\r\n      API.get(\"v2/Servicos/CONS_Consultas/Usuario\", this.params).then((res) => {\r\n        if (res.data.Success) {\r\n          this.consultas.data = res.data.Data;\r\n        } else {\r\n          this.consultas.data = [];\r\n        }\r\n      });\r\n    },\r\n    consultasexec() {\r\n      this.consultasselected.params.map((p) => {\r\n        API.localDB\r\n          .collection(this.consultasselected.name)\r\n          .add({ value: p.value }, p.name);\r\n      });\r\n      this.$bvModal.show(\"modal-result\");\r\n    },\r\n  },\r\n};\r\n</script>\r\n"]}]}