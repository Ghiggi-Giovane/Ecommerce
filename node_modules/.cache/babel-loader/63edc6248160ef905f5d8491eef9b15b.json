{"remainingRequest":"C:\\k1-services\\node_modules\\babel-loader\\lib\\index.js!C:\\k1-services\\node_modules\\cache-loader\\dist\\cjs.js??ref--1-0!C:\\k1-services\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\k1-services\\src\\components\\ExportFile.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\k1-services\\src\\components\\ExportFile.vue","mtime":1701906516400},{"path":"C:\\k1-services\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1670977934221},{"path":"C:\\k1-services\\node_modules\\babel-loader\\lib\\index.js","mtime":1670977935138},{"path":"C:\\k1-services\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1670977934221},{"path":"C:\\k1-services\\node_modules\\vue-loader\\lib\\index.js","mtime":1674603023821}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuc3RyaW5nLnJlcGxhY2UtYWxsLmpzIjsKLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmV4cG9ydCBkZWZhdWx0IHsKICBuYW1lOiAiRXhwb3J0RmlsZSIsCiAgZGF0YSgpIHsKICAgIHJldHVybiB7CiAgICAgIHRlbXBsYXRlczogW10sCiAgICAgIHRlbXBsYXRlbmFtZTogIiIsCiAgICAgIHRlbXBsYXRlc2VsZWN0ZWQ6IG51bGwsCiAgICAgIGFkZGZsZDogIiIsCiAgICAgIHNlcDogdGhpcy52YWx1ZS5zZXAsCiAgICAgIGZsZDogdGhpcy52YWx1ZS5mbGQsCiAgICAgIHF1b3RlZDogdGhpcy52YWx1ZS5xdW90ZWQsCiAgICAgIHdoZWFkOiB0aGlzLnZhbHVlLndoZWFkLAogICAgICBjc3ZzdHJlYW06IHRoaXMudmFsdWUuY3N2c3RyZWFtLAogICAgICBmaWxlbmFtZTogdGhpcy52YWx1ZS5maWxlbmFtZSwKICAgICAgZGF0YTogdGhpcy52YWx1ZS5kYXRhCiAgICB9OwogIH0sCiAgcHJvcHM6IHsKICAgIHZhbHVlOiB7CiAgICAgIHR5cGU6IE9iamVjdCwKICAgICAgZGVmYXVsdDogewogICAgICAgIHNlcDogIjsiLAogICAgICAgIGZsZDogbnVsbCwKICAgICAgICBxdW90ZWQ6ICIiLAogICAgICAgIHdoZWFkOiBmYWxzZSwKICAgICAgICBmaWxlbmFtZTogImRhdGEuZGF0IiwKICAgICAgICBjc3ZzdHJlYW06ICIiLAogICAgICAgIGRhdGE6IFtdCiAgICAgIH0KICAgIH0KICB9LAogIGNvbXB1dGVkOiB7CiAgICBsY2FiZWNhbGhvKCkgewogICAgICByZXR1cm4gdGhpcy53aGVhZCA/ICJWaXPDrXZlbCIgOiAiT2N1bHRvIjsKICAgIH0sCiAgICBmaWVsZHMoKSB7CiAgICAgIHJldHVybiBPYmplY3Qua2V5cyh0aGlzLmRhdGFbMF0pLmZpbHRlcihmID0+IHRoaXMuZmxkLmluZGV4T2YoZikgPT09IC0xKTsKICAgIH0sCiAgICBhdmFpbGFibGVPcHRpb25zKCkgewogICAgICByZXR1cm4gdGhpcy5maWVsZHMuZmlsdGVyKG9wdCA9PiB0aGlzLmZsZC5pbmRleE9mKG9wdCkgPT09IC0xKTsKICAgIH0sCiAgICBzZXBhcmF0b3JzKCkgewogICAgICByZXR1cm4gWyIiLCAiLCIsICI7IiwgInwiXTsKICAgIH0sCiAgICBlbWl0bW9kYWwoKSB7CiAgICAgIHJldHVybiB7CiAgICAgICAgc2VwOiB0aGlzLnNlcCwKICAgICAgICBmbGQ6IHRoaXMuZmxkLAogICAgICAgIHF1b3RlZDogdGhpcy5xdW90ZWQsCiAgICAgICAgd2hlYWQ6IHRoaXMud2hlYWQsCiAgICAgICAgZmlsZW5hbWU6IHRoaXMuZmlsZW5hbWUsCiAgICAgICAgZGF0YTogdGhpcy5kYXRhCiAgICAgIH07CiAgICB9LAogICAgdGVtcGxhdGVtb2RlbCgpIHsKICAgICAgcmV0dXJuIHsKICAgICAgICBzZXA6IHRoaXMuc2VwLAogICAgICAgIGZsZDogdGhpcy5mbGQsCiAgICAgICAgcXVvdGVkOiB0aGlzLnF1b3RlZCwKICAgICAgICB3aGVhZDogdGhpcy53aGVhZAogICAgICB9OwogICAgfSwKICAgIHRlbXBsYXRlc29wdGlvbnMoKSB7CiAgICAgIGNvbnN0IHRlbXBsYXRlID0gdGhpcy50ZW1wbGF0ZXMubGVuZ3RoID4gMCA/IHRoaXMudGVtcGxhdGVzLm1hcChtID0+ICh7CiAgICAgICAgdmFsdWU6IG0ubm9tZSwKICAgICAgICB0ZXh0OiBtLm5vbWUKICAgICAgfSkpIDogW107CiAgICAgIHRlbXBsYXRlLnVuc2hpZnQoewogICAgICAgIHZhbHVlOiAibmV3IHRlbXBsYXRlIiwKICAgICAgICB0ZXh0OiAiTm92byBNb2RlbG8iCiAgICAgIH0pOwogICAgICByZXR1cm4gdGVtcGxhdGU7CiAgICB9LAogICAgY3N2c2FtcGxlKCkgewogICAgICByZXR1cm4gdGhpcy5kYXRhLmxlbmd0aCA+IDAgPyB0aGlzLmpzb24yY3N2KHRoaXMuZGF0YS5maWx0ZXIoKGYsIGkpID0+IGkgPCA1KSwgdGhpcy5mbGQsIHRoaXMuc2VwLCB0aGlzLnF1b3RlZCwgdGhpcy53aGVhZCkgOiAiIjsKICAgIH0KICB9LAogIHdhdGNoOiB7CiAgICBlbWl0bW9kYWw6IHsKICAgICAgZGVlcDogdHJ1ZSwKICAgICAgaGFuZGxlcihkYXRhKSB7CiAgICAgICAgdGhpcy5leHBvcnRhKGRhdGEpOwogICAgICB9CiAgICB9LAogICAgdGVtcGxhdGVzZWxlY3RlZChub21lKSB7CiAgICAgIGNvbnN0IHRlbXBsYXRlID0gdGhpcy50ZW1wbGF0ZXMuZmluZChmID0+IGYubm9tZSA9PSBub21lKTsKICAgICAgaWYgKHRlbXBsYXRlKSB7CiAgICAgICAgdGhpcy5mbGQgPSB0ZW1wbGF0ZS5mbGQ7CiAgICAgICAgdGhpcy5zZXAgPSB0ZW1wbGF0ZS5zZXA7CiAgICAgICAgdGhpcy5xdW90ZWQgPSB0ZW1wbGF0ZS5xdW90ZWQ7CiAgICAgICAgdGhpcy53aGVhZCA9IHRlbXBsYXRlLndoZWFkOwogICAgICAgIHRoaXMudGVtcGxhdGVuYW1lID0gbm9tZTsKICAgICAgfQogICAgfQogIH0sCiAgYmVmb3JlTW91bnQoKSB7CiAgICBsZXQgdGVtcGxhdGVzID0gbG9jYWxTdG9yYWdlLmdldEl0ZW0oInRlbXBsYXRlc2V4cG9ydCIpOwogICAgaWYgKHRlbXBsYXRlcyAmJiB0ZW1wbGF0ZXMgIT09ICIiKSB7CiAgICAgIHRoaXMudGVtcGxhdGVzID0gSlNPTi5wYXJzZSh0ZW1wbGF0ZXMpLmZpbHRlcihmID0+IGYpOwogICAgfQogICAgdGhpcy51cGRhdGVjc3YoKTsKICB9LAogIG1ldGhvZHM6IHsKICAgIHVwZGF0ZWNzdigpIHsKICAgICAgdGhpcy5jc3ZzdHJlYW0gPSB0aGlzLmpzb24yY3N2KHRoaXMuZGF0YSwgdGhpcy5mbGQsIHRoaXMuc2VwLCB0aGlzLnF1b3RlZCwgdGhpcy53aGVhZCk7CiAgICB9LAogICAgZXhwb3J0YShkYXRhKSB7CiAgICAgIHRoaXMudXBkYXRlY3N2KCk7CiAgICAgIGNvbnN0IGVtaXRkYXRhID0gewogICAgICAgIC4uLmRhdGEsCiAgICAgICAgLi4uewogICAgICAgICAgY3N2c3RyZWFtOiB0aGlzLmNzdnN0cmVhbQogICAgICAgIH0KICAgICAgfTsKICAgICAgdGhpcy4kZW1pdCgiaW5wdXQiLCBlbWl0ZGF0YSk7CiAgICB9LAogICAgZG93bmxvYWQoKSB7CiAgICAgIHRoaXMuZG93bmxvYWRTdHJpbmcodGhpcy5jc3ZzdHJlYW0sIHRoaXMuZmlsZW5hbWUpOwogICAgfSwKICAgIGpzb24yY3N2KG9iaiwgZmxkID0gbnVsbCwgc2VwID0gIjsiLCBxdW90ZWQgPSAiIiwgd2hlYWQgPSB0cnVlKSB7CiAgICAgIGNvbnN0IHJlcGxhY2VyID0gKGtleSwgdmFsdWUpID0+IHZhbHVlID09PSBudWxsID8gIiIgOiB2YWx1ZTsgLy8gc3BlY2lmeSBob3cgeW91IHdhbnQgdG8gaGFuZGxlIG51bGwgdmFsdWVzIGhlcmUKICAgICAgbGV0IGhlYWRlciA9IE9iamVjdC5rZXlzKG9ialswXSk7CiAgICAgIGlmIChBcnJheS5pc0FycmF5KGZsZCkgJiYgZmxkLmxlbmd0aCA+IDApIHsKICAgICAgICBoZWFkZXIgPSBmbGQ7CiAgICAgIH0KICAgICAgbGV0IGNzdiA9IFsuLi5vYmoubWFwKHJvdyA9PiBoZWFkZXIubWFwKGZpZWxkTmFtZSA9PiBxdW90ZWQgKyBKU09OLnN0cmluZ2lmeShyb3dbZmllbGROYW1lXSwgcmVwbGFjZXIpLnJlcGxhY2VBbGwoJyInLCAiIikgKyBxdW90ZWQpLmpvaW4oc2VwKSArIHNlcCldLmpvaW4oIlxyXG4iKTsKICAgICAgaWYgKHdoZWFkKSBjc3YgPSBoZWFkZXIuam9pbihzZXApICsgc2VwICsgIlxyXG4iICsgY3N2OwoKICAgICAgLy8gY29uc29sZS5sb2coImpzb24yY3N2Lm9iajoiLCBvYmopOwogICAgICAvLyBjb25zb2xlLmxvZygianNvbjJjc3YuZmxkOiIsIGZsZCk7CiAgICAgIC8vIGNvbnNvbGUubG9nKCJqc29uMmNzdi5zZXA6Iiwgc2VwKTsKICAgICAgLy8gY29uc29sZS5sb2coImpzb24yY3N2LnF1b3RlZDoiLCBxdW90ZWQpOwogICAgICAvLyBjb25zb2xlLmxvZygianNvbjJjc3Yud2hlYWQ6Iiwgd2hlYWQpOwogICAgICAvLyBjb25zb2xlLmxvZygianNvbjJjc3YuY3N2OiIsIGNzdi5zdWJzdHJpbmcoMCwgMTAwKSk7CgogICAgICByZXR1cm4gY3N2OwogICAgfSwKICAgIGRvd25sb2FkU3RyaW5nKHN0ckNvbnRlbnQsIGZpbGVOYW1lKSB7CiAgICAgIGlmICghZmlsZU5hbWUpIGZpbGVOYW1lID0gTWF0aC5yYW5kb20oKS50b1N0cmluZygzNikuc3BsaXQoIi4iKVsxXSArICIuZGF0IjsKICAgICAgLy8gdmFyIGVuY29kZWRVcmkgPSBlbmNvZGVVUkkoc3RyQ29udGVudCk7CiAgICAgIHZhciBlbmNvZGVkVXJpID0gZW5jb2RlVVJJQ29tcG9uZW50KHN0ckNvbnRlbnQpOwogICAgICB2YXIgbGluayA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoImEiKTsKICAgICAgbGluay5zZXRBdHRyaWJ1dGUoImhyZWYiLCAiZGF0YTp0ZXh0L3BsYWluO2NoYXJzZXQ9dXRmLTgsIiArIGVuY29kZWRVcmkpOwogICAgICBsaW5rLnNldEF0dHJpYnV0ZSgiZG93bmxvYWQiLCBmaWxlTmFtZSk7CiAgICAgIGxpbmsuc3R5bGUuZGlzcGxheSA9ICJub25lIjsKICAgICAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChsaW5rKTsgLy8gUmVxdWlyZWQgZm9yIEZGCgogICAgICBsaW5rLmNsaWNrKCk7IC8vIFRoaXMgd2lsbCBkb3dubG9hZCB0aGUgZGF0YSBmaWxlIG5hbWVkICJteV9kYXRhLmNzdiIuCgogICAgICB0aGlzLiRyb290LnRvYXN0c3VjY2VzcygiQXJxdWl2byBnZXJhZG8gY29tIHN1Y2Vzc28gISIpOwogICAgICBkb2N1bWVudC5ib2R5LnJlbW92ZUNoaWxkKGxpbmspOwogICAgfSwKICAgIHNhbHZhcigpIHsKICAgICAgaWYgKHRoaXMudGVtcGxhdGVzZWxlY3RlZCA9PSAibmV3IHRlbXBsYXRlIikgewogICAgICAgIHRoaXMudGVtcGxhdGVuYW1lID0gIiI7CiAgICAgICAgdGhpcy4kcmVmc1sibW9kYWwtdGVtcGxhdGUiXS5zaG93KCk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgaWYgKHRoaXMudGVtcGxhdGVuYW1lICE9PSAiIikgewogICAgICAgICAgdGhpcy5zYXZldGVtcGxhdGUoKTsKICAgICAgICB9CiAgICAgIH0KICAgIH0sCiAgICBzYXZldGVtcGxhdGUoKSB7CiAgICAgIGNvbnN0IHRlbXBsYXRlID0gewogICAgICAgIG5vbWU6IHRoaXMudGVtcGxhdGVuYW1lLAogICAgICAgIC4uLnRoaXMudGVtcGxhdGVtb2RlbAogICAgICB9OwogICAgICBjb25zdCBmb3VuZGVkID0gdGhpcy50ZW1wbGF0ZXMuZmluZChmID0+IGYubm9tZSA9PSB0ZW1wbGF0ZS5ub21lKTsKICAgICAgaWYgKCFmb3VuZGVkKSB7CiAgICAgICAgdGhpcy50ZW1wbGF0ZXMucHVzaCh0ZW1wbGF0ZSk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgZm91bmRlZC53aGVhZCA9IHRoaXMud2hlYWQ7CiAgICAgICAgZm91bmRlZC5mbGQgPSB0aGlzLmZsZDsKICAgICAgICBmb3VuZGVkLnNlcCA9IHRoaXMuc2VwOwogICAgICAgIGZvdW5kZWQucXVvdGVkID0gdGhpcy5xdW90ZWQ7CiAgICAgICAgZm91bmRlZC53aGVhZCA9IHRoaXMud2hlYWQ7CiAgICAgIH0KICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oInRlbXBsYXRlc2V4cG9ydCIsIEpTT04uc3RyaW5naWZ5KHRoaXMudGVtcGxhdGVzKSk7CiAgICAgIHRoaXMudGVtcGxhdGVzZWxlY3RlZCA9IHRoaXMudGVtcGxhdGVuYW1lOwogICAgICB0aGlzLiRyb290LnRvYXN0c3VjY2VzcygiTW9kZWxvIHNhbHZvIGNvbSBzdWNlc3NvICEiKTsKICAgIH0KICB9Cn07"},{"version":3,"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA8KA;EACAA;EAEAC;IACA;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;MACAV;IACA;EACA;EAEAW;IACAC;MACAC;MACAC;QACAT;QACAC;QACAC;QACAC;QACAE;QACAD;QACAT;MACA;IACA;EACA;EAEAe;IACAC;MACA;IACA;IACAC;MACA,wCACAC,gCACA;IACA;IACAC;MACA;IACA;IACAC;MACA;IACA;IACAC;MACA;QACAhB;QACAC;QACAC;QACAC;QACAE;QACAV;MACA;IACA;IACAsB;MACA;QACAjB;QACAC;QACAC;QACAC;MACA;IACA;IACAe;MACA,iBACA,4BACA;QAAAX;QAAAY;MAAA,MACA;MACAC;QAAAb;QAAAY;MAAA;MACA;IACA;IACAE;MACA,8BACA,cACA,mCACA,UACA,UACA,aACA,WACA,GACA;IACA;EACA;EAEAC;IACAN;MACAO;MACAC;QACA;MACA;IACA;IACA1B;MACA;MACA;QACA;QACA;QACA;QACA;QACA;MACA;IACA;EACA;EAEA2B;IACA;IACA;MACA;IACA;IAEA;EACA;EAEAC;IACAC;MACA,+BACA,WACA,UACA,UACA,aACA,WACA;IACA;IACAC;MACA;MACA;QAAA;QAAA;UAAAxB;QAAA;MAAA;MACA;IACA;IACAyB;MACA;IACA;IACAC;MACA;MACA;MACA;QACAC;MACA;MACA,WACA,WACAC,OACAD,OACAE,IACAC,aACAhC,SACAiC,+DACAjC,OACA,CACAkC,gBACA,CACA;MAEA;;MAEA;MACA;MACA;MACA;MACA;MACA;;MAEA;IACA;IACAC;MACA,eACAC,WACAC,cACAC,aACAC;MACA;MACA;MACA;MACAC;MACAA;MACAA;MACAC;;MAEAD;;MAEA;MAEAC;IACA;IACAC;MACA;QACA;QACA;MACA;QACA;UACA;QACA;MACA;IACA;IACAC;MACA;QACAC;QACA;MACA;MACA;MAEA;QACA;MACA;QACAC;QACAA;QACAA;QACAA;QACAA;MACA;MAEAC;MAEA;MAEA;IACA;EACA;AACA","names":["name","data","templates","templatename","templateselected","addfld","sep","fld","quoted","whead","csvstream","filename","props","value","type","default","computed","lcabecalho","fields","f","availableOptions","separators","emitmodal","templatemodel","templatesoptions","text","template","csvsample","watch","deep","handler","beforeMount","methods","updatecsv","exporta","download","json2csv","header","row","map","fieldName","JSON","join","downloadString","fileName","Math","toString","split","link","document","salvar","savetemplate","nome","founded","localStorage"],"sourceRoot":"src/components","sources":["ExportFile.vue"],"sourcesContent":["<template>\r\n  <div>\r\n    <b-form-group\r\n      id=\"input-group-templates\"\r\n      label-for=\"input-Templateses\"\r\n      label=\"Modelos\"\r\n    >\r\n      <b-input-group>\r\n        <b-form-select v-model=\"templateselected\" :options=\"templatesoptions\">\r\n        </b-form-select>\r\n        <b-input-group-append>\r\n          <b-button\r\n            variant=\"info\"\r\n            :disabled=\"!templateselected || templateselected == ''\"\r\n            @click=\"salvar\"\r\n          >\r\n            <b-icon-file-earmark-check />\r\n            Salvar\r\n          </b-button>\r\n        </b-input-group-append>\r\n      </b-input-group>\r\n    </b-form-group>\r\n    <b-form-group\r\n      id=\"input-group-fields\"\r\n      label-for=\"input-fields\"\r\n      label=\"Colunas\"\r\n    >\r\n      <b-form-tags\r\n        id=\"input-fields\"\r\n        add-button-text=\"Incluir\"\r\n        add-button-variant=\"outline-primary\"\r\n        placeholder=\"Adicione as colunas\"\r\n        add-on-change\r\n        no-outer-focus\r\n        v-model=\"fld\"\r\n      >\r\n        <template\r\n          v-slot=\"{ tags, inputAttrs, inputHandlers, disabled, removeTag }\"\r\n        >\r\n          <ul v-if=\"tags.length > 0\" class=\"list-inline d-inline-block mb-2\">\r\n            <li v-for=\"tag in tags\" :key=\"tag\" class=\"list-inline-item\">\r\n              <b-form-tag\r\n                @remove=\"removeTag(tag)\"\r\n                :title=\"tag\"\r\n                :disabled=\"disabled\"\r\n                variant=\"info\"\r\n                >{{ tag }}</b-form-tag\r\n              >\r\n            </li>\r\n          </ul>\r\n          <b-form-select\r\n            v-bind=\"inputAttrs\"\r\n            v-on=\"inputHandlers\"\r\n            :disabled=\"disabled || availableOptions.length === 0\"\r\n            :options=\"fields\"\r\n          >\r\n            <template #first>\r\n              <!-- This is required to prevent bugs with Safari -->\r\n              <option disabled value=\"\"\r\n                >Selecione as colunas a serem exportadas</option\r\n              >\r\n            </template>\r\n          </b-form-select>\r\n        </template>\r\n      </b-form-tags>\r\n    </b-form-group>\r\n\r\n    <b-row>\r\n      <b-col>\r\n        <b-form-group\r\n          id=\"input-group-filename\"\r\n          label-for=\"input-filename\"\r\n          label=\"Nome Arquivo\"\r\n        >\r\n          <b-form-input id=\"input-filename\" v-model=\"filename\"> </b-form-input>\r\n        </b-form-group>\r\n      </b-col>\r\n      <b-col cols=\"2\">\r\n        <b-form-group\r\n          id=\"input-group-separador\"\r\n          label-for=\"input-separador\"\r\n          label=\"Separador\"\r\n        >\r\n          <b-form-select\r\n            id=\"input-separador\"\r\n            :options=\"separators\"\r\n            v-model=\"sep\"\r\n          >\r\n          </b-form-select>\r\n        </b-form-group>\r\n      </b-col>\r\n      <b-col cols=\"2\">\r\n        <b-form-group\r\n          id=\"input-group-quoted\"\r\n          label-for=\"input-quoted\"\r\n          label=\"Formatador\"\r\n        >\r\n          <b-form-input id=\"input-quoted\" v-model=\"quoted\"> </b-form-input>\r\n        </b-form-group>\r\n      </b-col>\r\n      <b-col cols=\"2\">\r\n        <b-form-group\r\n          id=\"input-group-head\"\r\n          label-for=\"input-head\"\r\n          label=\"Cabeçalho\"\r\n        >\r\n          <b-form-checkbox id=\"input-head\" v-model=\"whead\">{{\r\n            lcabecalho\r\n          }}</b-form-checkbox>\r\n        </b-form-group>\r\n      </b-col>\r\n    </b-row>\r\n    <b-form-group\r\n      id=\"input-group-csvstream\"\r\n      label-for=\"input-csvstream\"\r\n      label=\"Exemplo\"\r\n    >\r\n      <b-form-textarea\r\n        id=\"input-csvstream\"\r\n        :value=\"csvsample\"\r\n        disabled\r\n        debounce=\"1000\"\r\n        wrap=\"off\"\r\n        rows=\"5\"\r\n        style=\"font-family: revert;font-size:10px;font-weight:bold;\"\r\n      ></b-form-textarea>\r\n    </b-form-group>\r\n    <hr />\r\n    <span class=\"spaced\">\r\n      <b-button\r\n        :disabled=\"csvstream == ''\"\r\n        variant=\"primary\"\r\n        class=\"float-right\"\r\n        @click=\"download\"\r\n      >\r\n        <b-icon-download />\r\n        Baixar\r\n      </b-button>\r\n    </span>\r\n    <!-- MODALS -->\r\n    <b-modal\r\n      id=\"modal-template\"\r\n      ref=\"modal-template\"\r\n      title=\"Salvar modelo\"\r\n      ok-only\r\n      ok-title=\"Salvar\"\r\n      :ok-disabled=\"templatename == ''\"\r\n      @ok=\"savetemplate\"\r\n    >\r\n      <b-form-group\r\n        id=\"input-group-nome\"\r\n        label-for=\"input-nome\"\r\n        label=\"Nome do modelo\"\r\n      >\r\n        <b-form-input id=\"input-nome\" v-model=\"templatename\"> </b-form-input>\r\n      </b-form-group>\r\n    </b-modal>\r\n    <!-- <pre>\r\n      templatesoptions:\r\n      {{ templatesoptions }}\r\n    </pre>\r\n    <pre>\r\n      templates:\r\n      {{ templates }}\r\n    </pre>\r\n    <pre>\r\n      templateselected:\r\n      {{ templateselected }}\r\n    </pre>\r\n    -->\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nexport default {\r\n  name: \"ExportFile\",\r\n\r\n  data() {\r\n    return {\r\n      templates: [],\r\n      templatename: \"\",\r\n      templateselected: null,\r\n      addfld: \"\",\r\n      sep: this.value.sep,\r\n      fld: this.value.fld,\r\n      quoted: this.value.quoted,\r\n      whead: this.value.whead,\r\n      csvstream: this.value.csvstream,\r\n      filename: this.value.filename,\r\n      data: this.value.data,\r\n    };\r\n  },\r\n\r\n  props: {\r\n    value: {\r\n      type: Object,\r\n      default: {\r\n        sep: \";\",\r\n        fld: null,\r\n        quoted: \"\",\r\n        whead: false,\r\n        filename: \"data.dat\",\r\n        csvstream: \"\",\r\n        data: [],\r\n      },\r\n    },\r\n  },\r\n\r\n  computed: {\r\n    lcabecalho() {\r\n      return this.whead ? \"Visível\" : \"Oculto\";\r\n    },\r\n    fields() {\r\n      return Object.keys(this.data[0]).filter(\r\n        (f) => this.fld.indexOf(f) === -1\r\n      );\r\n    },\r\n    availableOptions() {\r\n      return this.fields.filter((opt) => this.fld.indexOf(opt) === -1);\r\n    },\r\n    separators() {\r\n      return [\"\", \",\", \";\", \"|\"];\r\n    },\r\n    emitmodal() {\r\n      return {\r\n        sep: this.sep,\r\n        fld: this.fld,\r\n        quoted: this.quoted,\r\n        whead: this.whead,\r\n        filename: this.filename,\r\n        data: this.data,\r\n      };\r\n    },\r\n    templatemodel() {\r\n      return {\r\n        sep: this.sep,\r\n        fld: this.fld,\r\n        quoted: this.quoted,\r\n        whead: this.whead,\r\n      };\r\n    },\r\n    templatesoptions() {\r\n      const template =\r\n        this.templates.length > 0\r\n          ? this.templates.map((m) => ({ value: m.nome, text: m.nome }))\r\n          : [];\r\n      template.unshift({ value: \"new template\", text: \"Novo Modelo\" });\r\n      return template;\r\n    },\r\n    csvsample() {\r\n      return this.data.length > 0\r\n        ? this.json2csv(\r\n            this.data.filter((f, i) => i < 5),\r\n            this.fld,\r\n            this.sep,\r\n            this.quoted,\r\n            this.whead\r\n          )\r\n        : \"\";\r\n    },\r\n  },\r\n\r\n  watch: {\r\n    emitmodal: {\r\n      deep: true,\r\n      handler(data) {\r\n        this.exporta(data);\r\n      },\r\n    },\r\n    templateselected(nome) {\r\n      const template = this.templates.find((f) => f.nome == nome);\r\n      if (template) {\r\n        this.fld = template.fld;\r\n        this.sep = template.sep;\r\n        this.quoted = template.quoted;\r\n        this.whead = template.whead;\r\n        this.templatename = nome;\r\n      }\r\n    },\r\n  },\r\n\r\n  beforeMount() {\r\n    let templates = localStorage.getItem(\"templatesexport\");\r\n    if (templates && templates !== \"\") {\r\n      this.templates = JSON.parse(templates).filter((f) => f);\r\n    }\r\n\r\n    this.updatecsv();\r\n  },\r\n\r\n  methods: {\r\n    updatecsv() {\r\n      this.csvstream = this.json2csv(\r\n        this.data,\r\n        this.fld,\r\n        this.sep,\r\n        this.quoted,\r\n        this.whead\r\n      );\r\n    },\r\n    exporta(data) {\r\n      this.updatecsv();\r\n      const emitdata = { ...data, ...{ csvstream: this.csvstream } };\r\n      this.$emit(\"input\", emitdata);\r\n    },\r\n    download() {\r\n      this.downloadString(this.csvstream, this.filename);\r\n    },\r\n    json2csv(obj, fld = null, sep = \";\", quoted = \"\", whead = true) {\r\n      const replacer = (key, value) => (value === null ? \"\" : value); // specify how you want to handle null values here\r\n      let header = Object.keys(obj[0]);\r\n      if (Array.isArray(fld) && fld.length > 0) {\r\n        header = fld;\r\n      }\r\n      let csv = [\r\n        ...obj.map(\r\n          (row) =>\r\n            header\r\n              .map(\r\n                (fieldName) =>\r\n                  quoted +\r\n                  JSON.stringify(row[fieldName], replacer).replaceAll('\"', \"\") +\r\n                  quoted\r\n              )\r\n              .join(sep) + sep\r\n        ),\r\n      ].join(\"\\r\\n\");\r\n\r\n      if (whead) csv = header.join(sep) + sep + \"\\r\\n\" + csv;\r\n\r\n      // console.log(\"json2csv.obj:\", obj);\r\n      // console.log(\"json2csv.fld:\", fld);\r\n      // console.log(\"json2csv.sep:\", sep);\r\n      // console.log(\"json2csv.quoted:\", quoted);\r\n      // console.log(\"json2csv.whead:\", whead);\r\n      // console.log(\"json2csv.csv:\", csv.substring(0, 100));\r\n\r\n      return csv;\r\n    },\r\n    downloadString(strContent, fileName) {\r\n      if (!fileName)\r\n        fileName =\r\n          Math.random()\r\n            .toString(36)\r\n            .split(\".\")[1] + \".dat\";\r\n      // var encodedUri = encodeURI(strContent);\r\n      var encodedUri = encodeURIComponent(strContent);\r\n      var link = document.createElement(\"a\");\r\n      link.setAttribute(\"href\", \"data:text/plain;charset=utf-8,\" + encodedUri);\r\n      link.setAttribute(\"download\", fileName);\r\n      link.style.display = \"none\";\r\n      document.body.appendChild(link); // Required for FF\r\n\r\n      link.click(); // This will download the data file named \"my_data.csv\".\r\n\r\n      this.$root.toastsuccess(\"Arquivo gerado com sucesso !\");\r\n\r\n      document.body.removeChild(link);\r\n    },\r\n    salvar() {\r\n      if (this.templateselected == \"new template\") {\r\n        this.templatename = \"\";\r\n        this.$refs[\"modal-template\"].show();\r\n      } else {\r\n        if (this.templatename !== \"\") {\r\n          this.savetemplate();\r\n        }\r\n      }\r\n    },\r\n    savetemplate() {\r\n      const template = {\r\n        nome: this.templatename,\r\n        ...this.templatemodel,\r\n      };\r\n      const founded = this.templates.find((f) => f.nome == template.nome);\r\n\r\n      if (!founded) {\r\n        this.templates.push(template);\r\n      } else {\r\n        founded.whead = this.whead;\r\n        founded.fld = this.fld;\r\n        founded.sep = this.sep;\r\n        founded.quoted = this.quoted;\r\n        founded.whead = this.whead;\r\n      }\r\n\r\n      localStorage.setItem(\"templatesexport\", JSON.stringify(this.templates));\r\n\r\n      this.templateselected = this.templatename;\r\n\r\n      this.$root.toastsuccess(\"Modelo salvo com sucesso !\");\r\n    },\r\n  },\r\n};\r\n</script>\r\n"]}]}