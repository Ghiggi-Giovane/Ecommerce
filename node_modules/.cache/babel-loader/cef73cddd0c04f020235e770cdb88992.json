{"remainingRequest":"C:\\k1-services\\node_modules\\babel-loader\\lib\\index.js!C:\\k1-services\\node_modules\\cache-loader\\dist\\cjs.js??ref--1-0!C:\\k1-services\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\k1-services\\src\\pages\\covid\\components\\QrcodeFunc.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\k1-services\\src\\pages\\covid\\components\\QrcodeFunc.vue","mtime":1670977910618},{"path":"C:\\k1-services\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1670977934221},{"path":"C:\\k1-services\\node_modules\\babel-loader\\lib\\index.js","mtime":1670977935138},{"path":"C:\\k1-services\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1670977934221},{"path":"C:\\k1-services\\node_modules\\vue-loader\\lib\\index.js","mtime":1670977935327}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KaW1wb3J0IHsgbWFwQWN0aW9ucywgbWFwR2V0dGVycyB9IGZyb20gJ3Z1ZXgnOwppbXBvcnQgU2VhcmNoQXBpIGZyb20gJy4uLy4uLy4uL2NvbXBvbmVudHMvU2VhcmNoQXBpJzsKZXhwb3J0IGRlZmF1bHQgewogIG5hbWU6ICdRcmNvZGVGdW5jJywKCiAgZGF0YSgpIHsKICAgIHJldHVybiB7CiAgICAgIGZ1bmM6IHsKICAgICAgICB2YWx1ZTogJy0nLAogICAgICAgIHRleHQ6ICcnCiAgICAgIH0sCiAgICAgIHNob3djYW06IHRydWUsCiAgICAgIHRlc3RlczogJycsCiAgICAgIGNhbWVyYXM6IHsKICAgICAgICBub1JlYXJDYW1lcmE6IGZhbHNlLAogICAgICAgIG5vRnJvbnRDYW1lcmE6IGZhbHNlLAogICAgICAgIHRvcmNoTm90U3VwcG9ydGVkOiBmYWxzZSwKICAgICAgICB0b3JjaEFjdGl2ZTogZmFsc2UsCiAgICAgICAgY29uZmlnOiBudWxsLAogICAgICAgIHNlbGVjdGVkOiAnYXV0bycsCiAgICAgICAgZGF0YTogW10KICAgICAgfQogICAgfTsKICB9LAoKICBjb21wb25lbnRzOiB7CiAgICBTZWFyY2hBcGkKICB9LAogIGNvbXB1dGVkOiB7IC4uLm1hcEdldHRlcnMoWydndHhmdW5jRGF0YSddKSwKCiAgICBjYW5DaGFuZ2VDYW0oKSB7CiAgICAgIHJldHVybiB0aGlzLmNhbWVyYXMuZGF0YS5sZW5ndGggPiAxOwogICAgfSwKCiAgICBjYXB0aW9uQnV0dG9uKCkgewogICAgICByZXR1cm4gdGhpcy5zaG93Y2FtID8gJ1Blc3F1aXNhciBmdW5jaW9uw6FyaW8nIDogJ0xlciBRUkNvZGUnOwogICAgfSwKCiAgICByZWFkb2soKSB7CiAgICAgIHJldHVybiB0aGlzLmNhbWVyYXMuc2VsZWN0ZWQgPT0gJ29mZic7CiAgICB9LAoKICAgIGljb24oKSB7CiAgICAgIHJldHVybiB0aGlzLnRvcmNoQWN0aXZlID8gJ2xpZ2h0bmluZycgOiAnbGlnaHRuaW5nLWZpbGwnOwogICAgfQoKICB9LAogIG1ldGhvZHM6IHsgLi4ubWFwQWN0aW9ucyhbJ2FjdGZ1bmNidXNjYXInXSksCgogICAgbGltcGFCdXNjYSgpIHsKICAgICAgdGhpcy5mdW5jID0gewogICAgICAgIHZhbHVlOiAnLScsCiAgICAgICAgdGV4dDogJycKICAgICAgfTsKICAgIH0sCgogICAgYXN5bmMgb25EZWNvZGUoZGVjb2RlZFN0cmluZykgewogICAgICBpZiAoZGVjb2RlZFN0cmluZy5sZW5ndGggPT0gMzYpIHsKICAgICAgICB0aGlzLmNhbWVyYXMuc2VsZWN0ZWQgPSAnb2ZmJzsKICAgICAgICBhd2FpdCB0aGlzLnRpbWVvdXQoODAwKTsKICAgICAgICB0aGlzLmNhbWVyYXMuc2VsZWN0ZWQgPSAnYXV0byc7CiAgICAgICAgdGhpcy5idXNjYUZ1bmMoZGVjb2RlZFN0cmluZyk7CiAgICAgIH0KICAgIH0sCgogICAgb25DYW1lcmFDaGFuZ2UoKSB7CiAgICAgIGlmICghdGhpcy5jYW1lcmFzLm5vRnJvbnRDYW1lcmEgJiYgdGhpcy5jYW1lcmFzLnNlbGVjdGVkICE9PSAnZnJvbnQnKSB7CiAgICAgICAgdGhpcy5jYW1lcmFzLnNlbGVjdGVkID0gJ2Zyb250JzsKICAgICAgfSBlbHNlIHsKICAgICAgICBpZiAoIXRoaXMuY2FtZXJhcy5ub1JlYXJDYW1lcmEgJiYgdGhpcy5jYW1lcmFzLnNlbGVjdGVkICE9PSAncmVhcicpIHsKICAgICAgICAgIHRoaXMuY2FtZXJhcy5zZWxlY3RlZCA9ICdyZWFyJzsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgdGhpcy5jYW1lcmFzLnNlbGVjdGVkID0gJ2F1dG8nOwogICAgICAgIH0KICAgICAgfQogICAgfSwKCiAgICBvbkluaXQocHJvbWlzZSkgewogICAgICBwcm9taXNlLnRoZW4oY2FtcyA9PiB7CiAgICAgICAgaWYgKHRoaXMuY2FtZXJhcy5kYXRhLmxlbmd0aCA9PSAwKSB0aGlzLmNhbWVyYXMuZGF0YSA9IGNhbXMuY2FwYWJpbGl0aWVzLmZhY2luZ01vZGUubWFwKGMgPT4gewogICAgICAgICAgcmV0dXJuIHsKICAgICAgICAgICAgdmFsdWU6IGMsCiAgICAgICAgICAgIHRleHQ6IGMKICAgICAgICAgIH07CiAgICAgICAgfSk7CiAgICAgICAgdGhpcy50b3JjaEFjdGl2ZSA9ICFjYW1zLmNhcGFiaWxpdGllcy50b3JjaDsgLy8gY29uc29sZS5sb2coJ2NhbWVyYXM6JywgdGhpcy5jYW1lcmFzKQogICAgICB9KTsKICAgICAgcHJvbWlzZS5jYXRjaChlcnJvciA9PiB7CiAgICAgICAgY29uc3QgY2FtZXJhTWlzc2luZ0Vycm9yID0gZXJyb3IubmFtZSA9PT0gJ092ZXJjb25zdHJhaW5lZEVycm9yJzsKICAgICAgICBjb25zdCB0cmllZFJlYXJDYW1lcmEgPSB0aGlzLmNhbWVyYXMuc2VsZWN0ZWQgPT09ICdyZWFyJzsKICAgICAgICBjb25zdCB0cmllZEZyb250Q2FtZXJhID0gdGhpcy5jYW1lcmFzLnNlbGVjdGVkID09PSAnZnJvbnQnOwoKICAgICAgICBpZiAodHJpZWRSZWFyQ2FtZXJhICYmIGNhbWVyYU1pc3NpbmdFcnJvcikgewogICAgICAgICAgdGhpcy5jYW1lcmFzLm5vUmVhckNhbWVyYSA9IHRydWU7CiAgICAgICAgfQoKICAgICAgICBpZiAodHJpZWRGcm9udENhbWVyYSAmJiBjYW1lcmFNaXNzaW5nRXJyb3IpIHsKICAgICAgICAgIHRoaXMuY2FtZXJhcy5ub0Zyb250Q2FtZXJhID0gdHJ1ZTsKICAgICAgICB9CiAgICAgIH0pOwogICAgfSwKCiAgICBidXNjYUZ1bmMoYnVzY2EpIHsKICAgICAgbGV0IHBhcmFtcyA9IHsKICAgICAgICBwZXNxdWlzYTogdHlwZW9mIGJ1c2NhID09ICdvYmplY3QnID8gYnVzY2EudmFsdWUgOiBidXNjYQogICAgICB9OwogICAgICB0aGlzLiRlbWl0KCdldnQtYnVzY2EnLCBwYXJhbXMpOwogICAgfSwKCiAgICBjYW1lcmFPayhjYW0pIHt9LAoKICAgIGFzeW5jIHRpbWVvdXQobXMpIHsKICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKHJlc29sdmUgPT4gewogICAgICAgIHdpbmRvdy5zZXRUaW1lb3V0KHJlc29sdmUsIG1zKTsKICAgICAgfSk7CiAgICB9CgogIH0sCiAgd2F0Y2g6IHsKICAgIGZ1bmMoZnVuYykgewogICAgICAvLyBjb25zb2xlLmxvZygnZnVuYzonLCBmdW5jKQogICAgICBpZiAodGhpcy5mdW5jLnZhbHVlICE9PSAnLScpIHRoaXMuYnVzY2FGdW5jKGZ1bmMpOwogICAgfQoKICB9Cn07"},{"version":3,"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA8BA;AACA;AACA;EAEAA,kBAFA;;EAIAC;IACA;MACAC;QAAAC;QAAAC;MAAA,CADA;MAEAC,aAFA;MAGAC,UAHA;MAIAC;QACAC,mBADA;QAEAC,oBAFA;QAGAC,wBAHA;QAIAC,kBAJA;QAKAC,YALA;QAMAC,gBANA;QAOAZ;MAPA;IAJA;EAcA,CAnBA;;EAqBAa;IAEAC;EAFA,CArBA;EA2BAC,YAEA,8BAFA;;IAIAC;MACA;IACA,CANA;;IAQAC;MACA;IACA,CAVA;;IAYAC;MACA;IACA,CAdA;;IAgBAC;MACA;IACA;;EAlBA,CA3BA;EAiDAC,WAEA,gCAFA;;IAIAC;MACA;QAAAnB;QAAAC;MAAA;IACA,CANA;;IAQA;MAEA;QAEA;QACA;QACA;QAEA;MACA;IACA,CAlBA;;IAoBAmB;MAEA;QACA;MACA,CAFA,MAEA;QACA;UACA;QACA,CAFA,MAEA;UACA;QACA;MACA;IAGA,CAjCA;;IAmCAC;MACAC;QACA;UAAA;YAAAtB;YAAAC;UAAA;QAAA;QACA,4CAFA,CAIA;MACA,CALA;MAMAqB;QACA;QACA;QACA;;QAEA;UACA;QACA;;QAEA;UACA;QACA;MACA,CAZA;IAaA,CAvDA;;IAyDAC;MACA;QACAC;MADA;MAGA;IACA,CA9DA;;IAgEAC,eAEA,CAlEA;;IAoEA;MACA;QACAC;MACA,CAFA;IAGA;;EAxEA,CAjDA;EA6HAC;IACA5B;MACA;MACA;IACA;;EAJA;AA7HA","names":["name","data","func","value","text","showcam","testes","cameras","noRearCamera","noFrontCamera","torchNotSupported","torchActive","config","selected","components","SearchApi","computed","canChangeCam","captionButton","readok","icon","methods","limpaBusca","onCameraChange","onInit","promise","buscaFunc","pesquisa","cameraOk","window","watch"],"sourceRoot":"src/pages/covid/components","sources":["QrcodeFunc.vue"],"sourcesContent":["<template>\r\n\r\n    <div>\r\n        <div style=\"border: 5px solid transparent;\" v-show=\"showcam\">\r\n            <b-button size=\"sm\" variant=\"info\" @click=\"onCameraChange\" class=\"btn-cams\" :disabled=\"!canChangeCam\"><b-icon-camera/></b-button>\r\n            <b-button size=\"sm\" variant=\"warning\" class=\"btn-torch\"><b-icon :icon=\"icon\"/></b-button>\r\n            <qrcode-stream :camera=\"cameras.selected\" @init=\"onInit\" @decode=\"onDecode\">\r\n                <b-icon-check2-circle v-show=\"readok\" class=\"readok\"/>\r\n            </qrcode-stream>\r\n        </div>\r\n\r\n        <div class=\"pt-2 pb-2\" v-show=\"!showcam\">\r\n            <SearchApi id=\"input-func\" pkid=\"searchFunc\" route=\"Servicos/Funcionarios/Select\" title=\"Funcionário\" v-model=\"func\"/> \r\n        </div>\r\n\r\n        <!-- <b-button block variant=\"primary\" @click=\"showcam = !showcam\" class=\"mt-2 mb-3\">{{ captionButton }}</b-button> -->\r\n        <b-button block variant=\"primary\" @click=\"showcam = !showcam\" class=\"mt-2 mb-3\">{{ captionButton }}</b-button>\r\n        \r\n        <!-- cameras:\r\n        {{ cameras }}<br>\r\n        canChangeCam: {{ canChangeCam }}<br>\r\n        icon: {{ icon }}<br>\r\n        testes: {{ testes }} -->\r\n        \r\n\r\n    </div>\r\n    \r\n</template>\r\n\r\n<script>\r\nimport { mapActions, mapGetters } from 'vuex'\r\nimport SearchApi from '../../../components/SearchApi'\r\nexport default {\r\n    \r\n    name: 'QrcodeFunc',\r\n\r\n    data() {\r\n        return {\r\n            func: {value: '-', text: ''},\r\n            showcam: true,\r\n            testes: '',\r\n            cameras: {\r\n                noRearCamera: false,\r\n                noFrontCamera: false,\r\n                torchNotSupported: false,\r\n                torchActive: false,\r\n                config: null,\r\n                selected: 'auto',\r\n                data: []\r\n            }\r\n        }\r\n    },\r\n\r\n    components: {\r\n\r\n        SearchApi\r\n    \r\n    },\r\n\r\n    computed: {\r\n\r\n        ...mapGetters(['gtxfuncData']),\r\n\r\n        canChangeCam() {\r\n            return (this.cameras.data.length>1)\r\n        },\r\n\r\n        captionButton() {\r\n            return (this.showcam) ? 'Pesquisar funcionário' : 'Ler QRCode'\r\n        },\r\n\r\n        readok() {\r\n            return (this.cameras.selected == 'off')\r\n        },\r\n\r\n        icon() {\r\n            return (this.torchActive) ? 'lightning' : 'lightning-fill'\r\n        }\r\n\r\n    },\r\n\r\n    methods: {\r\n\r\n        ...mapActions(['actfuncbuscar']),\r\n\r\n        limpaBusca() {\r\n            this.func = {value: '-', text: ''}\r\n        },\r\n\r\n        async onDecode(decodedString) {\r\n\r\n            if (decodedString.length == 36) {\r\n    \r\n                this.cameras.selected = 'off'\r\n                await this.timeout(800)\r\n                this.cameras.selected = 'auto'\r\n    \r\n                this.buscaFunc(decodedString)\r\n            }\r\n        },\r\n\r\n        onCameraChange () {\r\n\r\n            if ((!this.cameras.noFrontCamera) && (this.cameras.selected !== 'front')) {\r\n                this.cameras.selected = 'front'\r\n            } else {\r\n                if ((!this.cameras.noRearCamera) && (this.cameras.selected !== 'rear')) {\r\n                    this.cameras.selected = 'rear'\r\n                } else {\r\n                    this.cameras.selected = 'auto'\r\n                }\r\n            }\r\n           \r\n\r\n        },\r\n\r\n        onInit (promise) {\r\n            promise.then(cams => {\r\n                if (this.cameras.data.length == 0) this.cameras.data = cams.capabilities.facingMode.map(c => {return {value: c, text: c}})\r\n                this.torchActive = !cams.capabilities.torch\r\n\r\n                // console.log('cameras:', this.cameras)\r\n            })\r\n            promise.catch(error => {\r\n                const cameraMissingError = error.name === 'OverconstrainedError'\r\n                const triedRearCamera = this.cameras.selected === 'rear'\r\n                const triedFrontCamera = this.cameras.selected === 'front'\r\n\r\n                if (triedRearCamera && cameraMissingError) {\r\n                    this.cameras.noRearCamera = true\r\n                }\r\n\r\n                if (triedFrontCamera && cameraMissingError) {\r\n                    this.cameras.noFrontCamera = true\r\n                }\r\n            })\r\n        },\r\n\r\n        buscaFunc(busca) {\r\n            let params = {\r\n                pesquisa: (typeof(busca)=='object') ? busca.value : busca\r\n            }\r\n            this.$emit('evt-busca', params)\r\n        },\r\n\r\n        cameraOk(cam) {\r\n\r\n        },\r\n\r\n        async timeout (ms) {\r\n            return new Promise(resolve => {\r\n                window.setTimeout(resolve, ms)\r\n            })\r\n        }\r\n\r\n    },\r\n\r\n    watch: {\r\n        func(func) {\r\n            // console.log('func:', func)\r\n            if (this.func.value !== '-') this.buscaFunc(func)\r\n        }\r\n    }\r\n    \r\n}\r\n</script>\r\n\r\n<style scoped>\r\n    .readok {\r\n        color: lime;\r\n        width: 130px;\r\n        height: 130px;\r\n        position: relative;\r\n        margin: 0 auto;\r\n        top: 50%;\r\n        left: 50%;\r\n        transform: translate(-50%, -50%);\r\n    }\r\n    .btn-cams {\r\n        position: absolute;\r\n        z-index: 9;\r\n        right: 0;\r\n        margin-top: 2px;\r\n        margin-right: 22px;       \r\n    }\r\n    .btn-torch {\r\n        position: absolute;\r\n        z-index: 9;\r\n        right: 0;\r\n        margin-top: 2px;\r\n        margin-right: 64px;       \r\n    }\r\n</style>"]}]}