{"remainingRequest":"C:\\k1-services\\node_modules\\babel-loader\\lib\\index.js!C:\\k1-services\\node_modules\\cache-loader\\dist\\cjs.js??ref--1-0!C:\\k1-services\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\k1-services\\src\\pages\\coleta\\views\\index.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\k1-services\\src\\pages\\coleta\\views\\index.vue","mtime":1670977910609},{"path":"C:\\k1-services\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1670977934221},{"path":"C:\\k1-services\\node_modules\\babel-loader\\lib\\index.js","mtime":1670977935138},{"path":"C:\\k1-services\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1670977934221},{"path":"C:\\k1-services\\node_modules\\vue-loader\\lib\\index.js","mtime":1670977935327}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KaW1wb3J0IEFwaVNlcnZpY2UgZnJvbSAnLi4vLi4vLi4vc2VydmljZXMvYXBpLnNlcnZpY2UnOwppbXBvcnQgQ29sZXRhRUFOIGZyb20gJy4uLy4uLy4uL2NvbXBvbmVudHMvQ29sZXRhRUFOJzsKaW1wb3J0IHsgc2F2ZVRvQ1NWIH0gZnJvbSAnLi4vLi4vLi4vc2VydmljZXMvY3N2JzsKaW1wb3J0IHsgbWFwQWN0aW9ucyB9IGZyb20gJ3Z1ZXgnOwpleHBvcnQgZGVmYXVsdCB7CiAgbmFtZTogJ0NvbGV0YUxpdnJlJywKCiAgYmVmb3JlTW91bnQoKSB7CiAgICB0aGlzLmNvbnN1bHRhQ29sZXRhcygpOwogIH0sCgogIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICBub21lOiB7CiAgICAgICAgdmFsdWU6ICcnLAogICAgICAgIHNob3c6IGZhbHNlLAogICAgICAgIHR5cGU6ICd0ZXh0JywKICAgICAgICB0aXRsZTogJ05vbWUgZGEgY2F0ZWdvcmlhJywKICAgICAgICBwbGFjZWhvbGRlcjogJ0luZm9ybWUgbyBub21lIGRhIGNhdGVnb3JpYScKICAgICAgfSwKICAgICAgY29sZXRhczogW10sCiAgICAgIGNvbnN1bHRhY29sZXRhczogW10sCiAgICAgIGNvbGV0YXN4bWw6ICcnLAogICAgICBkZXN0aW5vOiBudWxsLAogICAgICBkZXN0aW5vczogW3sKICAgICAgICB2YWx1ZTogMSwKICAgICAgICB0ZXh0OiAnQ29uZmVyw6puY2lhIGRlIEltb2JpbGl6YWRvcycKICAgICAgfSwgewogICAgICAgIHZhbHVlOiAyLAogICAgICAgIHRleHQ6ICdDb25mZXLDqm5jaWEgRXhwZWRpw6fDtWVzJwogICAgICB9LCB7CiAgICAgICAgdmFsdWU6IG51bGwsCiAgICAgICAgdGV4dDogJy0nLAogICAgICAgIGRpc2FibGVkOiB0cnVlCiAgICAgIH0sIHsKICAgICAgICB2YWx1ZTogLTEsCiAgICAgICAgdGV4dDogJ1NhbHZhciBlbSBBcnF1aXZvIENTVicKICAgICAgfV0KICAgIH07CiAgfSwKCiAgY29tcG9uZW50czogewogICAgQ29sZXRhRUFOCiAgfSwKICBjb21wdXRlZDogewogICAgY29uZmlnKCkgewogICAgICByZXR1cm4gYDxkYXRhPjxpZENvbGV0YVRpcG8+JHt0aGlzLmRlc3Rpbm99PC9pZENvbGV0YVRpcG8+PE5vbWVDYXRlZ29yaWE+JHt0aGlzLm5vbWUudmFsdWV9PC9Ob21lQ2F0ZWdvcmlhPjwvZGF0YT5gOwogICAgfSwKCiAgICBjb2xldGFzTk9lbnRlcigpIHsKICAgICAgcmV0dXJuIHRoaXMuY29sZXRhcy5tYXAoYyA9PiB7CiAgICAgICAgcmV0dXJuIHsKICAgICAgICAgIGVhbjogYy5lYW4ucmVwbGFjZSgnXG4nLCAnJykKICAgICAgICB9OwogICAgICB9KTsKICAgIH0sCgogICAgcGFnZUNvbGV0YXMoKSB7CiAgICAgIHJldHVybiBbewogICAgICAgIHRpdGxlOiBgQ29sZXRhcyBFbnZpYWRhcyAoICR7dGhpcy5jb25zdWx0YWNvbGV0YXMubGVuZ3RofSApYCwKICAgICAgICB0YWJsZTogdHJ1ZSwKICAgICAgICBkYXRhOiB0aGlzLmNvbnN1bHRhY29sZXRhcywKICAgICAgICBmaWVsZHM6IFt7CiAgICAgICAgICBrZXk6ICdDYXRlZ29yaWEnLAogICAgICAgICAgc29ydGFibGU6IHRydWUKICAgICAgICB9LCB7CiAgICAgICAgICBrZXk6ICdFYW4nLAogICAgICAgICAgc29ydGFibGU6IHRydWUKICAgICAgICB9LCB7CiAgICAgICAgICBrZXk6ICdEYXRhQ29sZXRhJywKICAgICAgICAgIHNvcnRhYmxlOiB0cnVlCiAgICAgICAgfV0KICAgICAgfV07CiAgICB9CgogIH0sCiAgbWV0aG9kczogeyAuLi5tYXBBY3Rpb25zKFsnYWN0VG9hc3QnXSksCgogICAgb25FbnZpYUNvbGV0YVhNTChjb2xldGFzKSB7CiAgICAgIHRoaXMuY29sZXRhc3htbCA9IGNvbGV0YXM7CiAgICAgIHRoaXMuJGJ2TW9kYWwuc2hvdygnY29sZXRhY2F0ZWdvcmlhJyk7CiAgICB9LAoKICAgIG9uRW52aWFDb2xldGEoY29sZXRhcykgewogICAgICB0aGlzLmNvbGV0YXMgPSBjb2xldGFzOwogICAgICB0aGlzLiRidk1vZGFsLnNob3coJ2NvbGV0YWNhdGVnb3JpYScpOwogICAgfSwKCiAgICBlbnZpYUNvbGV0YXMoKSB7CiAgICAgIGNvbnN0IHBhcmFtcyA9IHsKICAgICAgICBjb25maWc6IHRoaXMuY29uZmlnLAogICAgICAgIGRhdGE6IHRoaXMuY29sZXRhc3htbAogICAgICB9OyAvLyBzYWx2YSBlbSBhcnF1aXZvIHRleHRvIC4uLgoKICAgICAgaWYgKHRoaXMuZGVzdGlubyA9PSAtMSkgewogICAgICAgIC8vIGNvbnNvbGUubG9nKCdlbnZpYUNvbGV0YXM6JywgdGhpcy5jb2xldGFzKQogICAgICAgIHNhdmVUb0NTVih0aGlzLmNvbGV0YXNOT2VudGVyLCBgJHt0aGlzLm5vbWUudmFsdWV9LmNzdmApOwogICAgICB9CgogICAgICBpZiAodGhpcy5kZXN0aW5vID4gMCkgewogICAgICAgIEFwaVNlcnZpY2Uuc2V0QXV0aEhlYWRlcigpOwogICAgICAgIEFwaVNlcnZpY2UucG9zdCgnU2Vydmljb3MvQ29sZXRhcy9JbnNlcnQnLCBwYXJhbXMpLnRoZW4ocmVzID0+IHsKICAgICAgICAgIHRoaXMuY29sZXRhcyA9IFtdOwogICAgICAgICAgdGhpcy5jb2xldGFzeG1sID0gJyc7CiAgICAgICAgICB0aGlzLmNvbnN1bHRhQ29sZXRhcygpOwogICAgICAgICAgdGhpcy5hY3RUb2FzdCh7CiAgICAgICAgICAgIG1lc3NhZ2U6ICdSZWdpc3RybyBzYWx2byBjb20gc3VjZXNzbyAhJywKICAgICAgICAgICAgdmFyaWFudDogJ3N1Y2Nlc3MnCiAgICAgICAgICB9KTsKICAgICAgICB9KS5jYXRjaChlID0+IHsKICAgICAgICAgIGNvbnNvbGUubG9nKCdFcnJvOiAnLCBlKTsKICAgICAgICAgIHRoaXMuYWN0VG9hc3QoewogICAgICAgICAgICBtZXNzYWdlOiAnRXJybyBhbyBpbmNsdWlyIG8gcmVnaXN0cm8gIScsCiAgICAgICAgICAgIHZhcmlhbnQ6ICdkYW5nZXInCiAgICAgICAgICB9KTsKICAgICAgICB9KTsKICAgICAgfQogICAgfSwKCiAgICBjb25zdWx0YUNvbGV0YXMoKSB7CiAgICAgIEFwaVNlcnZpY2Uuc2V0QXV0aEhlYWRlcigpOwogICAgICBBcGlTZXJ2aWNlLnBvc3QoJ1NlcnZpY29zL0NvbGV0YXMvU2VsZWN0Jywge30pLnRoZW4ocmVzID0+IHsKICAgICAgICB0aGlzLmNvbnN1bHRhY29sZXRhcyA9IFtdOwogICAgICAgIGlmIChyZXMuc3RhdHVzID09ICcyMDAnICYmIHJlcy5kYXRhLlN1Y2Nlc3MgPT0gJ1RydWUnKSB0aGlzLmNvbnN1bHRhY29sZXRhcyA9IHJlcy5kYXRhLkRhdGE7CiAgICAgIH0pLmNhdGNoKGUgPT4gewogICAgICAgIGNvbnNvbGUubG9nKCdFcnJvOiAnLCBlKTsKICAgICAgICB0aGlzLmFjdFRvYXN0KHsKICAgICAgICAgIG1lc3NhZ2U6ICdFcnJvIGFvIGNvbnN1bHRhciBjb2xldGFzICEnLAogICAgICAgICAgdmFyaWFudDogJ2RhbmdlcicKICAgICAgICB9KTsKICAgICAgfSk7CiAgICB9CgogIH0KfTs="},{"version":3,"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA+DA;AACA;AACA;AACA;AAEA;EAEAA,mBAFA;;EAIAC;IAEA;EAEA,CARA;;EAUAC;IAEA;MACAC;QACAC,SADA;QAEAC,WAFA;QAGAC,YAHA;QAIAC,0BAJA;QAKAC;MALA,CADA;MAQAC,WARA;MASAC,mBATA;MAUAC,cAVA;MAWAC,aAXA;MAYAC,WACA;QAAAT;QAAAU;MAAA,CADA,EAEA;QAAAV;QAAAU;MAAA,CAFA,EAGA;QAAAV;QAAAU;QAAAC;MAAA,CAHA,EAIA;QAAAX;QAAAU;MAAA,CAJA;IAZA;EAqBA,CAjCA;;EAmCAE;IAEAC;EAFA,CAnCA;EAyCAC;IAEAC;MAEA;IAEA,CANA;;IAQAC;MACA;QAAA;UAAAC;QAAA;MAAA;IACA,CAVA;;IAYAC;MACA,QACA;QAAAf;QACAgB,WADA;QAEArB,0BAFA;QAGAsB,SACA;UAAAC;UAAAC;QAAA,CADA,EAEA;UAAAD;UAAAC;QAAA,CAFA,EAGA;UAAAD;UAAAC;QAAA,CAHA;MAHA,CADA;IAUA;;EAvBA,CAzCA;EAoEAC,WAEA,2BAFA;;IAIAC;MAEA;MAEA;IAEA,CAVA;;IAYAC;MAEA;MAEA;IAEA,CAlBA;;IAoBAC;MAEA;QAAAX;QAAAjB;MAAA,EAFA,CAIA;;MACA;QACA;QACA6B;MACA;;MAEA;QACAC;QACAA,mDACAC,IADA,CACAC;UACA;UACA;UACA;UACA;YAAAC;YAAAC;UAAA;QACA,CANA,EAOAC,KAPA,CAOAC;UACAC;UACA;YAAAJ;YAAAC;UAAA;QACA,CAVA;MAWA;IAEA,CA7CA;;IA+CAI;MAEAR;MACAA,+CACAC,IADA,CACAC;QACA;QACA,uDACA;MACA,CALA,EAMAG,KANA,CAMAC;QACAC;QACA;UAAAJ;UAAAC;QAAA;MACA,CATA;IAWA;;EA7DA;AApEA","names":["name","beforeMount","data","nome","value","show","type","title","placeholder","coletas","consultacoletas","coletasxml","destino","destinos","text","disabled","components","ColetaEAN","computed","config","coletasNOenter","ean","pageColetas","table","fields","key","sortable","methods","onEnviaColetaXML","onEnviaColeta","enviaColetas","saveToCSV","ApiService","then","res","message","variant","catch","e","console","consultaColetas"],"sourceRoot":"src/pages/coleta/views","sources":["index.vue"],"sourcesContent":["<template>\r\n    <div>\r\n\r\n        <b-card class=\"m-2\" bg-variant=\"dark\" text-variant=\"warning\">\r\n            <b-form-group \r\n                id=\"input-group-destino\"\r\n                label=\"Destino\"\r\n                label-for=\"input-destino\">\r\n                <b-form-select\r\n                    autofocus\r\n                    id=\"input-destino\"\r\n                    v-model=\"destino\"\r\n                    :options=\"destinos\">\r\n                </b-form-select>\r\n            </b-form-group>             \r\n        </b-card>\r\n\r\n        <ColetaEAN\r\n            :disableenvio=\"(destino || 0) == 0\"\r\n            :eanfields=\"[{key: 'ean', label: 'Ean'}, {key: 'actions', label: 'Ações'}]\"\r\n            :histfields=\"[{key: 'ean', label: 'Ean'}, {key: 'actions', label: 'Ações'}]\"\r\n            :customPages=\"pageColetas\"\r\n            @evt-coletas-xml=\"onEnviaColetaXML\"\r\n            @evt-coletas=\"onEnviaColeta\"\r\n        />\r\n\r\n<!--         coletasxml: {{coletasxml}}<br>\r\n        destino: {{(destino || 0) == 0}}<br>\r\n        config: {{config}} -->\r\n\r\n        <b-modal\r\n            id=\"modal-enviar\"\r\n            title=\"Escolha o destino da coleta\"\r\n            ok-only\r\n            :ok-disabled=\"!destino\"\r\n            @ok=\"enviaColetas\">\r\n\r\n            <b-form-group \r\n                id=\"input-group-destino\"\r\n                label=\"Destino\"\r\n                label-for=\"input-destino\">\r\n                <b-form-select\r\n                    id=\"input-destino\"\r\n                    v-model=\"destino\"\r\n                    :options=\"destinos\">\r\n                </b-form-select>\r\n            </b-form-group> \r\n\r\n        </b-modal>\r\n\r\n        <Inputmodal\r\n            idmodal=\"coletacategoria\"\r\n            v-model=\"nome.value\"\r\n            :type=\"nome.type\"\r\n            :title=\"nome.title\"\r\n            :placeholder=\"nome.placeholder\"\r\n            @inputmodel=\"enviaColetas\"\r\n        />\r\n\r\n    </div>\r\n</template>\r\n\r\n<script>\r\nimport ApiService from '../../../services/api.service'\r\nimport ColetaEAN from '../../../components/ColetaEAN'\r\nimport { saveToCSV } from '../../../services/csv'\r\nimport { mapActions } from 'vuex'\r\n\r\nexport default {\r\n\r\n    name: 'ColetaLivre',\r\n\r\n    beforeMount() {\r\n\r\n        this.consultaColetas()\r\n\r\n    },\r\n\r\n    data() {\r\n\r\n        return {\r\n            nome: {\r\n                value: '',\r\n                show: false,\r\n                type: 'text',\r\n                title: 'Nome da categoria',\r\n                placeholder: 'Informe o nome da categoria'\r\n            },\r\n            coletas: [],\r\n            consultacoletas: [],\r\n            coletasxml: '',\r\n            destino: null,\r\n            destinos: [\r\n                { value: 1, text: 'Conferência de Imobilizados' },\r\n                { value: 2, text: 'Conferência Expedições' },\r\n                { value: null, text: '-', disabled: true },\r\n                { value: -1, text: 'Salvar em Arquivo CSV' },\r\n                \r\n            ],\r\n        }\r\n\r\n    },\r\n\r\n    components: {\r\n\r\n        ColetaEAN\r\n        \r\n    },\r\n\r\n    computed: {\r\n\r\n        config() {\r\n\r\n            return `<data><idColetaTipo>${this.destino}</idColetaTipo><NomeCategoria>${this.nome.value}</NomeCategoria></data>`\r\n\r\n        },\r\n\r\n        coletasNOenter() {\r\n            return this.coletas.map(c => {return {ean: c.ean.replace('\\n','')}})\r\n        },\r\n\r\n        pageColetas() {\r\n            return [\r\n                { title: `Coletas Enviadas ( ${this.consultacoletas.length} )`\r\n                , table: true\r\n                , data: this.consultacoletas\r\n                , fields: [\r\n                    { key: 'Categoria', sortable: true },\r\n                    { key: 'Ean', sortable: true },\r\n                    { key: 'DataColeta', sortable: true }\r\n                ]}\r\n            ]\r\n        }\r\n\r\n    },\r\n\r\n    methods: {\r\n\r\n        ...mapActions(['actToast']),\r\n\r\n        onEnviaColetaXML(coletas) {\r\n\r\n            this.coletasxml = coletas\r\n\r\n            this.$bvModal.show('coletacategoria')\r\n\r\n        },\r\n\r\n        onEnviaColeta(coletas) {\r\n\r\n            this.coletas = coletas\r\n\r\n            this.$bvModal.show('coletacategoria')\r\n\r\n        },\r\n\r\n        enviaColetas() {\r\n\r\n            const params = { config: this.config, data: this.coletasxml }\r\n\r\n            // salva em arquivo texto ...\r\n            if (this.destino == -1) {\r\n                // console.log('enviaColetas:', this.coletas)\r\n                saveToCSV( this.coletasNOenter,  `${this.nome.value}.csv` )\r\n            }\r\n\r\n            if (this.destino > 0) {\r\n                ApiService.setAuthHeader()\r\n                ApiService.post('Servicos/Coletas/Insert', params)\r\n                    .then((res) => {\r\n                        this.coletas = []\r\n                        this.coletasxml = ''\r\n                        this.consultaColetas()\r\n                        this.actToast({ message: 'Registro salvo com sucesso !', variant: 'success'})\r\n                    })\r\n                    .catch(e => {\r\n                        console.log('Erro: ', e)\r\n                        this.actToast({ message: 'Erro ao incluir o registro !', variant: 'danger'})\r\n                    })\r\n            }\r\n\r\n        },\r\n\r\n        consultaColetas() {\r\n\r\n            ApiService.setAuthHeader()\r\n            ApiService.post('Servicos/Coletas/Select', {})\r\n                .then((res) => {\r\n                    this.consultacoletas = []\r\n                    if ((res.status == '200') && (res.data.Success == 'True'))\r\n                      this.consultacoletas = res.data.Data\r\n                })\r\n                .catch(e => {\r\n                    console.log('Erro: ', e)\r\n                    this.actToast({ message: 'Erro ao consultar coletas !', variant: 'danger'})\r\n                })\r\n\r\n        }\r\n\r\n    }\r\n    \r\n}\r\n</script>\r\n"]}]}