{"remainingRequest":"C:\\k1-services\\node_modules\\babel-loader\\lib\\index.js!C:\\k1-services\\node_modules\\cache-loader\\dist\\cjs.js??ref--1-0!C:\\k1-services\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\k1-services\\src\\components\\InputSearch2.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\k1-services\\src\\components\\InputSearch2.vue","mtime":1670977910585},{"path":"C:\\k1-services\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1670977934221},{"path":"C:\\k1-services\\node_modules\\babel-loader\\lib\\index.js","mtime":1670977935138},{"path":"C:\\k1-services\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1670977934221},{"path":"C:\\k1-services\\node_modules\\vue-loader\\lib\\index.js","mtime":1670977935327}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KaW1wb3J0IHsgbWFwQWN0aW9ucyB9IGZyb20gJ3Z1ZXgnOwppbXBvcnQgQXBpU2VydmljZSBmcm9tICcuLi9zZXJ2aWNlcy9hcGkuc2VydmljZSc7CmltcG9ydCBUYWJsZUVkaXRBcGkgZnJvbSAnLi4vY29tcG9uZW50cy9UYWJsZUVkaXRBcGknOwpleHBvcnQgZGVmYXVsdCB7CiAgbmFtZTogJ0lucHV0U2VhcmNoMicsCiAgY29tcG9uZW50czogewogICAgVGFibGVFZGl0QXBpCiAgfSwKICBwcm9wczogewogICAgcGs6IHsKICAgICAgdHlwZTogU3RyaW5nLAoKICAgICAgZGVmYXVsdCgpIHsKICAgICAgICByZXR1cm4gJy0nOwogICAgICB9CgogICAgfSwKICAgIGlkOiB7CiAgICAgIHR5cGU6IFN0cmluZywKCiAgICAgIGRlZmF1bHQoKSB7CiAgICAgICAgcmV0dXJuICdJbnB1dFNlYXJjaERlZmF1bHQnOwogICAgICB9CgogICAgfSwKICAgIG1vZGFsdGl0bGU6IHsKICAgICAgdHlwZTogU3RyaW5nLAoKICAgICAgZGVmYXVsdCgpIHsKICAgICAgICByZXR1cm4gJ1Jlc3VsdGFkbyBkYSBidXNjYSc7CiAgICAgIH0KCiAgICB9LAogICAgcm91dGVhcGk6IHsKICAgICAgdHlwZTogU3RyaW5nLAoKICAgICAgZGVmYXVsdCgpIHsKICAgICAgICByZXR1cm4gJyc7CiAgICAgIH0KCiAgICB9LAogICAgcGFyYW1zOiB7CiAgICAgIHR5cGU6IE9iamVjdCwKCiAgICAgIGRlZmF1bHQoKSB7CiAgICAgICAgcmV0dXJuIHsKICAgICAgICAgIHBhcmFtczogewogICAgICAgICAgICBwZXNxdWlzYTogJycKICAgICAgICAgIH0KICAgICAgICB9OwogICAgICB9CgogICAgfSwKICAgIGZpZWxkTGlzdDogewogICAgICB0eXBlOiBBcnJheSwKCiAgICAgIGRlZmF1bHQoKSB7CiAgICAgICAgcmV0dXJuIFt7CiAgICAgICAgICBrZXk6ICd2YWx1ZScsCiAgICAgICAgICBjYXB0aW9uOiAnQ8OzZGlnbycsCiAgICAgICAgICBzb3J0YWJsZTogdHJ1ZQogICAgICAgIH0sIHsKICAgICAgICAgIGtleTogJ3RleHQnLAogICAgICAgICAgY2FwdGlvbjogJ0Rlc2NyacOnw6NvJywKICAgICAgICAgIHNvcnRhYmxlOiB0cnVlCiAgICAgICAgfV07CiAgICAgIH0KCiAgICB9LAogICAgc2l6ZTogewogICAgICB0eXBlOiBTdHJpbmcsCgogICAgICBkZWZhdWx0KCkgewogICAgICAgIHJldHVybiAnc20nOwogICAgICB9CgogICAgfSwKICAgIGJ1dHRvbkNhcHRpb246IHsKICAgICAgdHlwZTogU3RyaW5nLAoKICAgICAgZGVmYXVsdCgpIHsKICAgICAgICByZXR1cm4gJ0J1c2Nhcic7CiAgICAgIH0KCiAgICB9CiAgfSwKCiAgZGF0YSgpIHsKICAgIHJldHVybiB7CiAgICAgIHZhbHVlOiB0aGlzLnBrIHx8ICctJywKICAgICAgdGV4dDogJycsCiAgICAgIGxpc3RMb2FkOiBmYWxzZSwKICAgICAgaXRlbXNMaXN0OiBbXQogICAgfTsKICB9LAoKICBjb21wdXRlZDogewogICAgcGFyYW1zYXBpKCkgewogICAgICByZXR1cm4gewogICAgICAgIHBlc3F1aXNhOiB0aGlzLnRleHQKICAgICAgfTsgLy8gdm91IHRlciBxdWUgZW5nZXNzYXIgYXF1aQogICAgfQoKICB9LAogIG1ldGhvZHM6IHsgLi4ubWFwQWN0aW9ucyhbJ2FjdEFsZXJ0J10pLAoKICAgIGlucHV0KCkgewogICAgICB0aGlzLiRlbWl0KCdpbnB1dCcsIHRoaXMudmFsdWUpOwogICAgfSwKCiAgICBzZWFyY2goZXZ0LCB0ZXh0ID0gbnVsbCkgewogICAgICBpZiAodGV4dCkgewogICAgICAgIHRoaXMudGV4dCA9IHRleHQ7CiAgICAgIH0KCiAgICAgIHRoaXMubGlzdExvYWQgPSB0cnVlOwogICAgICBBcGlTZXJ2aWNlLnBvc3QodGhpcy5yb3V0ZWFwaSwgdGhpcy5wYXJhbXNhcGkpLnRoZW4ocmVzID0+IHsKICAgICAgICB0aGlzLmxpc3RMb2FkID0gZmFsc2U7CgogICAgICAgIGlmIChyZXMuZGF0YS5TdWNjZXNzID09ICdGYWxzZScpIHsKICAgICAgICAgIHRoaXMuYWN0QWxlcnQoewogICAgICAgICAgICB2YXJpYW50OiAnZGFuZ2VyJywKICAgICAgICAgICAgbWVzc2FnZTogcmVzLmRhdGEuRXJyb3IKICAgICAgICAgIH0pOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBpZiAocmVzLmRhdGEuU3VjY2VzcyA9PSAnVHJ1ZScpIHsKICAgICAgICAgICAgdGhpcy5pdGVtc0xpc3QgPSByZXMuZGF0YS5EYXRhLm1hcChkID0+IHsKICAgICAgICAgICAgICByZXR1cm4gewogICAgICAgICAgICAgICAgdmFsdWU6IGQudmFsdWUsCiAgICAgICAgICAgICAgICB0ZXh0OiBkLnRleHQKICAgICAgICAgICAgICB9OwogICAgICAgICAgICB9KTsKCiAgICAgICAgICAgIGlmICh0aGlzLml0ZW1zTGlzdC5sZW5ndGggPiAxKSB7CiAgICAgICAgICAgICAgdGhpcy4kYnZNb2RhbC5zaG93KGBJbnB1dFNlYXJjaF9Nb2RhbC0ke3RoaXMuaWR9YCk7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgdGhpcy5zZWFyY2hGb3VuZGVkKHRoaXMuaXRlbXNMaXN0WzBdKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSwgZXJyb3IgPT4gewogICAgICAgIGxldCBsZXJyb3IgPSB7CiAgICAgICAgICBzdGF0dXM6IDAsCiAgICAgICAgICBjb2RlOiAtMSwKICAgICAgICAgIG1lc3NhZ2U6ICcnLAogICAgICAgICAgZXJyb3I6IHt9LAogICAgICAgICAgcmVzcG9uc2U6IHt9CiAgICAgICAgfTsKCiAgICAgICAgaWYgKGVycm9yID09ICdFcnJvcjogTmV0d29yayBFcnJvcicpIHsKICAgICAgICAgIGxlcnJvci5zdGF0dXMgPSA1MDU7CiAgICAgICAgICBsZXJyb3IubWVzc2FnZSA9ICdFcnJvIG5hIHJlZGUnOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBsZXJyb3IuZXJyb3IgPSBlcnJvcjsKCiAgICAgICAgICBpZiAoZXJyb3IuaGFzT3duUHJvcGVydHkoJ3Jlc3BvbnNlJykpIHsKICAgICAgICAgICAgbGVycm9yLnJlc3BvbnNlID0gZXJyLnJlc3BvbnNlOwogICAgICAgICAgICBpZiAoZXJyb3IucmVzcG9uc2UuaGFzT3duUHJvcGVydHkoJ3N0YXR1cycpKSBsZXJyb3Iuc3RhdHVzID0gZXJyLnJlc3BvbnNlLnN0YXR1czsKICAgICAgICAgICAgaWYgKGVycm9yLnJlc3BvbnNlLmhhc093blByb3BlcnR5KCdtZXNzYWdlJykpIGxlcnJvci5tZXNzYWdlID0gZXJyLnJlc3BvbnNlLm1lc3NhZ2U7CiAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICBpZiAoZXJyb3IuaGFzT3duUHJvcGVydHkoJ3N0YXR1cycpKSBpZiAoZXJyb3Iuc3RhdHVzID09PSA0MDEpIGxlcnJvci5tZXNzYWdlID0gJ0Vycm8gbmEgYXV0ZW50aWNhw6fDo28sIHZlcmlmaXF1ZSB1c3XDoXJpbyBlIHNlbmhhJzsKICAgICAgICBpZiAoZXJyb3IuaGFzT3duUHJvcGVydHkoJ3N0YXR1cycpKSBpZiAoZXJyb3Iuc3RhdHVzID09PSA0MDApIGVycm9yLm1lc3NhZ2UgPSBlcnJvci5yZXNwb25zZS5kYXRhOwogICAgICAgIGNvbnNvbGUubG9nKCdTZWFyY2hBcGk6OnNlYXJjaDogJywgZXJyb3IpOwogICAgICAgIHN0b3JlLmRpc3BhdGNoKCdhY3RTeXN0ZW1FcnJvckxvZycsIGVycm9yKTsKICAgICAgICBjb25zb2xlLmxvZygnU2VhcmNoQXBpLnNlYXJjaC5lcnJvcjonLCBlcnJvcik7CiAgICAgICAgdGhpcy5ldnRFcnJvcihlcnJvci5tZXNzYWdlKTsKICAgICAgICB0aHJvdyBuZXcgRXJyb3IoZXJyb3IpOwogICAgICB9KTsKICAgIH0sCgogICAgc2VhcmNoRm91bmRlZChzZWxlY3RlZCkgewogICAgICAvLyBjb25zb2xlLmxvZygnSW5wdXRTZWFyY2gyLnNlYXJjaEZvdW5kZWQnLCBzZWxlY3RlZCkKICAgICAgdGhpcy50ZXh0ID0gc2VsZWN0ZWQudGV4dDsKICAgICAgdGhpcy52YWx1ZSA9IHNlbGVjdGVkLnZhbHVlOwogICAgICB0aGlzLiRidk1vZGFsLmhpZGUoYElucHV0U2VhcmNoX01vZGFsLSR7dGhpcy5pZH1gKTsKICAgICAgdGhpcy5pbnB1dCgpOwogICAgfSwKCiAgICBldnRzZWxlY3QoZXZ0KSB7CiAgICAgIHRoaXMuc2VhcmNoRm91bmRlZChldnRbMF0pOwogICAgfSwKCiAgICBldnRFcnJvcihlcnJvck1lc3NhZ2UpIHsKICAgICAgdGhpcy4kZW1pdCgnZXZ0LWVycm9yJywgZXJyb3JNZXNzYWdlKTsKICAgIH0KCiAgfQp9Ow=="},{"version":3,"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA8BA;AACA;AACA;AACA;EAEAA,oBAFA;EAIAC;IAEAC;EAFA,CAJA;EAUAC;IACAC;MAAAC;;MAAAC;QAAA;MAAA;;IAAA,CADA;IAEAC;MAAAF;;MAAAC;QAAA;MAAA;;IAAA,CAFA;IAGAE;MAAAH;;MAAAC;QAAA;MAAA;;IAAA,CAHA;IAIAG;MAAAJ;;MAAAC;QAAA;MAAA;;IAAA,CAJA;IAKAI;MAAAL;;MAAAC;QACA;UACAI;YACAC;UADA;QADA;MAKA;;IANA,CALA;IAaAC;MAAAP;;MAAAC;QACA,QACA;UAAAO;UAAAC;UAAAC;QAAA,CADA,EAEA;UAAAF;UAAAC;UAAAC;QAAA,CAFA;MAIA;;IALA,CAbA;IAoBAC;MAAAX;;MAAAC;QAAA;MAAA;;IAAA,CApBA;IAqBAW;MAAAZ;;MAAAC;QAAA;MAAA;;IAAA;EArBA,CAVA;;EAkCAY;IACA;MACAC,qBADA;MAEAC,QAFA;MAGAC,eAHA;MAIAC;IAJA;EAMA,CAzCA;;EA2CAC;IACAC;MACA;QAAAb;MAAA,EADA,CACA;IACA;;EAHA,CA3CA;EAiDAc,WAEA,2BAFA;;IAIAC;MACA;IACA,CANA;;IAQAC;MAEA;QACA;MACA;;MAEA;MAEAC,WACAC,IADA,CACA,aADA,EACA,cADA,EAEAC,IAFA,CAEAC;QAEA;;QACA;UAEA;YAAAC;YAAAC;UAAA;QAEA,CAJA,MAIA;UACA;YACA;cAAA;gBAAAd;gBAAAC;cAAA;YAAA;;YACA;cACA;YACA,CAFA,MAEA;cACA;YACA;UACA;QACA;MACA,CAnBA,EAqBAc;QACA;UACAC,SADA;UAEAC,QAFA;UAGAH,WAHA;UAIAC,SAJA;UAKAG;QALA;;QAQA;UACAC;UACAA;QACA,CAHA,MAGA;UACAA;;UACA;YACAA;YACA;YACA;UACA;QACA;;QAEA,oCACA;QAEA,oCACA;QAEAC;QAEAC;QAEAD;QAEA;QAEA;MACA,CAzDA;IA0DA,CA1EA;;IA4EAE;MAEA;MAEA;MACA;MAEA;MAEA;IACA,CAtFA;;IAwFAC;MAEA;IAEA,CA5FA;;IA8FAC;MACA;IACA;;EAhGA;AAjDA","names":["name","components","TableEditApi","props","pk","type","default","id","modaltitle","routeapi","params","pesquisa","fieldList","key","caption","sortable","size","buttonCaption","data","value","text","listLoad","itemsList","computed","paramsapi","methods","input","search","ApiService","post","then","res","variant","message","error","status","code","response","lerror","console","store","searchFounded","evtselect","evtError"],"sourceRoot":"src/components","sources":["InputSearch2.vue"],"sourcesContent":["<template>\r\n    <div>\r\n        <b-overlay :show=\"listLoad\" rounded=\"sm\">\r\n        <b-input-group :prepend=\"value\" :size=\"size\" @keyup.enter=\"search\">\r\n                <b-form-input type=\"search\" v-model=\"text\" v-bind=\"$attrs\"/>\r\n            <b-input-group-append>\r\n                <b-button size=\"sm\" text=\"Button\" variant=\"primary\" @click=\"search\" :disabled=\"text==''\">{{ buttonCaption }}</b-button>\r\n            </b-input-group-append>\r\n        </b-input-group>\r\n        </b-overlay>\r\n\r\n        <b-modal :id=\"`InputSearch_Modal-${id}`\" okOnly scrollable no-close-on-backdrop :title=\"modaltitle\">\r\n            <TableEditApi\r\n                :fields=\"fieldList\"\r\n                :items=\"itemsList\"\r\n                :page=\"1\"\r\n                :perPage=\"10\"\r\n                :buttons=\"[]\"\r\n                @evt-select=\"evtselect\"/>\r\n        </b-modal>\r\n        <!--\r\n        <b-row>\r\n            <b-col>value: {{value}}</b-col>\r\n            <b-col>text: {{text}}</b-col>\r\n            <b-col>paramsapi: {{paramsapi}}</b-col>\r\n        </b-row>\r\n        -->\r\n    </div>\r\n</template>\r\n<script>\r\nimport { mapActions } from 'vuex'\r\nimport ApiService from '../services/api.service'\r\nimport TableEditApi from '../components/TableEditApi'\r\nexport default {\r\n\r\n    name: 'InputSearch2',\r\n\r\n    components: {\r\n\r\n        TableEditApi\r\n\r\n    },\r\n\r\n    props: {\r\n        pk: { type: String, default() { return '-' } },\r\n        id: { type: String, default() { return 'InputSearchDefault' } },\r\n        modaltitle: { type: String, default() { return 'Resultado da busca' } },\r\n        routeapi: { type: String, default() { return '' } },\r\n        params: { type: Object, default() { \r\n            return {\r\n                    params: {\r\n                        pesquisa: ''\r\n                    }\r\n                }\r\n            }\r\n        },\r\n        fieldList: { type: Array, default() {\r\n                return [\r\n                    { key: 'value', caption: 'Código', sortable: true },\r\n                    { key: 'text', caption: 'Descrição', sortable: true }\r\n                ]\r\n            }\r\n        },\r\n        size: { type: String, default() { return 'sm' } },\r\n        buttonCaption: { type: String, default() { return 'Buscar' } }\r\n    },\r\n\r\n    data() {\r\n        return {\r\n            value: this.pk || '-',\r\n            text: '',\r\n            listLoad: false,\r\n            itemsList: []\r\n        }\r\n    },\r\n\r\n    computed: {\r\n        paramsapi() {\r\n            return { pesquisa: this.text } // vou ter que engessar aqui\r\n        }\r\n    },\r\n\r\n    methods: {\r\n\r\n        ...mapActions(['actAlert']),\r\n\r\n        input() {\r\n            this.$emit('input', this.value)\r\n        },\r\n\r\n        search(evt, text = null) {\r\n\r\n            if (text) {\r\n                this.text = text\r\n            }\r\n\r\n            this.listLoad = true\r\n\r\n            ApiService\r\n                .post(this.routeapi, this.paramsapi)\r\n                .then(res => {\r\n\r\n                    this.listLoad = false\r\n                    if (res.data.Success == 'False') {\r\n\r\n                        this.actAlert({variant: 'danger', message: res.data.Error})\r\n\r\n                    } else {\r\n                        if (res.data.Success == 'True') {\r\n                            this.itemsList = res.data.Data.map(d => { return {value: d.value, text: d.text} })\r\n                            if (this.itemsList.length>1) {\r\n                                this.$bvModal.show(`InputSearch_Modal-${this.id}`)\r\n                            } else {\r\n                                this.searchFounded(this.itemsList[0])\r\n                            }\r\n                        }\r\n                    }\r\n                },\r\n\r\n                error => {\r\n                    let lerror = {\r\n                        status: 0,\r\n                        code: -1,\r\n                        message: '',\r\n                        error: {},\r\n                        response: {}\r\n                    }\r\n\r\n                    if (error == 'Error: Network Error') {\r\n                        lerror.status = 505\r\n                        lerror.message = 'Erro na rede'\r\n                    } else {\r\n                        lerror.error = error\r\n                        if (error.hasOwnProperty('response')) {\r\n                            lerror.response = err.response\r\n                            if (error.response.hasOwnProperty('status')) lerror.status = err.response.status\r\n                            if (error.response.hasOwnProperty('message')) lerror.message = err.response.message\r\n                        }\r\n                    }\r\n\r\n                    if (error.hasOwnProperty('status'))\r\n                    if (error.status === 401) lerror.message = 'Erro na autenticação, verifique usuário e senha'\r\n\r\n                    if (error.hasOwnProperty('status'))\r\n                    if (error.status === 400) error.message = error.response.data\r\n\r\n                    console.log('SearchApi::search: ', error)\r\n\r\n                    store.dispatch('actSystemErrorLog', error)\r\n\r\n                    console.log('SearchApi.search.error:', error)\r\n\r\n                    this.evtError(error.message)\r\n\r\n                    throw new Error(error)\r\n                })\r\n        },\r\n\r\n        searchFounded(selected) {\r\n\r\n            // console.log('InputSearch2.searchFounded', selected)\r\n\r\n            this.text = selected.text\r\n            this.value = selected.value\r\n\r\n            this.$bvModal.hide(`InputSearch_Modal-${this.id}`)\r\n\r\n            this.input()\r\n        },       \r\n\r\n        evtselect(evt) {\r\n\r\n            this.searchFounded(evt[0])\r\n\r\n        },\r\n\r\n        evtError(errorMessage) {\r\n            this.$emit('evt-error', errorMessage)\r\n        }\r\n    }\r\n    \r\n}\r\n</script>"]}]}