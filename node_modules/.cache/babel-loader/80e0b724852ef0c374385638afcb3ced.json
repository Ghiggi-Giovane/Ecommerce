{"remainingRequest":"C:\\k1-services\\node_modules\\babel-loader\\lib\\index.js!C:\\k1-services\\node_modules\\cache-loader\\dist\\cjs.js??ref--1-0!C:\\k1-services\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\k1-services\\src\\pages\\covid\\components\\QrcodeFunc.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\k1-services\\src\\pages\\covid\\components\\QrcodeFunc.vue","mtime":1701906516469},{"path":"C:\\k1-services\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1670977934221},{"path":"C:\\k1-services\\node_modules\\babel-loader\\lib\\index.js","mtime":1670977935138},{"path":"C:\\k1-services\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1670977934221},{"path":"C:\\k1-services\\node_modules\\vue-loader\\lib\\index.js","mtime":1674603023821}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCB7IG1hcEFjdGlvbnMsIG1hcEdldHRlcnMgfSBmcm9tICd2dWV4JzsKaW1wb3J0IFNlYXJjaEFwaSBmcm9tICcuLi8uLi8uLi9jb21wb25lbnRzL1NlYXJjaEFwaSc7CmV4cG9ydCBkZWZhdWx0IHsKICBuYW1lOiAnUXJjb2RlRnVuYycsCiAgZGF0YSgpIHsKICAgIHJldHVybiB7CiAgICAgIGZ1bmM6IHsKICAgICAgICB2YWx1ZTogJy0nLAogICAgICAgIHRleHQ6ICcnCiAgICAgIH0sCiAgICAgIHNob3djYW06IHRydWUsCiAgICAgIHRlc3RlczogJycsCiAgICAgIGNhbWVyYXM6IHsKICAgICAgICBub1JlYXJDYW1lcmE6IGZhbHNlLAogICAgICAgIG5vRnJvbnRDYW1lcmE6IGZhbHNlLAogICAgICAgIHRvcmNoTm90U3VwcG9ydGVkOiBmYWxzZSwKICAgICAgICB0b3JjaEFjdGl2ZTogZmFsc2UsCiAgICAgICAgY29uZmlnOiBudWxsLAogICAgICAgIHNlbGVjdGVkOiAnYXV0bycsCiAgICAgICAgZGF0YTogW10KICAgICAgfQogICAgfTsKICB9LAogIGNvbXBvbmVudHM6IHsKICAgIFNlYXJjaEFwaQogIH0sCiAgY29tcHV0ZWQ6IHsKICAgIC4uLm1hcEdldHRlcnMoWydndHhmdW5jRGF0YSddKSwKICAgIGNhbkNoYW5nZUNhbSgpIHsKICAgICAgcmV0dXJuIHRoaXMuY2FtZXJhcy5kYXRhLmxlbmd0aCA+IDE7CiAgICB9LAogICAgY2FwdGlvbkJ1dHRvbigpIHsKICAgICAgcmV0dXJuIHRoaXMuc2hvd2NhbSA/ICdQZXNxdWlzYXIgZnVuY2lvbsOhcmlvJyA6ICdMZXIgUVJDb2RlJzsKICAgIH0sCiAgICByZWFkb2soKSB7CiAgICAgIHJldHVybiB0aGlzLmNhbWVyYXMuc2VsZWN0ZWQgPT0gJ29mZic7CiAgICB9LAogICAgaWNvbigpIHsKICAgICAgcmV0dXJuIHRoaXMudG9yY2hBY3RpdmUgPyAnbGlnaHRuaW5nJyA6ICdsaWdodG5pbmctZmlsbCc7CiAgICB9CiAgfSwKICBtZXRob2RzOiB7CiAgICAuLi5tYXBBY3Rpb25zKFsnYWN0ZnVuY2J1c2NhciddKSwKICAgIGxpbXBhQnVzY2EoKSB7CiAgICAgIHRoaXMuZnVuYyA9IHsKICAgICAgICB2YWx1ZTogJy0nLAogICAgICAgIHRleHQ6ICcnCiAgICAgIH07CiAgICB9LAogICAgYXN5bmMgb25EZWNvZGUoZGVjb2RlZFN0cmluZykgewogICAgICBpZiAoZGVjb2RlZFN0cmluZy5sZW5ndGggPT0gMzYpIHsKICAgICAgICB0aGlzLmNhbWVyYXMuc2VsZWN0ZWQgPSAnb2ZmJzsKICAgICAgICBhd2FpdCB0aGlzLnRpbWVvdXQoODAwKTsKICAgICAgICB0aGlzLmNhbWVyYXMuc2VsZWN0ZWQgPSAnYXV0byc7CiAgICAgICAgdGhpcy5idXNjYUZ1bmMoZGVjb2RlZFN0cmluZyk7CiAgICAgIH0KICAgIH0sCiAgICBvbkNhbWVyYUNoYW5nZSgpIHsKICAgICAgaWYgKCF0aGlzLmNhbWVyYXMubm9Gcm9udENhbWVyYSAmJiB0aGlzLmNhbWVyYXMuc2VsZWN0ZWQgIT09ICdmcm9udCcpIHsKICAgICAgICB0aGlzLmNhbWVyYXMuc2VsZWN0ZWQgPSAnZnJvbnQnOwogICAgICB9IGVsc2UgewogICAgICAgIGlmICghdGhpcy5jYW1lcmFzLm5vUmVhckNhbWVyYSAmJiB0aGlzLmNhbWVyYXMuc2VsZWN0ZWQgIT09ICdyZWFyJykgewogICAgICAgICAgdGhpcy5jYW1lcmFzLnNlbGVjdGVkID0gJ3JlYXInOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICB0aGlzLmNhbWVyYXMuc2VsZWN0ZWQgPSAnYXV0byc7CiAgICAgICAgfQogICAgICB9CiAgICB9LAogICAgb25Jbml0KHByb21pc2UpIHsKICAgICAgcHJvbWlzZS50aGVuKGNhbXMgPT4gewogICAgICAgIGlmICh0aGlzLmNhbWVyYXMuZGF0YS5sZW5ndGggPT0gMCkgdGhpcy5jYW1lcmFzLmRhdGEgPSBjYW1zLmNhcGFiaWxpdGllcy5mYWNpbmdNb2RlLm1hcChjID0+IHsKICAgICAgICAgIHJldHVybiB7CiAgICAgICAgICAgIHZhbHVlOiBjLAogICAgICAgICAgICB0ZXh0OiBjCiAgICAgICAgICB9OwogICAgICAgIH0pOwogICAgICAgIHRoaXMudG9yY2hBY3RpdmUgPSAhY2Ftcy5jYXBhYmlsaXRpZXMudG9yY2g7CgogICAgICAgIC8vIGNvbnNvbGUubG9nKCdjYW1lcmFzOicsIHRoaXMuY2FtZXJhcykKICAgICAgfSk7CgogICAgICBwcm9taXNlLmNhdGNoKGVycm9yID0+IHsKICAgICAgICBjb25zdCBjYW1lcmFNaXNzaW5nRXJyb3IgPSBlcnJvci5uYW1lID09PSAnT3ZlcmNvbnN0cmFpbmVkRXJyb3InOwogICAgICAgIGNvbnN0IHRyaWVkUmVhckNhbWVyYSA9IHRoaXMuY2FtZXJhcy5zZWxlY3RlZCA9PT0gJ3JlYXInOwogICAgICAgIGNvbnN0IHRyaWVkRnJvbnRDYW1lcmEgPSB0aGlzLmNhbWVyYXMuc2VsZWN0ZWQgPT09ICdmcm9udCc7CiAgICAgICAgaWYgKHRyaWVkUmVhckNhbWVyYSAmJiBjYW1lcmFNaXNzaW5nRXJyb3IpIHsKICAgICAgICAgIHRoaXMuY2FtZXJhcy5ub1JlYXJDYW1lcmEgPSB0cnVlOwogICAgICAgIH0KICAgICAgICBpZiAodHJpZWRGcm9udENhbWVyYSAmJiBjYW1lcmFNaXNzaW5nRXJyb3IpIHsKICAgICAgICAgIHRoaXMuY2FtZXJhcy5ub0Zyb250Q2FtZXJhID0gdHJ1ZTsKICAgICAgICB9CiAgICAgIH0pOwogICAgfSwKICAgIGJ1c2NhRnVuYyhidXNjYSkgewogICAgICBsZXQgcGFyYW1zID0gewogICAgICAgIHBlc3F1aXNhOiB0eXBlb2YgYnVzY2EgPT0gJ29iamVjdCcgPyBidXNjYS52YWx1ZSA6IGJ1c2NhCiAgICAgIH07CiAgICAgIHRoaXMuJGVtaXQoJ2V2dC1idXNjYScsIHBhcmFtcyk7CiAgICB9LAogICAgY2FtZXJhT2soY2FtKSB7fSwKICAgIGFzeW5jIHRpbWVvdXQobXMpIHsKICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKHJlc29sdmUgPT4gewogICAgICAgIHdpbmRvdy5zZXRUaW1lb3V0KHJlc29sdmUsIG1zKTsKICAgICAgfSk7CiAgICB9CiAgfSwKICB3YXRjaDogewogICAgZnVuYyhmdW5jKSB7CiAgICAgIC8vIGNvbnNvbGUubG9nKCdmdW5jOicsIGZ1bmMpCiAgICAgIGlmICh0aGlzLmZ1bmMudmFsdWUgIT09ICctJykgdGhpcy5idXNjYUZ1bmMoZnVuYyk7CiAgICB9CiAgfQp9Ow=="},{"version":3,"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA8BA;AACA;AACA;EAEAA;EAEAC;IACA;MACAC;QAAAC;QAAAC;MAAA;MACAC;MACAC;MACAC;QACAC;QACAC;QACAC;QACAC;QACAC;QACAC;QACAZ;MACA;IACA;EACA;EAEAa;IAEAC;EAEA;EAEAC;IAEA;IAEAC;MACA;IACA;IAEAC;MACA;IACA;IAEAC;MACA;IACA;IAEAC;MACA;IACA;EAEA;EAEAC;IAEA;IAEAC;MACA;QAAAnB;QAAAC;MAAA;IACA;IAEA;MAEA;QAEA;QACA;QACA;QAEA;MACA;IACA;IAEAmB;MAEA;QACA;MACA;QACA;UACA;QACA;UACA;QACA;MACA;IAGA;IAEAC;MACAC;QACA;UAAA;YAAAtB;YAAAC;UAAA;QAAA;QACA;;QAEA;MACA;;MACAqB;QACA;QACA;QACA;QAEA;UACA;QACA;QAEA;UACA;QACA;MACA;IACA;IAEAC;MACA;QACAC;MACA;MACA;IACA;IAEAC,eAEA;IAEA;MACA;QACAC;MACA;IACA;EAEA;EAEAC;IACA5B;MACA;MACA;IACA;EACA;AAEA","names":["name","data","func","value","text","showcam","testes","cameras","noRearCamera","noFrontCamera","torchNotSupported","torchActive","config","selected","components","SearchApi","computed","canChangeCam","captionButton","readok","icon","methods","limpaBusca","onCameraChange","onInit","promise","buscaFunc","pesquisa","cameraOk","window","watch"],"sourceRoot":"src/pages/covid/components","sources":["QrcodeFunc.vue"],"sourcesContent":["<template>\r\n\r\n    <div>\r\n        <div style=\"border: 5px solid transparent;\" v-show=\"showcam\">\r\n            <b-button size=\"sm\" variant=\"info\" @click=\"onCameraChange\" class=\"btn-cams\" :disabled=\"!canChangeCam\"><b-icon-camera/></b-button>\r\n            <b-button size=\"sm\" variant=\"warning\" class=\"btn-torch\"><b-icon :icon=\"icon\"/></b-button>\r\n            <qrcode-stream :camera=\"cameras.selected\" @init=\"onInit\" @decode=\"onDecode\">\r\n                <b-icon-check2-circle v-show=\"readok\" class=\"readok\"/>\r\n            </qrcode-stream>\r\n        </div>\r\n\r\n        <div class=\"pt-2 pb-2\" v-show=\"!showcam\">\r\n            <SearchApi id=\"input-func\" pkid=\"searchFunc\" route=\"Servicos/Funcionarios/Select\" title=\"Funcionário\" v-model=\"func\"/> \r\n        </div>\r\n\r\n        <!-- <b-button block variant=\"primary\" @click=\"showcam = !showcam\" class=\"mt-2 mb-3\">{{ captionButton }}</b-button> -->\r\n        <b-button block variant=\"primary\" @click=\"showcam = !showcam\" class=\"mt-2 mb-3\">{{ captionButton }}</b-button>\r\n        \r\n        <!-- cameras:\r\n        {{ cameras }}<br>\r\n        canChangeCam: {{ canChangeCam }}<br>\r\n        icon: {{ icon }}<br>\r\n        testes: {{ testes }} -->\r\n        \r\n\r\n    </div>\r\n    \r\n</template>\r\n\r\n<script>\r\nimport { mapActions, mapGetters } from 'vuex'\r\nimport SearchApi from '../../../components/SearchApi'\r\nexport default {\r\n    \r\n    name: 'QrcodeFunc',\r\n\r\n    data() {\r\n        return {\r\n            func: {value: '-', text: ''},\r\n            showcam: true,\r\n            testes: '',\r\n            cameras: {\r\n                noRearCamera: false,\r\n                noFrontCamera: false,\r\n                torchNotSupported: false,\r\n                torchActive: false,\r\n                config: null,\r\n                selected: 'auto',\r\n                data: []\r\n            }\r\n        }\r\n    },\r\n\r\n    components: {\r\n\r\n        SearchApi\r\n    \r\n    },\r\n\r\n    computed: {\r\n\r\n        ...mapGetters(['gtxfuncData']),\r\n\r\n        canChangeCam() {\r\n            return (this.cameras.data.length>1)\r\n        },\r\n\r\n        captionButton() {\r\n            return (this.showcam) ? 'Pesquisar funcionário' : 'Ler QRCode'\r\n        },\r\n\r\n        readok() {\r\n            return (this.cameras.selected == 'off')\r\n        },\r\n\r\n        icon() {\r\n            return (this.torchActive) ? 'lightning' : 'lightning-fill'\r\n        }\r\n\r\n    },\r\n\r\n    methods: {\r\n\r\n        ...mapActions(['actfuncbuscar']),\r\n\r\n        limpaBusca() {\r\n            this.func = {value: '-', text: ''}\r\n        },\r\n\r\n        async onDecode(decodedString) {\r\n\r\n            if (decodedString.length == 36) {\r\n    \r\n                this.cameras.selected = 'off'\r\n                await this.timeout(800)\r\n                this.cameras.selected = 'auto'\r\n    \r\n                this.buscaFunc(decodedString)\r\n            }\r\n        },\r\n\r\n        onCameraChange () {\r\n\r\n            if ((!this.cameras.noFrontCamera) && (this.cameras.selected !== 'front')) {\r\n                this.cameras.selected = 'front'\r\n            } else {\r\n                if ((!this.cameras.noRearCamera) && (this.cameras.selected !== 'rear')) {\r\n                    this.cameras.selected = 'rear'\r\n                } else {\r\n                    this.cameras.selected = 'auto'\r\n                }\r\n            }\r\n           \r\n\r\n        },\r\n\r\n        onInit (promise) {\r\n            promise.then(cams => {\r\n                if (this.cameras.data.length == 0) this.cameras.data = cams.capabilities.facingMode.map(c => {return {value: c, text: c}})\r\n                this.torchActive = !cams.capabilities.torch\r\n\r\n                // console.log('cameras:', this.cameras)\r\n            })\r\n            promise.catch(error => {\r\n                const cameraMissingError = error.name === 'OverconstrainedError'\r\n                const triedRearCamera = this.cameras.selected === 'rear'\r\n                const triedFrontCamera = this.cameras.selected === 'front'\r\n\r\n                if (triedRearCamera && cameraMissingError) {\r\n                    this.cameras.noRearCamera = true\r\n                }\r\n\r\n                if (triedFrontCamera && cameraMissingError) {\r\n                    this.cameras.noFrontCamera = true\r\n                }\r\n            })\r\n        },\r\n\r\n        buscaFunc(busca) {\r\n            let params = {\r\n                pesquisa: (typeof(busca)=='object') ? busca.value : busca\r\n            }\r\n            this.$emit('evt-busca', params)\r\n        },\r\n\r\n        cameraOk(cam) {\r\n\r\n        },\r\n\r\n        async timeout (ms) {\r\n            return new Promise(resolve => {\r\n                window.setTimeout(resolve, ms)\r\n            })\r\n        }\r\n\r\n    },\r\n\r\n    watch: {\r\n        func(func) {\r\n            // console.log('func:', func)\r\n            if (this.func.value !== '-') this.buscaFunc(func)\r\n        }\r\n    }\r\n    \r\n}\r\n</script>\r\n\r\n<style scoped>\r\n    .readok {\r\n        color: lime;\r\n        width: 130px;\r\n        height: 130px;\r\n        position: relative;\r\n        margin: 0 auto;\r\n        top: 50%;\r\n        left: 50%;\r\n        transform: translate(-50%, -50%);\r\n    }\r\n    .btn-cams {\r\n        position: absolute;\r\n        z-index: 9;\r\n        right: 0;\r\n        margin-top: 2px;\r\n        margin-right: 22px;       \r\n    }\r\n    .btn-torch {\r\n        position: absolute;\r\n        z-index: 9;\r\n        right: 0;\r\n        margin-top: 2px;\r\n        margin-right: 64px;       \r\n    }\r\n</style>"]}]}