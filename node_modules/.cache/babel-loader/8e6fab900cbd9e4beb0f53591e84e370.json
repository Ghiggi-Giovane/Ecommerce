{"remainingRequest":"C:\\k1-services\\node_modules\\babel-loader\\lib\\index.js!C:\\k1-services\\node_modules\\cache-loader\\dist\\cjs.js??ref--1-0!C:\\k1-services\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\k1-services\\src\\components\\SearchApiNumber.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\k1-services\\src\\components\\SearchApiNumber.vue","mtime":1701906516410},{"path":"C:\\k1-services\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1670977934221},{"path":"C:\\k1-services\\node_modules\\babel-loader\\lib\\index.js","mtime":1670977935138},{"path":"C:\\k1-services\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1670977934221},{"path":"C:\\k1-services\\node_modules\\vue-loader\\lib\\index.js","mtime":1674603023821}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCBBUEkgZnJvbSAiLi4vc2VydmljZXMvYXBpLnNlcnZpY2UiOwppbXBvcnQgVGFibGVFZGl0QXBpIGZyb20gIi4vVGFibGVFZGl0QXBpLnZ1ZSI7CmV4cG9ydCBkZWZhdWx0IHsKICBuYW1lOiAiU2VhcmNoQXBpTnVtYmVyIiwKICBjb21wb25lbnRzOiB7CiAgICBUYWJsZUVkaXRBcGkKICB9LAogIHByb3BzOiB7CiAgICB2YWx1ZTogewogICAgICB0eXBlOiBOdW1iZXIsCiAgICAgIGRlZmF1bHQ6IDAKICAgIH0sCiAgICBwa2lkOiB7CiAgICAgIHR5cGU6IFN0cmluZywKICAgICAgZGVmYXVsdDogTWF0aC5yYW5kb20oMzIpLnRvU3RyaW5nKDMyKS5zcGxpdCgiLiIpLAogICAgICByZXF1aXJlZDogdHJ1ZQogICAgfSwKICAgIHRpdGxlOiB7CiAgICAgIHR5cGU6IFN0cmluZywKICAgICAgZGVmYXVsdDogIlBlc3F1aXNhci4uLiIKICAgIH0sCiAgICByb3V0ZTogewogICAgICB0eXBlOiBTdHJpbmcsCiAgICAgIGRlZmF1bHQ6ICIiCiAgICB9LAogICAgaXRlbXM6IHsKICAgICAgdHlwZTogQXJyYXksCiAgICAgIGRlZmF1bHQoKSB7CiAgICAgICAgcmV0dXJuIFtdOwogICAgICB9CiAgICB9LAogICAgbG9va3VwOiB7CiAgICAgIHR5cGU6IE9iamVjdCwKICAgICAgZGVmYXVsdCgpIHsKICAgICAgICByZXR1cm4gewogICAgICAgICAgdmFsdWU6ICJ2YWx1ZSIsCiAgICAgICAgICB0ZXh0OiAidGV4dCIsCiAgICAgICAgICBsYWJlbHZhbHVlOiAnQ8OzZGlnbycsCiAgICAgICAgICBsYWJlbHRleHQ6ICdEZXNjcmnDp8OjbycKICAgICAgICB9OwogICAgICB9CiAgICB9CiAgfSwKICBkYXRhKCkgewogICAgcmV0dXJuIHsKICAgICAgc2VhcmNodmFsdWU6IHRoaXMudmFsdWUsCiAgICAgIHNlYXJjaHRleHQ6IHRoaXMudmFsdWUgfHwgIiIsCiAgICAgIHNlYXJjaGZsZHM6IHRoaXMubG9va3VwLAogICAgICBkYXRhOiBbXSwKICAgICAgc2VsZWN0ZWQ6IHsKICAgICAgICBbdGhpcy5sb29rdXAudmFsdWVdOiAwLAogICAgICAgIFt0aGlzLmxvb2t1cC52YWx1ZV06ICIiCiAgICAgIH0sCiAgICAgIGRpcnR5OiB0cnVlLAogICAgICBtb2RhbGlkOiBgbW9kYWxfJHt0aGlzLnBraWR9YCwKICAgICAgcmFuZG9taWQ6IE1hdGgucmFuZG9tKDMyKS50b1N0cmluZygzMikuc3BsaXQoIi4iKQogICAgfTsKICB9LAogIGNvbXB1dGVkOiB7CiAgICBwYXJhbXMoKSB7CiAgICAgIHJldHVybiB7CiAgICAgICAgcGVzcXVpc2E6IHRoaXMuc2VhcmNodGV4dCwKICAgICAgICBib2R5OiB0aGlzLnNlYXJjaHRleHQKICAgICAgfTsKICAgIH0sCiAgICBmaWVsZHMoKSB7CiAgICAgIHJldHVybiBbewogICAgICAgIGtleTogdGhpcy5sb29rdXAudmFsdWUsCiAgICAgICAgbGFiZWw6IHRoaXMubG9va3VwLmxhYmVsdmFsdWUgfHwgdGhpcy5sb29rdXAudmFsdWUsCiAgICAgICAgc29ydGFibGU6IHRydWUsCiAgICAgICAgdmlzaWJsZTogdHJ1ZQogICAgICB9LCB7CiAgICAgICAga2V5OiB0aGlzLmxvb2t1cC50ZXh0LAogICAgICAgIGxhYmVsOiB0aGlzLmxvb2t1cC5sYWJlbHRleHQgfHwgdGhpcy5sb29rdXAudGV4dCwKICAgICAgICBzb3J0YWJsZTogdHJ1ZSwKICAgICAgICB2aXNpYmxlOiB0cnVlCiAgICAgIH1dOwogICAgfSwKICAgIHhyYW5kb21pZCgpIHsKICAgICAgcmV0dXJuIE1hdGgucmFuZG9tKDMyKS50b1N0cmluZygzMikuc3BsaXQoIi4iKTsKICAgIH0sCiAgICBhcGkoKSB7CiAgICAgIHJldHVybiBgaHR0cHM6Ly9hcGkuZ3J1cG9rMS5jb20uYnIvYXBpL3YyLyR7dGhpcy5yb3V0ZX1gOwogICAgfQogIH0sCiAgbWV0aG9kczogewogICAgbmV4dElucHV0KCkgewogICAgICB2YXIga2V5Ym9hcmRFdmVudCA9IGRvY3VtZW50LmNyZWF0ZUV2ZW50KCdLZXlib2FyZEV2ZW50Jyk7CiAgICAgIHZhciBpbml0TWV0aG9kID0gdHlwZW9mIGtleWJvYXJkRXZlbnQuaW5pdEtleWJvYXJkRXZlbnQgIT09ICd1bmRlZmluZWQnID8gJ2luaXRLZXlib2FyZEV2ZW50JyA6ICdpbml0S2V5RXZlbnQnOwogICAgICBrZXlib2FyZEV2ZW50W2luaXRNZXRob2RdKCdrZXlkb3duJywKICAgICAgLy8gZXZlbnQgdHlwZToga2V5ZG93biwga2V5dXAsIGtleXByZXNzCiAgICAgIHRydWUsCiAgICAgIC8vIGJ1YmJsZXMKICAgICAgdHJ1ZSwKICAgICAgLy8gY2FuY2VsYWJsZQogICAgICB3aW5kb3csCiAgICAgIC8vIHZpZXc6IHNob3VsZCBiZSB3aW5kb3cKICAgICAgZmFsc2UsCiAgICAgIC8vIGN0cmxLZXkKICAgICAgZmFsc2UsCiAgICAgIC8vIGFsdEtleQogICAgICBmYWxzZSwKICAgICAgLy8gc2hpZnRLZXkKICAgICAgZmFsc2UsCiAgICAgIC8vIG1ldGFLZXkKICAgICAgOSwKICAgICAgLy8ga2V5Q29kZTogdW5zaWduZWQgbG9uZyAtIHRoZSB2aXJ0dWFsIGtleSBjb2RlLCBlbHNlIDAKICAgICAgMCAvLyBjaGFyQ29kZTogdW5zaWduZWQgbG9uZyAtIHRoZSBVbmljb2RlIGNoYXJhY3RlciBhc3NvY2lhdGVkIHdpdGggdGhlIGRlcHJlc3NlZCBrZXksIGVsc2UgMAogICAgICApOwoKICAgICAgZG9jdW1lbnQuZGlzcGF0Y2hFdmVudChrZXlib2FyZEV2ZW50KTsKICAgIH0sCiAgICBnZXRQZWRpZG8oKSB7fSwKICAgIGFzeW5jIGJ1c2Nhcih2YWx1ZSkgewogICAgICBpZiAodmFsdWUgPiAwKSB7CiAgICAgICAgdGhpcy5zZWFyY2h0ZXh0ID0gdmFsdWU7CiAgICAgICAgdGhpcy5kaXJ0eSA9IHRydWU7CiAgICAgIH0KICAgICAgLy8gY29uc29sZS5sb2coJ2J1c2Nhci5kaXJ0eTonLCB0aGlzLmRpcnR5KTsKICAgICAgLy8gY29uc29sZS5sb2coJ2J1c2Nhci52YWx1ZTonLCB0aGlzLnZhbHVlKTsKICAgICAgaWYgKHRoaXMuZGlydHkpIHsKICAgICAgICBpZiAodGhpcy5pdGVtcy5sZW5ndGggPiAwKSB7CiAgICAgICAgICB0aGlzLmRhdGEgPSB0aGlzLml0ZW1zLmZpbHRlcihmID0+IGZbdGhpcy5zZWFyY2hmbGRzLnZhbHVlXS50b1N0cmluZygpLnRvVXBwZXJDYXNlKCkuaW5jbHVkZXModGhpcy5zZWFyY2h0ZXh0LnRvU3RyaW5nKCkudG9VcHBlckNhc2UoKSkgfHwgZlt0aGlzLnNlYXJjaGZsZHMudGV4dF0udG9TdHJpbmcoKS50b1VwcGVyQ2FzZSgpLmluY2x1ZGVzKHRoaXMuc2VhcmNodGV4dC50b1N0cmluZygpLnRvVXBwZXJDYXNlKCkpKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgYXdhaXQgQVBJLnBvc3QodGhpcy5yb3V0ZSwgdGhpcy5wYXJhbXMpLnRoZW4oYXBpZGF0YSA9PiB7CiAgICAgICAgICAgIGNvbnN0IHJlcyA9IEFQSS5wcmVwYXJlRGF0YShhcGlkYXRhLmRhdGEpOwogICAgICAgICAgICBpZiAocmVzLnN1Y2Nlc3MpIHsKICAgICAgICAgICAgICB0aGlzLmRhdGEgPSByZXMuZGF0YTsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICB0aGlzLmRhdGEgPSBbXTsKICAgICAgICAgICAgfQogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICAgIGlmICh0aGlzLmRhdGEubGVuZ3RoID4gMCkgewogICAgICAgICAgaWYgKHRoaXMuZGF0YS5sZW5ndGggPT0gMSkgewogICAgICAgICAgICB0aGlzLnNlbGVjdGRhdGEodGhpcy5kYXRhKTsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHRoaXMuJGJ2TW9kYWwuc2hvdyh0aGlzLm1vZGFsaWQpOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQogICAgfSwKICAgIGV2dHNlbGVjdChkYXRhKSB7CiAgICAgIGNvbnNvbGUubG9nKCJldnRzZWxlY3Q6IiwgZGF0YSk7CiAgICAgIHRoaXMuc2VsZWN0ZGF0YShkYXRhKTsKICAgICAgdGhpcy4kYnZNb2RhbC5oaWRlKHRoaXMubW9kYWxpZCk7CiAgICB9LAogICAgZXZ0cGFnZShkYXRhKSB7CiAgICAgIGNvbnNvbGUubG9nKCJldnRwYWdlOiIsIGRhdGEpOwogICAgfSwKICAgIHNlbGVjdGRhdGEoZGF0YSkgewogICAgICB0aGlzLnNlbGVjdGVkID0gZGF0YVswXTsKICAgICAgdGhpcy5zZWFyY2h2YWx1ZSA9IGRhdGFbMF1bdGhpcy5zZWFyY2hmbGRzLnZhbHVlXTsKICAgICAgdGhpcy5zZWFyY2h0ZXh0ID0gZGF0YVswXVt0aGlzLnNlYXJjaGZsZHMudGV4dF07CiAgICAgIHRoaXMuJGVtaXQoImlucHV0IiwgdGhpcy5zZWFyY2h2YWx1ZSk7CiAgICAgIHRoaXMuZGlydHkgPSBmYWxzZTsKICAgICAgdGhpcy5uZXh0SW5wdXQoKTsKICAgICAgLy8gdGhpcy4kZW1pdCgna2V5ZG93bicsIHtrZXlDb2RlOiA5fSk7CiAgICB9CiAgfSwKCiAgd2F0Y2g6IHsKICAgIHNlYXJjaHRleHQodGV4dCkgewogICAgICB0aGlzLmRpcnR5ID0gdGV4dCAhPT0gdGhpcy5zZWxlY3RlZFt0aGlzLnNlYXJjaGZsZHMudGV4dF0gJiYgdGV4dCAhPT0gIiI7CiAgICB9LAogICAgdmFsdWU6IHsKICAgICAgaW1tZWRpYXRlOiB0cnVlLAogICAgICBoYW5kbGVyKHZhbHVlKSB7CiAgICAgICAgLy8gY29uc29sZS5sb2coJ3dhdGNoLnZhbHVlOmhpdCcpOwogICAgICAgIGlmICh2YWx1ZSAhPT0gdGhpcy5zZWFyY2h2YWx1ZSkgewogICAgICAgICAgdGhpcy5idXNjYXIodmFsdWUpOwogICAgICAgIH0KICAgICAgfQogICAgfQogIH0KfTs="},{"version":3,"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA4CA;AACA;AACA;EACAA;EACAC;IACAC;EACA;EACAC;IACAC;MACAC;MACAC;IACA;IACAC;MACAF;MACAC;MACAE;IACA;IACAC;MACAJ;MACAC;IACA;IACAI;MACAL;MACAC;IACA;IACAK;MACAN;MACAC;QACA;MACA;IACA;IACAM;MACAP;MACAC;QACA;UAAAF;UAAAS;UAAAC;UAAAC;QAAA;MACA;IACA;EACA;EACAC;IACA;MACAC;MACAC;MACAC;MACAH;MACAI;QAAA;QAAA;MAAA;MACAC;MACAC;MACAC;IACA;EACA;EACAC;IACAC;MACA;QACAC;QACAC;MACA;IACA;IACAC;MACA,QACA;QAAAC;QAAAC;QAAAC;QAAAC;MAAA,GACA;QAAAH;QAAAC;QAAAC;QAAAC;MAAA,EACA;IACA;IACAC;MACA,uBACAC,aACAC;IACA;IACAC;MACA;IACA;EACA;EACAC;IACAC;MACA;MACA;MAEAC,0BACA;MAAA;MACA;MAAA;MACA;MAAA;MACAC;MAAA;MACA;MAAA;MACA;MAAA;MACA;MAAA;MACA;MAAA;MACA;MAAA;MACA;MAAA,CACA;;MACAC;IACA;IACAC,aAEA;IACA;MACA;QACA;QACA;MACA;MACA;MACA;MACA;QACA;UACA;QACA;UACA;YACA;YACA;cACA;YACA;cACA;YACA;UACA;QACA;QACA;UACA;YACA;UACA;YACA;UACA;QACA;MACA;IACA;IACAC;MACAC;MACA;MACA;IACA;IACAC;MACAD;IACA;IACAE;MACA;MACA;MACA;MACA;MACA;MAEA;MACA;IACA;EACA;;EACAC;IACA7B;MACA;IACA;IACAd;MACA4C;MACAC;QACA;QACA;UACA;QACA;MACA;IACA;EACA;AACA","names":["name","components","TableEditApi","props","value","type","default","pkid","required","title","route","items","lookup","text","labelvalue","labeltext","data","searchvalue","searchtext","searchflds","selected","dirty","modalid","randomid","computed","params","pesquisa","body","fields","key","label","sortable","visible","xrandomid","toString","split","api","methods","nextInput","keyboardEvent","window","document","getPedido","evtselect","console","evtpage","selectdata","watch","immediate","handler"],"sourceRoot":"src/components","sources":["SearchApiNumber.vue"],"sourcesContent":["<template>\r\n  <div>\r\n    <!-- TODO:\r\n    1-resolver a questão de navegar para o próximo input quando achar o registro.\r\n    -->\r\n    <b-input-group :prepend=\"value.toString()\">\r\n      <b-form-input type=\"search\" v-model=\"searchtext\" @keyup.enter=\"buscar\" v-bind=\"$attrs\"/>\r\n      <b-input-group-append>\r\n        <b-button\r\n          text=\"Button\"\r\n          variant=\"primary\"\r\n          :disabled=\"!dirty\"\r\n          @click=\"buscar\"\r\n          ><b-icon-search/></b-button\r\n        >\r\n      </b-input-group-append>\r\n    </b-input-group>\r\n\r\n    <b-modal\r\n      :id=\"modalid\"\r\n      okOnly\r\n      size=\"xl\"\r\n      scrollable\r\n      no-close-on-backdrop\r\n      :title=\"title\"\r\n    >\r\n      <TableEditApi\r\n        :items=\"data\"\r\n        :fields=\"fields\"\r\n        :page=\"1\"\r\n        :perPage=\"10\"\r\n        :buttons=\"[]\"\r\n        @evt-page=\"evtpage\"\r\n        @evt-select=\"evtselect\"\r\n      />\r\n    </b-modal>\r\n\r\n    <!-- <pre>\r\n      {{fields}}\r\n    </pre> -->\r\n\r\n  </div>\r\n</template>\r\n<script>\r\nimport API from \"../services/api.service\";\r\nimport TableEditApi from \"./TableEditApi.vue\";\r\nexport default {\r\n  name: \"SearchApiNumber\",\r\n  components: {\r\n    TableEditApi,\r\n  },\r\n  props: {\r\n    value: {\r\n      type: Number,\r\n      default: 0,\r\n    },\r\n    pkid: {\r\n      type: String,\r\n      default: Math.random(32).toString(32).split(\".\"),\r\n      required: true,\r\n    },\r\n    title: {\r\n      type: String,\r\n      default: \"Pesquisar...\",\r\n    },\r\n    route: {\r\n      type: String,\r\n      default: \"\",\r\n    },\r\n    items: {\r\n      type: Array,\r\n      default() {\r\n        return []\r\n      }\r\n    },\r\n    lookup: {\r\n      type: Object,\r\n      default() {\r\n        return { value: \"value\", text: \"text\", labelvalue: 'Código', labeltext: 'Descrição' };\r\n      },\r\n    },\r\n  },\r\n  data() {\r\n    return {\r\n      searchvalue: this.value,\r\n      searchtext: this.value || \"\",\r\n      searchflds: this.lookup,\r\n      data: [],\r\n      selected: {[this.lookup.value]: 0, [this.lookup.value]: \"\"} ,\r\n      dirty: true,\r\n      modalid: `modal_${this.pkid}`,\r\n      randomid: Math.random(32).toString(32).split(\".\"),\r\n    };\r\n  },\r\n  computed: {\r\n    params() {\r\n      return {\r\n        pesquisa: this.searchtext,\r\n        body: this.searchtext,\r\n      };\r\n    },\r\n    fields() {\r\n      return [\r\n        { key: this.lookup.value, label: this.lookup.labelvalue || this.lookup.value, sortable: true, visible: true },\r\n        { key: this.lookup.text, label: this.lookup.labeltext || this.lookup.text, sortable: true, visible: true }\r\n      ]\r\n    },\r\n    xrandomid() {\r\n      return Math.random(32)\r\n          .toString(32)\r\n          .split(\".\");\r\n    },\r\n    api() {\r\n      return `https://api.grupok1.com.br/api/v2/${this.route}`;\r\n    },\r\n  },\r\n  methods: {\r\n    nextInput() {\r\n      var keyboardEvent = document.createEvent('KeyboardEvent');\r\n      var initMethod = typeof keyboardEvent.initKeyboardEvent !== 'undefined' ? 'initKeyboardEvent' : 'initKeyEvent';\r\n\r\n      keyboardEvent[initMethod](\r\n        'keydown', // event type: keydown, keyup, keypress\r\n        true, // bubbles\r\n        true, // cancelable\r\n        window, // view: should be window\r\n        false, // ctrlKey\r\n        false, // altKey\r\n        false, // shiftKey\r\n        false, // metaKey\r\n        9, // keyCode: unsigned long - the virtual key code, else 0\r\n        0, // charCode: unsigned long - the Unicode character associated with the depressed key, else 0\r\n      );\r\n      document.dispatchEvent(keyboardEvent);\r\n    },\r\n    getPedido() {\r\n\r\n    },\r\n    async buscar(value) {\r\n      if (value > 0) {\r\n        this.searchtext = value;\r\n        this.dirty = true;\r\n      }\r\n      // console.log('buscar.dirty:', this.dirty);\r\n      // console.log('buscar.value:', this.value);\r\n      if (this.dirty) {\r\n        if (this.items.length > 0) {\r\n          this.data = this.items.filter(f=>(f[this.searchflds.value].toString().toUpperCase().includes(this.searchtext.toString().toUpperCase()) || f[this.searchflds.text].toString().toUpperCase().includes(this.searchtext.toString().toUpperCase())));\r\n        } else {\r\n          await API.post(this.route, this.params).then((apidata) => {\r\n            const res = API.prepareData(apidata.data);\r\n            if (res.success) {\r\n              this.data = res.data;\r\n            } else {\r\n              this.data = [];\r\n            }\r\n          });\r\n        }\r\n        if (this.data.length > 0) {\r\n          if (this.data.length == 1) {\r\n            this.selectdata(this.data);\r\n          } else {\r\n            this.$bvModal.show(this.modalid);\r\n          }\r\n        }\r\n      }\r\n    },\r\n    evtselect(data) {\r\n      console.log(\"evtselect:\", data);\r\n      this.selectdata(data);\r\n      this.$bvModal.hide(this.modalid);\r\n    },\r\n    evtpage(data) {\r\n      console.log(\"evtpage:\", data);\r\n    },\r\n    selectdata(data) {\r\n      this.selected = data[0];\r\n      this.searchvalue = data[0][this.searchflds.value];\r\n      this.searchtext = data[0][this.searchflds.text];\r\n      this.$emit(\"input\", this.searchvalue);\r\n      this.dirty = false;\r\n\r\n      this.nextInput();\r\n      // this.$emit('keydown', {keyCode: 9});\r\n    },\r\n  },\r\n  watch: {\r\n    searchtext(text) {\r\n      this.dirty = (text !== this.selected[this.searchflds.text] && text !== \"\");\r\n    },\r\n    value: {\r\n      immediate: true,\r\n      handler(value) {\r\n        // console.log('watch.value:hit');\r\n        if (value !== this.searchvalue ) {\r\n          this.buscar(value);\r\n        }\r\n      }\r\n    }\r\n  },\r\n};\r\n</script>\r\n"]}]}