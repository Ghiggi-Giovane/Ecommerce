{"remainingRequest":"C:\\k1-services\\node_modules\\babel-loader\\lib\\index.js!C:\\k1-services\\src\\services\\jwt.service.js","dependencies":[{"path":"C:\\k1-services\\src\\services\\jwt.service.js","mtime":1670977910675},{"path":"C:\\k1-services\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1670977934221},{"path":"C:\\k1-services\\node_modules\\babel-loader\\lib\\index.js","mtime":1670977935138}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IFZ1ZUNvb2tpZXMgZnJvbSAidnVlLWNvb2tpZXMiOwpleHBvcnQgZGVmYXVsdCB7CiAgbmFtZTogIkp3dFNlcnZpY2UiLAoKICBnZXRTdG9yZVVwZGF0ZSgpIHsKICAgIHJldHVybiBudWxsOwogIH0sCgogIHBhcnNlUGF5bG9hZCh0b2tlbikgewogICAgbGV0IHBheWxvYWQgPSBudWxsOwoKICAgIGlmICh0b2tlbikgewogICAgICB2YXIgYmFzZTY0VXJsID0gdG9rZW4uc3BsaXQoIi4iKVsxXTsKICAgICAgdmFyIGJhc2U2NCA9IGJhc2U2NFVybC5yZXBsYWNlKC8tL2csICIrIikucmVwbGFjZSgvXy9nLCAiLyIpOwogICAgICB2YXIganNvblBheWxvYWQgPSBkZWNvZGVVUklDb21wb25lbnQoYXRvYihiYXNlNjQpLnNwbGl0KCIiKS5tYXAoZnVuY3Rpb24gKGMpIHsKICAgICAgICByZXR1cm4gIiUiICsgKCIwMCIgKyBjLmNoYXJDb2RlQXQoMCkudG9TdHJpbmcoMTYpKS5zbGljZSgtMik7CiAgICAgIH0pLmpvaW4oIiIpKTsKICAgICAgcGF5bG9hZCA9IEpTT04ucGFyc2UoanNvblBheWxvYWQpOwogICAgfSAvLyBjb25zb2xlLmxvZygnSnd0U2VydmljZS5wYXJzZVBheWxvYWQ6JywgcGF5bG9hZCkKCgogICAgcmV0dXJuIHBheWxvYWQ7CiAgfSwKCiAgaXNUb2tlblZhbGlkKHRva2VuKSB7CiAgICBpZiAoIXRva2VuKSB0b2tlbiA9IHRoaXMuZ2V0QXV0aFRva2VuKCk7CiAgICBsZXQgand0ID0gdGhpcy5wYXJzZVBheWxvYWQodG9rZW4pOwoKICAgIGlmICghand0KSB7CiAgICAgIHJldHVybiBmYWxzZTsKICAgIH0gZWxzZSB7CiAgICAgIHJldHVybiBuZXcgRGF0ZShqd3QuZXhwICogMTAwMCkgPiBuZXcgRGF0ZSgpOwogICAgfQogIH0sCgogIGdldFBhcnNlZFRva2VuKHRva2VuKSB7CiAgICBsZXQgcGF5bG9hZCA9IG51bGw7CiAgICBpZiAoIXRva2VuKSB0b2tlbiA9IHRoaXMuZ2V0QXV0aFRva2VuKCk7CiAgICBwYXlsb2FkID0gdGhpcy5wYXJzZVBheWxvYWQodG9rZW4pOwoKICAgIGlmIChwYXlsb2FkKSB7CiAgICAgIHBheWxvYWQuZXhwZGF0ZSA9IG5ldyBEYXRlKHBheWxvYWQuZXhwICogMTAwMCk7CiAgICAgIHBheWxvYWQudmFsaWQgPSBuZXcgRGF0ZShwYXlsb2FkLmV4cCAqIDEwMDApID4gbmV3IERhdGUoKTsKICAgIH0KCiAgICBjb25zb2xlLmxvZygiZ2V0UGFyc2VkVG9rZW46IiwgcGF5bG9hZCk7CiAgICByZXR1cm4gcGF5bG9hZDsKICB9LAoKICBkYXRlQWRkKGRhdGUsIGFkZCkgewogICAgbGV0IHJlc3VsdCA9IGRhdGU7CiAgICBpZiAodHlwZW9mIGRhdGUgPT0gIm51bWJlciIpIHJlc3VsdCA9IG5ldyBEYXRlKGRhdGUpOwogICAgcmVzdWx0LnNldERhdGUocmVzdWx0LmdldERhdGUoKSArIGFkZCk7CiAgICByZXR1cm4gcmVzdWx0OwogIH0sCgogIC8vIHBlZ2EgbyB0b2tlbiBkbyB2dWV4IG91IGRvIGxvY2Fsc3RvcmFnZQogIGdldExvY2Fsc3RvcmVUb2tlbigpIHsKICAgIGNvbnN0IGF1dGggPSBKU09OLnBhcnNlKGxvY2FsU3RvcmFnZS5nZXRJdGVtKHRoaXMuZ2V0VXNlck5hbWUoKSkpOwogICAgcmV0dXJuIGF1dGggPyBhdXRoIDogewogICAgICBsb2dpbkF1dGg6IHsKICAgICAgICBhdXRoOiBmYWxzZQogICAgICB9CiAgICB9OwogIH0sCgogIGdldEF1dGhUb2tlbigpIHsKICAgIC8vIGNvbnNvbGUubG9nKCdKd3RTZXJ2aWNlLmdldEF1dGhUb2tlbjonLCB0aGlzLmd0eEF1dGhUb2tlbikKICAgIC8vIGNvbnNvbGUubG9nKCdKd3RTZXJ2aWNlLmdldEF1dGhUb2tlbjonLCBWdWVDb29raWVzLmdldCgnYXV0aFRva2VuJyldKQogICAgLy8gcmV0dXJuIHRoaXMuZ3R4QXV0aFRva2VuIHx8IFZ1ZUNvb2tpZXMuZ2V0KCdhdXRoVG9rZW4nKSB8fCAnJwogICAgLy8gcmV0dXJuIHRoaXMuZ3R4QXV0aFRva2VuIHx8IFZ1ZUNvb2tpZXMuZ2V0KCdhdXRoVG9rZW4nKSB8fCBsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgnc2Vzc2lvblRva2VuJykgfHwgJycKICAgIC8vIHJldHVybiB0aGlzLmd0eEF1dGhUb2tlbiB8fCBWdWVDb29raWVzLmdldCgnYXV0aFRva2VuJykgfHwgJycKICAgIC8vIHJldHVybiB0aGlzLmd0eEF1dGhUb2tlbiB8fCBWdWVDb29raWVzLmdldCgidG9rZW4iKSB8fCAiIjsKICAgIHJldHVybiBWdWVDb29raWVzLmdldCgidG9rZW4iKSB8fCBWdWVDb29raWVzLmdldCgiYW5vbnRva2VuIikgfHwgbnVsbDsKICB9LAoKICBnZXRBbm9uVG9rZW4oKSB7CiAgICAvL2xldCB0b2tlbiA9IG51bGwKICAgIC8vIHRlbnRhIHBlZ2FyIGRhIHByw7NwcmlhIHN0b3JlCiAgICAvL2lmICh0aGlzLmd0eEFub25Ub2tlbikgdG9rZW4gPSB0aGlzLmd0eEFub25Ub2tlbgogICAgLy8gc2UgbsOjbyB0ZW0sIHRlbnRhIHBlZ2FyIGRvIGxvY2Fsc3RvcmUKICAgIC8vaWYgKCF0b2tlbikgdG9rZW4gPSAobG9jYWxTdG9yYWdlLmdldEl0ZW0oJ2xvZ2luQW5vbicpIHx8ICcnKSAhPT0nJyA/IEpTT04ucGFyc2UobG9jYWxTdG9yYWdlLmdldEl0ZW0oJ2xvZ2luQW5vbicpKS50b2tlbiB8fCBudWxsIDogbnVsbAogICAgLy9yZXR1cm4gdG9rZW4KICAgIHJldHVybiBWdWVDb29raWVzLmdldCgiYW5vbnRva2VuIikgfHwgbG9jYWxTdG9yYWdlLmdldEl0ZW0oImFub25Ub2tlbiIpIHx8ICIiOwogIH0sCgogIGdldFRva2VuKGFub24gPSBmYWxzZSkgewogICAgcmV0dXJuIGFub24gPyB0aGlzLmdldEFub25Ub2tlbigpIDogdGhpcy5nZXRBdXRoVG9rZW4oKTsKICB9LAoKICBnZXRVc2VyTmFtZSh0b2tlbikgewogICAgaWYgKCF0b2tlbikgdG9rZW4gPSB0aGlzLmdldEF1dGhUb2tlbigpOwogICAgbGV0IGp3dCA9IHRoaXMucGFyc2VQYXlsb2FkKHRva2VuKTsKCiAgICBpZiAoIWp3dCkgewogICAgICByZXR1cm4gJyc7CiAgICB9IGVsc2UgewogICAgICByZXR1cm4gand0Lmp0aTsKICAgIH0KICAgIC8qDQogICAgaWYgKGxvY2FsU3RvcmFnZS5nZXRJdGVtKCJsb2dpbkF1dGgiKSkgew0KICAgICAgaWYgKGxvY2FsU3RvcmFnZS5nZXRJdGVtKCJsb2dpbkF1dGgiKSAhPT0gIiIpIHsNCiAgICAgICAgcmV0dXJuIGxvY2FsU3RvcmFnZS5nZXRJdGVtKCJsb2dpbkF1dGgiKTsNCiAgICAgIH0gZWxzZSB7DQogICAgICAgIHJldHVybiBudWxsOw0KICAgICAgfQ0KICAgIH0gZWxzZSB7DQogICAgICByZXR1cm4gbnVsbDsNCiAgICB9DQogICAgKi8KCiAgfSwKCiAgZ2V0VXNlclN0b3JlKHVzZXJzdG9yZSkgewogICAgcmV0dXJuIEpTT04ucGFyc2UobG9jYWxTdG9yYWdlLmdldEl0ZW0odXNlcnN0b3JlKSkgfHwgbnVsbDsKICB9LAoKICBnZXRMb2dpbkF1dGgoKSB7CiAgICBjb25zdCBhdXRoID0gSlNPTi5wYXJzZShsb2NhbFN0b3JhZ2UuZ2V0SXRlbSh0aGlzLmdldFVzZXJOYW1lKCkpKTsKICAgIHJldHVybiBhdXRoID8gYXV0aCA6IG51bGw7CiAgfSwKCiAgZ2V0TG9naW5Bbm9uKCkgewogICAgY29uc3QgYW5vbiA9IEpTT04ucGFyc2UobG9jYWxTdG9yYWdlLmdldEl0ZW0oImxvZ2luQW5vbiIpKTsKICAgIHJldHVybiBhbm9uID8gYW5vbiA6IG51bGw7CiAgfQoKfTs="},{"version":3,"names":["VueCookies","name","getStoreUpdate","parsePayload","token","payload","base64Url","split","base64","replace","jsonPayload","decodeURIComponent","atob","map","c","charCodeAt","toString","slice","join","JSON","parse","isTokenValid","getAuthToken","jwt","Date","exp","getParsedToken","expdate","valid","console","log","dateAdd","date","add","result","setDate","getDate","getLocalstoreToken","auth","localStorage","getItem","getUserName","loginAuth","get","getAnonToken","getToken","anon","jti","getUserStore","userstore","getLoginAuth","getLoginAnon"],"sources":["C:/k1-services/src/services/jwt.service.js"],"sourcesContent":["import VueCookies from \"vue-cookies\";\r\n\r\nexport default {\r\n  name: \"JwtService\",\r\n\r\n  getStoreUpdate() {\r\n    return null;\r\n  },\r\n\r\n  parsePayload(token) {\r\n    let payload = null;\r\n\r\n    if (token) {\r\n      var base64Url = token.split(\".\")[1];\r\n      var base64 = base64Url.replace(/-/g, \"+\").replace(/_/g, \"/\");\r\n      var jsonPayload = decodeURIComponent(\r\n        atob(base64)\r\n          .split(\"\")\r\n          .map(function(c) {\r\n            return \"%\" + (\"00\" + c.charCodeAt(0).toString(16)).slice(-2);\r\n          })\r\n          .join(\"\")\r\n      );\r\n      payload = JSON.parse(jsonPayload);\r\n    }\r\n\r\n    // console.log('JwtService.parsePayload:', payload)\r\n\r\n    return payload;\r\n  },\r\n\r\n  isTokenValid(token) {\r\n    if (!token) token = this.getAuthToken();\r\n\r\n    let jwt = this.parsePayload(token);\r\n\r\n    if (!jwt) {\r\n      return false;\r\n    } else {\r\n      return new Date(jwt.exp * 1000) > new Date();\r\n    }\r\n  },\r\n\r\n  getParsedToken(token) {\r\n    let payload = null;\r\n\r\n    if (!token) token = this.getAuthToken();\r\n\r\n    payload = this.parsePayload(token);\r\n\r\n    if (payload) {\r\n      payload.expdate = new Date(payload.exp * 1000);\r\n      payload.valid = new Date(payload.exp * 1000) > new Date();\r\n    }\r\n\r\n    console.log(\"getParsedToken:\", payload);\r\n\r\n    return payload;\r\n  },\r\n\r\n  dateAdd(date, add) {\r\n    let result = date;\r\n    if (typeof date == \"number\") result = new Date(date);\r\n    result.setDate(result.getDate() + add);\r\n    return result;\r\n  },\r\n\r\n  // pega o token do vuex ou do localstorage\r\n\r\n  getLocalstoreToken() {\r\n    const auth = JSON.parse(localStorage.getItem(this.getUserName()));\r\n\r\n    return auth ? auth : { loginAuth: { auth: false } };\r\n  },\r\n\r\n  getAuthToken() {\r\n    // console.log('JwtService.getAuthToken:', this.gtxAuthToken)\r\n    // console.log('JwtService.getAuthToken:', VueCookies.get('authToken')])\r\n\r\n    // return this.gtxAuthToken || VueCookies.get('authToken') || ''\r\n    // return this.gtxAuthToken || VueCookies.get('authToken') || localStorage.getItem('sessionToken') || ''\r\n    // return this.gtxAuthToken || VueCookies.get('authToken') || ''\r\n    // return this.gtxAuthToken || VueCookies.get(\"token\") || \"\";\r\n    return VueCookies.get(\"token\") || VueCookies.get(\"anontoken\") || null;\r\n  },\r\n\r\n  getAnonToken() {\r\n    //let token = null\r\n\r\n    // tenta pegar da própria store\r\n    //if (this.gtxAnonToken) token = this.gtxAnonToken\r\n\r\n    // se não tem, tenta pegar do localstore\r\n    //if (!token) token = (localStorage.getItem('loginAnon') || '') !=='' ? JSON.parse(localStorage.getItem('loginAnon')).token || null : null\r\n\r\n    //return token\r\n\r\n    return (\r\n      VueCookies.get(\"anontoken\") || localStorage.getItem(\"anonToken\") || \"\"\r\n    );\r\n  },\r\n\r\n  getToken(anon = false) {\r\n    return anon ? this.getAnonToken() : this.getAuthToken();\r\n  },\r\n\r\n  getUserName(token) {\r\n    if (!token) token = this.getAuthToken();\r\n\r\n    let jwt = this.parsePayload(token);\r\n\r\n    if (!jwt) {\r\n      return '';\r\n    } else {\r\n      return jwt.jti;\r\n    }\r\n    /*\r\n    if (localStorage.getItem(\"loginAuth\")) {\r\n      if (localStorage.getItem(\"loginAuth\") !== \"\") {\r\n        return localStorage.getItem(\"loginAuth\");\r\n      } else {\r\n        return null;\r\n      }\r\n    } else {\r\n      return null;\r\n    }\r\n    */\r\n  },\r\n\r\n  getUserStore(userstore) {\r\n    return JSON.parse(localStorage.getItem(userstore)) || null;\r\n  },\r\n\r\n  getLoginAuth() {\r\n    const auth = JSON.parse(localStorage.getItem(this.getUserName()));\r\n\r\n    return auth ? auth : null;\r\n  },\r\n\r\n  getLoginAnon() {\r\n    const anon = JSON.parse(localStorage.getItem(\"loginAnon\"));\r\n\r\n    return anon ? anon : null;\r\n  },\r\n};\r\n"],"mappings":"AAAA,OAAOA,UAAP,MAAuB,aAAvB;AAEA,eAAe;EACbC,IAAI,EAAE,YADO;;EAGbC,cAAc,GAAG;IACf,OAAO,IAAP;EACD,CALY;;EAObC,YAAY,CAACC,KAAD,EAAQ;IAClB,IAAIC,OAAO,GAAG,IAAd;;IAEA,IAAID,KAAJ,EAAW;MACT,IAAIE,SAAS,GAAGF,KAAK,CAACG,KAAN,CAAY,GAAZ,EAAiB,CAAjB,CAAhB;MACA,IAAIC,MAAM,GAAGF,SAAS,CAACG,OAAV,CAAkB,IAAlB,EAAwB,GAAxB,EAA6BA,OAA7B,CAAqC,IAArC,EAA2C,GAA3C,CAAb;MACA,IAAIC,WAAW,GAAGC,kBAAkB,CAClCC,IAAI,CAACJ,MAAD,CAAJ,CACGD,KADH,CACS,EADT,EAEGM,GAFH,CAEO,UAASC,CAAT,EAAY;QACf,OAAO,MAAM,CAAC,OAAOA,CAAC,CAACC,UAAF,CAAa,CAAb,EAAgBC,QAAhB,CAAyB,EAAzB,CAAR,EAAsCC,KAAtC,CAA4C,CAAC,CAA7C,CAAb;MACD,CAJH,EAKGC,IALH,CAKQ,EALR,CADkC,CAApC;MAQAb,OAAO,GAAGc,IAAI,CAACC,KAAL,CAAWV,WAAX,CAAV;IACD,CAfiB,CAiBlB;;;IAEA,OAAOL,OAAP;EACD,CA3BY;;EA6BbgB,YAAY,CAACjB,KAAD,EAAQ;IAClB,IAAI,CAACA,KAAL,EAAYA,KAAK,GAAG,KAAKkB,YAAL,EAAR;IAEZ,IAAIC,GAAG,GAAG,KAAKpB,YAAL,CAAkBC,KAAlB,CAAV;;IAEA,IAAI,CAACmB,GAAL,EAAU;MACR,OAAO,KAAP;IACD,CAFD,MAEO;MACL,OAAO,IAAIC,IAAJ,CAASD,GAAG,CAACE,GAAJ,GAAU,IAAnB,IAA2B,IAAID,IAAJ,EAAlC;IACD;EACF,CAvCY;;EAyCbE,cAAc,CAACtB,KAAD,EAAQ;IACpB,IAAIC,OAAO,GAAG,IAAd;IAEA,IAAI,CAACD,KAAL,EAAYA,KAAK,GAAG,KAAKkB,YAAL,EAAR;IAEZjB,OAAO,GAAG,KAAKF,YAAL,CAAkBC,KAAlB,CAAV;;IAEA,IAAIC,OAAJ,EAAa;MACXA,OAAO,CAACsB,OAAR,GAAkB,IAAIH,IAAJ,CAASnB,OAAO,CAACoB,GAAR,GAAc,IAAvB,CAAlB;MACApB,OAAO,CAACuB,KAAR,GAAgB,IAAIJ,IAAJ,CAASnB,OAAO,CAACoB,GAAR,GAAc,IAAvB,IAA+B,IAAID,IAAJ,EAA/C;IACD;;IAEDK,OAAO,CAACC,GAAR,CAAY,iBAAZ,EAA+BzB,OAA/B;IAEA,OAAOA,OAAP;EACD,CAxDY;;EA0Db0B,OAAO,CAACC,IAAD,EAAOC,GAAP,EAAY;IACjB,IAAIC,MAAM,GAAGF,IAAb;IACA,IAAI,OAAOA,IAAP,IAAe,QAAnB,EAA6BE,MAAM,GAAG,IAAIV,IAAJ,CAASQ,IAAT,CAAT;IAC7BE,MAAM,CAACC,OAAP,CAAeD,MAAM,CAACE,OAAP,KAAmBH,GAAlC;IACA,OAAOC,MAAP;EACD,CA/DY;;EAiEb;EAEAG,kBAAkB,GAAG;IACnB,MAAMC,IAAI,GAAGnB,IAAI,CAACC,KAAL,CAAWmB,YAAY,CAACC,OAAb,CAAqB,KAAKC,WAAL,EAArB,CAAX,CAAb;IAEA,OAAOH,IAAI,GAAGA,IAAH,GAAU;MAAEI,SAAS,EAAE;QAAEJ,IAAI,EAAE;MAAR;IAAb,CAArB;EACD,CAvEY;;EAyEbhB,YAAY,GAAG;IACb;IACA;IAEA;IACA;IACA;IACA;IACA,OAAOtB,UAAU,CAAC2C,GAAX,CAAe,OAAf,KAA2B3C,UAAU,CAAC2C,GAAX,CAAe,WAAf,CAA3B,IAA0D,IAAjE;EACD,CAlFY;;EAoFbC,YAAY,GAAG;IACb;IAEA;IACA;IAEA;IACA;IAEA;IAEA,OACE5C,UAAU,CAAC2C,GAAX,CAAe,WAAf,KAA+BJ,YAAY,CAACC,OAAb,CAAqB,WAArB,CAA/B,IAAoE,EADtE;EAGD,CAlGY;;EAoGbK,QAAQ,CAACC,IAAI,GAAG,KAAR,EAAe;IACrB,OAAOA,IAAI,GAAG,KAAKF,YAAL,EAAH,GAAyB,KAAKtB,YAAL,EAApC;EACD,CAtGY;;EAwGbmB,WAAW,CAACrC,KAAD,EAAQ;IACjB,IAAI,CAACA,KAAL,EAAYA,KAAK,GAAG,KAAKkB,YAAL,EAAR;IAEZ,IAAIC,GAAG,GAAG,KAAKpB,YAAL,CAAkBC,KAAlB,CAAV;;IAEA,IAAI,CAACmB,GAAL,EAAU;MACR,OAAO,EAAP;IACD,CAFD,MAEO;MACL,OAAOA,GAAG,CAACwB,GAAX;IACD;IACD;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;EACG,CA7HY;;EA+HbC,YAAY,CAACC,SAAD,EAAY;IACtB,OAAO9B,IAAI,CAACC,KAAL,CAAWmB,YAAY,CAACC,OAAb,CAAqBS,SAArB,CAAX,KAA+C,IAAtD;EACD,CAjIY;;EAmIbC,YAAY,GAAG;IACb,MAAMZ,IAAI,GAAGnB,IAAI,CAACC,KAAL,CAAWmB,YAAY,CAACC,OAAb,CAAqB,KAAKC,WAAL,EAArB,CAAX,CAAb;IAEA,OAAOH,IAAI,GAAGA,IAAH,GAAU,IAArB;EACD,CAvIY;;EAyIba,YAAY,GAAG;IACb,MAAML,IAAI,GAAG3B,IAAI,CAACC,KAAL,CAAWmB,YAAY,CAACC,OAAb,CAAqB,WAArB,CAAX,CAAb;IAEA,OAAOM,IAAI,GAAGA,IAAH,GAAU,IAArB;EACD;;AA7IY,CAAf"}]}