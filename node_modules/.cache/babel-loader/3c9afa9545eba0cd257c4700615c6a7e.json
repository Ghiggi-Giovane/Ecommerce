{"remainingRequest":"C:\\k1-services\\node_modules\\babel-loader\\lib\\index.js!C:\\k1-services\\node_modules\\cache-loader\\dist\\cjs.js??ref--1-0!C:\\k1-services\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\k1-services\\src\\components\\SearchApi3.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\k1-services\\src\\components\\SearchApi3.vue","mtime":1701906516410},{"path":"C:\\k1-services\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1670977934221},{"path":"C:\\k1-services\\node_modules\\babel-loader\\lib\\index.js","mtime":1670977935138},{"path":"C:\\k1-services\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1670977934221},{"path":"C:\\k1-services\\node_modules\\vue-loader\\lib\\index.js","mtime":1674603023821}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCBBUEkgZnJvbSAiLi4vc2VydmljZXMvYXBpLnNlcnZpY2UiOwppbXBvcnQgVGFibGVFZGl0QXBpIGZyb20gIi4vVGFibGVFZGl0QXBpLnZ1ZSI7CmV4cG9ydCBkZWZhdWx0IHsKICBuYW1lOiAiU2VhcmNoQVBJMyIsCiAgY29tcG9uZW50czogewogICAgVGFibGVFZGl0QXBpCiAgfSwKICBwcm9wczogewogICAgdmFsdWU6IHsKICAgICAgdHlwZTogU3RyaW5nLAogICAgICBkZWZhdWx0OiAiIgogICAgfSwKICAgIHRpdGxlOiB7CiAgICAgIHR5cGU6IFN0cmluZywKICAgICAgZGVmYXVsdDogIlBlc3F1aXNhci4uLiIKICAgIH0sCiAgICByb3V0ZTogewogICAgICB0eXBlOiBTdHJpbmcsCiAgICAgIGRlZmF1bHQ6ICIiCiAgICB9LAogICAgbG9va3VwOiB7CiAgICAgIHR5cGU6IE9iamVjdCwKICAgICAgZGVmYXVsdCgpIHsKICAgICAgICByZXR1cm4gewogICAgICAgICAgdmFsdWU6ICJ2YWx1ZSIsCiAgICAgICAgICB0ZXh0OiAidGV4dCIKICAgICAgICB9OwogICAgICB9CiAgICB9CiAgfSwKICBkYXRhKCkgewogICAgcmV0dXJuIHsKICAgICAgc2VhcmNodmFsdWU6IDAsCiAgICAgIHNlYXJjaHRleHQ6IHRoaXMudmFsdWUgfHwgIiIsCiAgICAgIHNlYXJjaGZsZHM6IHRoaXMubG9va3VwLAogICAgICBkYXRhOiBbXSwKICAgICAgZGlydHk6IGZhbHNlLAogICAgICBtb2RhbGlkOiBgbW9kYWxfJHtNYXRoLnJhbmRvbSgzMikudG9TdHJpbmcoMzIpLnNwbGl0KCIuIilbMV19YAogICAgfTsKICB9LAogIGNvbXB1dGVkOiB7CiAgICBwYXJhbXMoKSB7CiAgICAgIHJldHVybiB7CiAgICAgICAgcGVzcXVpc2E6IHRoaXMuc2VhcmNodGV4dCwKICAgICAgICBib2R5OiB0aGlzLnNlYXJjaHRleHQKICAgICAgfTsKICAgIH0sCiAgICBhcGkoKSB7CiAgICAgIHJldHVybiBgaHR0cHM6Ly9hcGkuZ3J1cG9rMS5jb20uYnIvYXBpL3YyLyR7dGhpcy5yb3V0ZX1gOwogICAgfQogIH0sCiAgbWV0aG9kczogewogICAgYnVzY2FyKCkgewogICAgICAvKg0KICAgICAgY29uc3QgZGF0YSA9IHsNCiAgICAgICAgU3VjY2VzczogdHJ1ZSwNCiAgICAgICAgRGF0YTogWw0KICAgICAgICAgIHsgbWFyY2E6ICJJREVMTEkiLCBpZDogMiB9LA0KICAgICAgICAgIHsgbWFyY2E6ICJNWSBIT01FIiwgaWQ6IDYgfSwNCiAgICAgICAgXSwNCiAgICAgIH07DQogICAgICB0aGlzLmRhdGEgPSBkYXRhLkRhdGE7DQogICAgICBpZiAodGhpcy5kYXRhLmxlbmd0aCA9PSAxKSB7DQogICAgICAgIHRoaXMuc2VsZWN0ZGF0YSh0aGlzLmRhdGEpOw0KICAgICAgfSBlbHNlIHsNCiAgICAgICAgdGhpcy4kYnZNb2RhbC5zaG93KHRoaXMubW9kYWxpZCk7DQogICAgICB9DQogICAgICAqLwogICAgICBpZiAodGhpcy5kaXJ0eSkgewogICAgICAgIEFQSS5wb3N0KHRoaXMucm91dGUsIHRoaXMucGFyYW1zKS50aGVuKHJlcyA9PiB7CiAgICAgICAgICBpZiAocmVzLmRhdGEuU3VjY2VzcykgewogICAgICAgICAgICB0aGlzLmRhdGEgPSByZXMuZGF0YS5EYXRhOwogICAgICAgICAgICBpZiAodGhpcy5kYXRhLmxlbmd0aCA9PSAxKSB7CiAgICAgICAgICAgICAgdGhpcy5zZWxlY3RkYXRhKHRoaXMuZGF0YSk7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgdGhpcy4kYnZNb2RhbC5zaG93KHRoaXMubW9kYWxpZCk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHRoaXMuZGF0YSA9IFtdOwogICAgICAgICAgfQogICAgICAgIH0pOwogICAgICB9CiAgICB9LAogICAgZXZ0c2VsZWN0KGRhdGEpIHsKICAgICAgY29uc29sZS5sb2coImV2dHNlbGVjdDoiLCBkYXRhKTsKICAgICAgdGhpcy5zZWxlY3RkYXRhKGRhdGEpOwogICAgICB0aGlzLiRidk1vZGFsLmhpZGUodGhpcy5tb2RhbGlkKTsKICAgIH0sCiAgICBldnRwYWdlKGRhdGEpIHsKICAgICAgY29uc29sZS5sb2coImV2dHBhZ2U6IiwgZGF0YSk7CiAgICB9LAogICAgc2VsZWN0ZGF0YShkYXRhKSB7CiAgICAgIHRoaXMuc2VhcmNodmFsdWUgPSBkYXRhWzBdW3RoaXMuc2VhcmNoZmxkcy52YWx1ZV0udG9TdHJpbmcoKTsKICAgICAgdGhpcy5zZWFyY2h0ZXh0ID0gZGF0YVswXVt0aGlzLnNlYXJjaGZsZHMudGV4dF07CiAgICAgIHRoaXMuJGVtaXQoImlucHV0IiwgdGhpcy5zZWFyY2h2YWx1ZSk7CiAgICAgIHRoaXMuZGlydHkgPSBmYWxzZTsKICAgIH0KICB9LAogIHdhdGNoOiB7CiAgICBzZWFyY2h0ZXh0KHRleHQpIHsKICAgICAgdGhpcy5kaXJ0eSA9IHRydWU7CiAgICAgIGlmICh0ZXh0ID09ICIiKSB0aGlzLnNlYXJjaHZhbHVlID0gIjAiOwogICAgfQogIH0KfTs="},{"version":3,"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAsCA;AACA;AACA;EACAA;EACAC;IACAC;EACA;EACAC;IACAC;MACAC;MACAC;IACA;IACAC;MACAF;MACAC;IACA;IACAE;MACAH;MACAC;IACA;IACAG;MACAJ;MACAC;QACA;UAAAF;UAAAM;QAAA;MACA;IACA;EACA;EACAC;IACA;MACAC;MACAC;MACAC;MACAH;MACAI;MACAC,kBACAC,gBACAC,aACAC,aACA;IACA;EACA;EACAC;IACAC;MACA;QACAC;QACAC;MACA;IACA;IACAC;MACA;IACA;EACA;EACAC;IACAC;MACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;MACA;QACAC;UACA;YACA;YACA;cACA;YACA;cACA;YACA;UACA;YACA;UACA;QACA;MACA;IACA;IACAC;MACAC;MACA;MACA;IACA;IACAC;MACAD;IACA;IACAE;MACA;MACA;MACA;MACA;IACA;EACA;EACAC;IACAnB;MACA;MACA;IACA;EACA;AACA","names":["name","components","TableEditApi","props","value","type","default","title","route","lookup","text","data","searchvalue","searchtext","searchflds","dirty","modalid","Math","toString","split","computed","params","pesquisa","body","api","methods","buscar","API","evtselect","console","evtpage","selectdata","watch"],"sourceRoot":"src/components","sources":["SearchApi3.vue"],"sourcesContent":["<template>\r\n  <div>\r\n    <!-- TODO:\r\n    1-resolver a questão da prop value poder ser any pois vai ter casos onde deverá ser atribuído valores numéricos e string\r\n    -->\r\n    <b-input-group :prepend=\"searchvalue.toString()\">\r\n      <b-form-input type=\"search\" v-model=\"searchtext\" @keyup.enter=\"buscar\" />\r\n      <b-input-group-append>\r\n        <b-button\r\n          text=\"Button\"\r\n          variant=\"primary\"\r\n          :disabled=\"!dirty\"\r\n          @click=\"buscar\"\r\n          >Buscar</b-button\r\n        >\r\n      </b-input-group-append>\r\n    </b-input-group>\r\n\r\n    <b-modal\r\n      :id=\"modalid\"\r\n      okOnly\r\n      size=\"xl\"\r\n      scrollable\r\n      no-close-on-backdrop\r\n      :title=\"title\"\r\n    >\r\n      <TableEditApi\r\n        :items=\"data\"\r\n        :page=\"1\"\r\n        :perPage=\"10\"\r\n        :buttons=\"[]\"\r\n        @evt-page=\"evtpage\"\r\n        @evt-select=\"evtselect\"\r\n      />\r\n    </b-modal>\r\n  </div>\r\n</template>\r\n<script>\r\nimport API from \"../services/api.service\";\r\nimport TableEditApi from \"./TableEditApi.vue\";\r\nexport default {\r\n  name: \"SearchAPI3\",\r\n  components: {\r\n    TableEditApi,\r\n  },\r\n  props: {\r\n    value: {\r\n      type: String,\r\n      default: \"\",\r\n    },\r\n    title: {\r\n      type: String,\r\n      default: \"Pesquisar...\",\r\n    },\r\n    route: {\r\n      type: String,\r\n      default: \"\",\r\n    },\r\n    lookup: {\r\n      type: Object,\r\n      default() {\r\n        return { value: \"value\", text: \"text\" };\r\n      },\r\n    },\r\n  },\r\n  data() {\r\n    return {\r\n      searchvalue: 0,\r\n      searchtext: this.value || \"\",\r\n      searchflds: this.lookup,\r\n      data: [],\r\n      dirty: false,\r\n      modalid: `modal_${\r\n        Math.random(32)\r\n          .toString(32)\r\n          .split(\".\")[1]\r\n      }`,\r\n    };\r\n  },\r\n  computed: {\r\n    params() {\r\n      return {\r\n        pesquisa: this.searchtext,\r\n        body: this.searchtext,\r\n      };\r\n    },\r\n    api() {\r\n      return `https://api.grupok1.com.br/api/v2/${this.route}`;\r\n    },\r\n  },\r\n  methods: {\r\n    buscar() {\r\n      /*\r\n      const data = {\r\n        Success: true,\r\n        Data: [\r\n          { marca: \"IDELLI\", id: 2 },\r\n          { marca: \"MY HOME\", id: 6 },\r\n        ],\r\n      };\r\n      this.data = data.Data;\r\n      if (this.data.length == 1) {\r\n        this.selectdata(this.data);\r\n      } else {\r\n        this.$bvModal.show(this.modalid);\r\n      }\r\n      */\r\n      if (this.dirty) {\r\n        API.post(this.route, this.params).then((res) => {\r\n          if (res.data.Success) {\r\n            this.data = res.data.Data;\r\n            if (this.data.length == 1) {\r\n              this.selectdata(this.data);\r\n            } else {\r\n              this.$bvModal.show(this.modalid);\r\n            }\r\n          } else {\r\n            this.data = [];\r\n          }\r\n        });\r\n      }\r\n    },\r\n    evtselect(data) {\r\n      console.log(\"evtselect:\", data);\r\n      this.selectdata(data);\r\n      this.$bvModal.hide(this.modalid);\r\n    },\r\n    evtpage(data) {\r\n      console.log(\"evtpage:\", data);\r\n    },\r\n    selectdata(data) {\r\n      this.searchvalue = data[0][this.searchflds.value].toString();\r\n      this.searchtext = data[0][this.searchflds.text];\r\n      this.$emit(\"input\", this.searchvalue);\r\n      this.dirty = false;\r\n    },\r\n  },\r\n  watch: {\r\n    searchtext(text) {\r\n      this.dirty = true;\r\n      if (text == \"\") this.searchvalue = \"0\";\r\n    },\r\n  },\r\n};\r\n</script>\r\n"]}]}