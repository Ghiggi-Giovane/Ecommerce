{"remainingRequest":"C:\\k1-services\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\k1-services\\src\\pages\\consultas\\views\\index.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\k1-services\\src\\pages\\consultas\\views\\index.vue","mtime":1670977910613},{"path":"C:\\k1-services\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1670977934221},{"path":"C:\\k1-services\\node_modules\\babel-loader\\lib\\index.js","mtime":1670977935138},{"path":"C:\\k1-services\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1670977934221},{"path":"C:\\k1-services\\node_modules\\vue-loader\\lib\\index.js","mtime":1670977935327}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KDQppbXBvcnQgQVBJIGZyb20gIi4uLy4uLy4uL3NlcnZpY2VzL2FwaS5zZXJ2aWNlIjsNCmltcG9ydCBQYXJhbXMgZnJvbSAiLi4vY29tcG9uZW50cy9wYXJhbXMiOw0KaW1wb3J0IFJlc3VsdFF1ZXJ5IGZyb20gIi4uL2NvbXBvbmVudHMvcmVzdWx0cXVlcnkiOw0KZXhwb3J0IGRlZmF1bHQgew0KICBuYW1lOiAiY29uc3VsdGFzIiwNCiAgY29tcG9uZW50czogew0KICAgIFBhcmFtcywNCiAgICBSZXN1bHRRdWVyeSwNCiAgfSwNCiAgZGF0YSgpIHsNCiAgICByZXR1cm4gew0KICAgICAgY29uc3VsdGFzOiB7DQogICAgICAgIGZpbHRybzogIiIsDQogICAgICAgIHNlbGVjdGVkOiBudWxsLA0KICAgICAgICBkYXRhOiBbXSwNCiAgICAgIH0sDQogICAgfTsNCiAgfSwNCiAgY29tcHV0ZWQ6IHsNCiAgICBjb25zdWx0YXNzZWxlY3RlZCgpIHsNCiAgICAgIHJldHVybiB0aGlzLmNvbnN1bHRhcyA/IHRoaXMuY29uc3VsdGFzLnNlbGVjdGVkIDogIiI7DQogICAgfSwNCiAgICBjb25zdWx0YXNoZWFkZXIoKSB7DQogICAgICBsZXQgcmV0ID0gew0KICAgICAgICBuYW1lOiBudWxsLA0KICAgICAgICBjYXB0aW9uOiBudWxsLA0KICAgICAgICBzZXNzaW9uOiBudWxsLA0KICAgICAgICBpY29uOiBudWxsLA0KICAgICAgICBpZDogbnVsbCwNCiAgICAgIH07DQogICAgICBpZiAodGhpcy5jb25zdWx0YXNzZWxlY3RlZCkgew0KICAgICAgICByZXQubmFtZSA9IHRoaXMuY29uc3VsdGFzc2VsZWN0ZWQubmFtZTsNCiAgICAgICAgcmV0LmNhcHRpb24gPSB0aGlzLmNvbnN1bHRhc3NlbGVjdGVkLmNhcHRpb247DQogICAgICAgIHJldC5zZXNzaW9uID0gdGhpcy5jb25zdWx0YXNzZWxlY3RlZC5zZXNzaW9uOw0KICAgICAgICByZXQuaWNvbiA9IHRoaXMuY29uc3VsdGFzc2VsZWN0ZWQuaWNvbjsNCiAgICAgICAgcmV0LmlkID0gdGhpcy5jb25zdWx0YXNzZWxlY3RlZC5pZDsNCiAgICAgIH0NCiAgICAgIHJldHVybiByZXQ7DQogICAgfSwNCiAgICBjb25zdWx0YXNhcGkoKSB7DQogICAgICByZXR1cm4gdGhpcy5jb25zdWx0YXNzZWxlY3RlZA0KICAgICAgICA/IGB2Mi9TZXJ2aWNvcy9DT05TXy8ke3RoaXMuY29uc3VsdGFzc2VsZWN0ZWQubmFtZX1gDQogICAgICAgIDogIiI7DQogICAgfSwNCiAgICBjb25zdWx0YXNwYXJhbXMoKSB7DQogICAgICBpZiAodGhpcy5jb25zdWx0YXNzZWxlY3RlZCkgew0KICAgICAgICBsZXQgcmV0ID0ge307DQogICAgICAgIHRoaXMuY29uc3VsdGFzc2VsZWN0ZWQucGFyYW1zLm1hcCgocCkgPT4gew0KICAgICAgICAgIHJldCA9IHsgLi4ucmV0LCAuLi57IFtwLm5hbWUucmVwbGFjZSgiQCIsICIiKV06IHAudmFsdWUgfSB9Ow0KICAgICAgICB9KTsNCiAgICAgICAgcmV0dXJuIHJldDsNCiAgICAgIH0gZWxzZSB7DQogICAgICAgIHJldHVybiB7fTsNCiAgICAgIH0NCiAgICB9LA0KICAgIGNvbnN1bHRhc2xpc3QoKSB7DQogICAgICByZXR1cm4gdGhpcy5jb25zdWx0YXMuZGF0YS5maWx0ZXIoDQogICAgICAgIChmKSA9Pg0KICAgICAgICAgIHRoaXMuY29uc3VsdGFzLmZpbHRybyA9PSAiIiB8fA0KICAgICAgICAgIGYubmFtZS50b1VwcGVyQ2FzZSgpLmluY2x1ZGVzKHRoaXMuY29uc3VsdGFzLmZpbHRyby50b1VwcGVyQ2FzZSgpKSB8fA0KICAgICAgICAgIChmLmNhcHRpb24gJiYNCiAgICAgICAgICAgIGYuY2FwdGlvbg0KICAgICAgICAgICAgICAudG9VcHBlckNhc2UoKQ0KICAgICAgICAgICAgICAuaW5jbHVkZXModGhpcy5jb25zdWx0YXMuZmlsdHJvLnRvVXBwZXJDYXNlKCkpKQ0KICAgICAgKTsNCiAgICB9LA0KICB9LA0KICBiZWZvcmVNb3VudCgpIHsNCiAgICB0aGlzLmNvbnN1dGFzR2V0KCk7DQogIH0sDQogIG1ldGhvZHM6IHsNCiAgICBzY3JvbGxNZVRvKHJlZk5hbWUpIHsNCiAgICAgIGNvbnNvbGUubG9nKCJzY3JvbGxNZVRvIik7DQogICAgICBsZXQgZWxlbWVudCA9IHRoaXMuJHJlZnNbcmVmTmFtZV07DQogICAgICBlbGVtZW50LnNjcm9sbEludG9WaWV3KHsgYmVoYXZpb3I6ICJzbW9vdGgiIH0pOw0KICAgIH0sDQogICAgY29uc3VsdGFzc2VsZWN0ZWRhZGQoY29ucykgew0KICAgICAgdGhpcy5jb25zdWx0YXMuc2VsZWN0ZWQgPSBjb25zOw0KDQogICAgICB0aGlzLmNvbnN1bHRhcy5zZWxlY3RlZC5wYXJhbXMubWFwKChwYXJhbSkgPT4gew0KICAgICAgICBBUEkubG9jYWxEQg0KICAgICAgICAgIC5jb2xsZWN0aW9uKHRoaXMuY29uc3VsdGFzc2VsZWN0ZWQubmFtZSkNCiAgICAgICAgICAuZG9jKHBhcmFtLm5hbWUpDQogICAgICAgICAgLmdldCgpDQogICAgICAgICAgLnRoZW4oKHApID0+IHsNCiAgICAgICAgICAgIGlmIChwKSBwYXJhbS52YWx1ZSA9IHAudmFsdWU7DQogICAgICAgICAgfSk7DQogICAgICB9KTsNCiAgICB9LA0KICAgIGNvbnN1dGFzR2V0KCkgew0KICAgICAgQVBJLmdldCgidjIvU2Vydmljb3MvQ09OU19Db25zdWx0YXMvVXN1YXJpbyIsIHRoaXMucGFyYW1zKS50aGVuKChyZXMpID0+IHsNCiAgICAgICAgaWYgKHJlcy5kYXRhLlN1Y2Nlc3MpIHsNCiAgICAgICAgICB0aGlzLmNvbnN1bHRhcy5kYXRhID0gcmVzLmRhdGEuRGF0YTsNCiAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICB0aGlzLmNvbnN1bHRhcy5kYXRhID0gW107DQogICAgICAgIH0NCiAgICAgIH0pOw0KICAgIH0sDQogICAgY29uc3VsdGFzZXhlYygpIHsNCiAgICAgIHRoaXMuY29uc3VsdGFzc2VsZWN0ZWQucGFyYW1zLm1hcCgocCkgPT4gew0KICAgICAgICBBUEkubG9jYWxEQg0KICAgICAgICAgIC5jb2xsZWN0aW9uKHRoaXMuY29uc3VsdGFzc2VsZWN0ZWQubmFtZSkNCiAgICAgICAgICAuYWRkKHsgdmFsdWU6IHAudmFsdWUgfSwgcC5uYW1lKTsNCiAgICAgIH0pOw0KICAgICAgdGhpcy4kYnZNb2RhbC5zaG93KCJtb2RhbC1yZXN1bHQiKTsNCiAgICB9LA0KICB9LA0KfTsNCg=="},{"version":3,"sources":["index.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA2GA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"index.vue","sourceRoot":"src/pages/consultas/views","sourcesContent":["<template>\r\n  <div>\r\n    <b-card class=\"m-2\">\r\n      <h1>Consultas</h1>\r\n      <b-row>\r\n        <b-col>\r\n          <b-input-group prepend=\"Filtro\" size=\"sm\" class=\"mb-2\">\r\n            <b-form-input\r\n              id=\"input-filtro\"\r\n              type=\"search\"\r\n              v-model=\"consultas.filtro\"\r\n              placeholder=\"Informe o nome da consulta\"\r\n            ></b-form-input>\r\n          </b-input-group>\r\n        </b-col>\r\n      </b-row>\r\n      <b-row>\r\n        <b-col>\r\n          <b-list-group>\r\n            <b-list-group-item\r\n              v-for=\"cons of consultaslist\"\r\n              :key=\"cons.id\"\r\n              :ref=\"`_${cons.id}`\"\r\n              :active=\"consultasselected == cons\"\r\n              href=\"#\"\r\n              class=\"flex-column align-items-start\"\r\n            >\r\n              <div\r\n                class=\"d-flex w-100 justify-content-between\"\r\n                v-b-toggle=\"`par_${cons.id}`\"\r\n                @click=\"consultasselectedadd(cons)\"\r\n              >\r\n                <h5>\r\n                  <b-icon :icon=\"cons.icon || 'question-square'\" />\r\n                  {{ cons.caption || cons.name }}\r\n                </h5>\r\n                <!-- <small>\r\n                  <b-badge\r\n                    variant=\"light\"\r\n                    @click.stop.prevent=\"$bvModal.show('modal-details')\"\r\n                  >\r\n                    detalhes\r\n                  </b-badge>\r\n                </small> -->\r\n              </div>\r\n\r\n              <!-- parametros da consulta -->\r\n              <b-collapse :id=\"`par_${cons.id}`\" @shown=\"\">\r\n                <b-card class=\"text-dark\">\r\n                  <Params v-model=\"cons.params\" />\r\n                  <b-button variant=\"primary\" @click=\"consultasexec\"\r\n                    >Pesquisar</b-button\r\n                  >\r\n                  <b-button\r\n                    variant=\"secondary\"\r\n                    @click.stop.prevent=\"$bvModal.show('modal-details')\"\r\n                    >Detalhes</b-button\r\n                  >\r\n                </b-card>\r\n              </b-collapse>\r\n            </b-list-group-item>\r\n          </b-list-group>\r\n        </b-col>\r\n      </b-row>\r\n    </b-card>\r\n\r\n    <!-- MODAIS -->\r\n    <b-modal\r\n      id=\"modal-result\"\r\n      ref=\"modal-result\"\r\n      size=\"xl\"\r\n      :title=\"consultasheader.caption\"\r\n      header-bg-variant=\"primary\"\r\n      header-text-variant=\"light\"\r\n    >\r\n      <ResultQuery\r\n        :api=\"consultasapi\"\r\n        :params=\"consultasparams\"\r\n        :consulta=\"consultasheader\"\r\n      />\r\n    </b-modal>\r\n\r\n    <b-modal\r\n      id=\"modal-details\"\r\n      ref=\"modal-details\"\r\n      size=\"md\"\r\n      :title=\"consultasheader.caption\"\r\n      header-bg-variant=\"primary\"\r\n      header-text-variant=\"light\"\r\n    >\r\n      <div class=\"mb-1\" v-if=\"consultasselected\">\r\n        <p>#ID: {{ consultasselected.id }}</p>\r\n        <p>Nome: {{ consultasselected.name }}</p>\r\n        <p>Caption: {{ consultasselected.caption }}</p>\r\n        <p>Session: {{ consultasselected.session }}</p>\r\n        <p>Icon: {{ consultasselected.icon }}</p>\r\n        <small>{{ consultasselected.session }}</small>\r\n      </div>\r\n      <div v-else>\r\n        <p>Nenhuma consulta selecionada...</p>\r\n        consultasselected: {{ consultasselected }}\r\n      </div>\r\n    </b-modal>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport API from \"../../../services/api.service\";\r\nimport Params from \"../components/params\";\r\nimport ResultQuery from \"../components/resultquery\";\r\nexport default {\r\n  name: \"consultas\",\r\n  components: {\r\n    Params,\r\n    ResultQuery,\r\n  },\r\n  data() {\r\n    return {\r\n      consultas: {\r\n        filtro: \"\",\r\n        selected: null,\r\n        data: [],\r\n      },\r\n    };\r\n  },\r\n  computed: {\r\n    consultasselected() {\r\n      return this.consultas ? this.consultas.selected : \"\";\r\n    },\r\n    consultasheader() {\r\n      let ret = {\r\n        name: null,\r\n        caption: null,\r\n        session: null,\r\n        icon: null,\r\n        id: null,\r\n      };\r\n      if (this.consultasselected) {\r\n        ret.name = this.consultasselected.name;\r\n        ret.caption = this.consultasselected.caption;\r\n        ret.session = this.consultasselected.session;\r\n        ret.icon = this.consultasselected.icon;\r\n        ret.id = this.consultasselected.id;\r\n      }\r\n      return ret;\r\n    },\r\n    consultasapi() {\r\n      return this.consultasselected\r\n        ? `v2/Servicos/CONS_/${this.consultasselected.name}`\r\n        : \"\";\r\n    },\r\n    consultasparams() {\r\n      if (this.consultasselected) {\r\n        let ret = {};\r\n        this.consultasselected.params.map((p) => {\r\n          ret = { ...ret, ...{ [p.name.replace(\"@\", \"\")]: p.value } };\r\n        });\r\n        return ret;\r\n      } else {\r\n        return {};\r\n      }\r\n    },\r\n    consultaslist() {\r\n      return this.consultas.data.filter(\r\n        (f) =>\r\n          this.consultas.filtro == \"\" ||\r\n          f.name.toUpperCase().includes(this.consultas.filtro.toUpperCase()) ||\r\n          (f.caption &&\r\n            f.caption\r\n              .toUpperCase()\r\n              .includes(this.consultas.filtro.toUpperCase()))\r\n      );\r\n    },\r\n  },\r\n  beforeMount() {\r\n    this.consutasGet();\r\n  },\r\n  methods: {\r\n    scrollMeTo(refName) {\r\n      console.log(\"scrollMeTo\");\r\n      let element = this.$refs[refName];\r\n      element.scrollIntoView({ behavior: \"smooth\" });\r\n    },\r\n    consultasselectedadd(cons) {\r\n      this.consultas.selected = cons;\r\n\r\n      this.consultas.selected.params.map((param) => {\r\n        API.localDB\r\n          .collection(this.consultasselected.name)\r\n          .doc(param.name)\r\n          .get()\r\n          .then((p) => {\r\n            if (p) param.value = p.value;\r\n          });\r\n      });\r\n    },\r\n    consutasGet() {\r\n      API.get(\"v2/Servicos/CONS_Consultas/Usuario\", this.params).then((res) => {\r\n        if (res.data.Success) {\r\n          this.consultas.data = res.data.Data;\r\n        } else {\r\n          this.consultas.data = [];\r\n        }\r\n      });\r\n    },\r\n    consultasexec() {\r\n      this.consultasselected.params.map((p) => {\r\n        API.localDB\r\n          .collection(this.consultasselected.name)\r\n          .add({ value: p.value }, p.name);\r\n      });\r\n      this.$bvModal.show(\"modal-result\");\r\n    },\r\n  },\r\n};\r\n</script>\r\n"]}]}