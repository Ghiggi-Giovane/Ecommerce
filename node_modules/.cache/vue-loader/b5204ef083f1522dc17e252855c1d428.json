{"remainingRequest":"C:\\k1-services\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\k1-services\\src\\pages\\carregamento\\views\\index.vue?vue&type=style&index=0&id=68834d94&lang=css&","dependencies":[{"path":"C:\\k1-services\\src\\pages\\carregamento\\views\\index.vue","mtime":1703038179054},{"path":"C:\\k1-services\\node_modules\\css-loader\\dist\\cjs.js","mtime":1670977934642},{"path":"C:\\k1-services\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":1674603024162},{"path":"C:\\k1-services\\node_modules\\postcss-loader\\src\\index.js","mtime":1670977935130},{"path":"C:\\k1-services\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1670977934221},{"path":"C:\\k1-services\\node_modules\\vue-loader\\lib\\index.js","mtime":1674603023821}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKDQouY29sc2FsaWduIHsNCiAgdGV4dC1hbGlnbjogcmlnaHQ7DQp9DQouYnV0dG9ucy1tb2RhbC1jaGFtYWluc3Blc2FvIHsNCiAgdGV4dC1hbGlnbjogY2VudGVyOw0KfQ0KLkxheW91dGNhbWluaGFvYnV0dG9uIHsNCiAgaGVpZ2h0OiA4MnB4Ow0KICB3aWR0aDogMTI2cHg7DQp9DQoudGV4dC1idXR0b24gew0KICBjb2xvcjogYmxhY2s7DQogIGZvbnQtd2VpZ2h0OiBib2xkOw0KfQ0KDQoubGF5b3V0LWljb24tYnV0dG9uLWNhbWluaGFvIHsNCiAgbWFyZ2luLWJvdHRvbTogLTE1cHg7DQp9DQouY29udGFpbmVyLWZsdWlkLWNvbG9yIHsNCiAgYmFja2dyb3VuZC1jb2xvcjogcmdiKDcyLCA4MSwgODYpOw0KfQ0KLnRodW1ibmFpbC1jb250YWluZXIgew0KICBtYXJnaW4tbGVmdDogMjBweDsNCiAgbWFyZ2luLXJpZ2h0OiAyMHB4Ow0KDQogIGp1c3RpZnktY29udGVudDogY2VudGVyOw0KfQ0KLnRodW1ibmFpbC1mbHVpZC1maWxlcyB7DQogIG1hcmdpbi1sZWZ0OiA2cHg7DQogIG1hcmdpbi1yaWdodDogNnB4Ow0KICBtYXJnaW4tdG9wOiA2cHg7DQogIG1hcmdpbi1ib3R0b206IDZweDsNCiAgbWF4LXdpZHRoOiAyNzJweDsNCn0NCkBtZWRpYSAobWF4LXdpZHRoOiA1NzZweCkgew0KICAuY29udGFpbmVyLA0KICAuY29udGFpbmVyLXNtIHsNCiAgICBtYXgtd2lkdGg6IDYwOXB4Ow0KICB9DQp9DQpAbWVkaWEgc2NyZWVuIGFuZCAobWF4LXdpZHRoOiA2MDBweCkgew0KICAuY29sc2FsaWduIHsNCiAgICB0ZXh0LWFsaWduOiBsZWZ0Ow0KICB9DQogIC5saXN0YSB7DQogICAgcGFkZGluZy1sZWZ0OiAzcHg7DQogICAgcGFkZGluZy1yaWdodDogM3B4Ow0KICB9DQp9DQo="},{"version":3,"sources":["index.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA85CA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"index.vue","sourceRoot":"src/pages/carregamento/views","sourcesContent":["<template>\r\n  <div class=\"mx-auto container\">\r\n    <b-card\r\n      class=\"my-2\"\r\n      header-bg-variant=\"primary\"\r\n      header-text-variant=\"white\"\r\n    >\r\n      <template #header>\r\n        <div class=\"d-flex w-100 justify-content-between\">\r\n          <h4 class=\"mb-0\">Controle de cargas</h4>\r\n          <b-button-group>\r\n            <b-button variant=\"light\" v-b-toggle.collapseform>\r\n              <b-icon-caret-up v-if=\"formcollapsed\" />\r\n              <b-icon-caret-down v-else />\r\n              Filtros\r\n            </b-button>\r\n            <b-dropdown\r\n              split\r\n              variant=\"success\"\r\n              @click=\"updatestop = false\"\r\n              title=\"Atualização de coletas\"\r\n              v-if=\"updatestop\"\r\n            >\r\n              <template #button-content>\r\n                <b-icon-play />\r\n              </template>\r\n              <b-dropdown-item-button @click=\"updatetimeout = 5000\"\r\n                ><b-icon-toggle-on\r\n                  v-if=\"updatetimeout == 5000\"\r\n                /><b-icon-toggle-off v-else /><span class=\"ml-2\"\r\n                  >Timer em 5 Segundos</span\r\n                ></b-dropdown-item-button\r\n              >\r\n              <b-dropdown-item-button @click=\"updatetimeout = 15000\"\r\n                ><b-icon-toggle-on\r\n                  v-if=\"updatetimeout == 15000\"\r\n                /><b-icon-toggle-off v-else /><span class=\"ml-2\"\r\n                  >Timer em 15 Segundos</span\r\n                ></b-dropdown-item-button\r\n              >\r\n              <b-dropdown-item-button @click=\"updatetimeout = 30000\"\r\n                ><b-icon-toggle-on\r\n                  v-if=\"updatetimeout == 30000\"\r\n                /><b-icon-toggle-off v-else /><span class=\"ml-2\"\r\n                  >Timer em 30 Segundos</span\r\n                ></b-dropdown-item-button\r\n              >\r\n              <b-dropdown-item-button @click=\"updatetimeout = 60000\"\r\n                ><b-icon-toggle-on\r\n                  v-if=\"updatetimeout == 60000\"\r\n                /><b-icon-toggle-off v-else /><span class=\"ml-2\"\r\n                  >Timer em 1 minuto</span\r\n                ></b-dropdown-item-button\r\n              >\r\n            </b-dropdown>\r\n            <!-- <b-button variant=\"success\" @click=\"updatestop=false\" v-if=\"updatestop\">\r\n          <b-icon-play />\r\n        </b-button>         -->\r\n            <b-button\r\n              variant=\"danger\"\r\n              @click=\"updatestop = true\"\r\n              title=\"Pausar a atualização de coletas\"\r\n              v-else\r\n            >\r\n              <b-icon-pause />\r\n            </b-button>\r\n          </b-button-group>\r\n        </div>\r\n      </template>\r\n      <!--\r\n      selected: {{selected}}<br />\r\n      selectedchecked: {{selectedchecked}}<br />\r\n      selectedcheckedlength: {{selectedcheckedlength}}<br />\r\n\r\n      data: {{data}}<br />\r\n      marcas: {{marcas}}<br />\r\n      marcasselected: {{marcasselected}}<br />\r\n      romaneios[0]: {{romaneios[0]}}<br />\r\n      romaneios[2]: {{romaneios[2]}}\r\n       -->\r\n      <b-collapse id=\"collapseform\" v-model=\"formcollapsed\">\r\n        <b-row>\r\n          <b-col cols=\"12\" md=\"2\">\r\n            <b-form-group\r\n              id=\"input-group-idcarregamento\"\r\n              label-for=\"input-idcarregamento\"\r\n              label=\"Carga\"\r\n            >\r\n              <b-form-input\r\n                id=\"input-idcarregamento\"\r\n                type=\"number\"\r\n                v-model=\"form.idCarregamento\"\r\n              >\r\n              </b-form-input>\r\n            </b-form-group>\r\n          </b-col>\r\n          <b-col cols=\"12\" md=\"3\">\r\n            <b-form-group\r\n              id=\"input-group-database\"\r\n              label-for=\"input-database\"\r\n              label=\"Data Entrada\"\r\n            >\r\n              <b-form-datepicker\r\n                id=\"input-database\"\r\n                :date-format-options=\"{\r\n                  year: 'numeric',\r\n                  month: '2-digit',\r\n                  day: '2-digit',\r\n                }\"\r\n                locale=\"pt\"\r\n                v-model=\"form.entrada\"\r\n              >\r\n              </b-form-datepicker>\r\n            </b-form-group>\r\n          </b-col>\r\n          <b-col cols=\"12\" md=\"4\">\r\n            <b-form-group\r\n              id=\"input-group-motorista\"\r\n              label-for=\"input-motorista\"\r\n              label=\"Motorista\"\r\n            >\r\n              <b-form-input\r\n                id=\"input-motorista\"\r\n                type=\"text\"\r\n                v-model=\"form.motorista\"\r\n              />\r\n            </b-form-group>\r\n          </b-col>\r\n          <b-col cols=\"12\" md=\"3\">\r\n            <b-form-group\r\n              id=\"input-group-placa\"\r\n              label-for=\"input-placa\"\r\n              label=\"Placa\"\r\n            >\r\n              <b-form-input id=\"input-placa\" type=\"text\" v-model=\"form.placa\" />\r\n            </b-form-group>\r\n          </b-col>\r\n        </b-row>\r\n\r\n        <b-row>\r\n          <b-col cols=\"12\">\r\n            <b-form-group\r\n              id=\"input-group-nometransp\"\r\n              label-for=\"input-nometransp\"\r\n              label=\"Transportadora\"\r\n            >\r\n              <b-form-input\r\n                id=\"input-nometransp\"\r\n                type=\"text\"\r\n                v-model=\"form.nometransp\"\r\n              />\r\n            </b-form-group>\r\n          </b-col>\r\n        </b-row>\r\n\r\n        <b-row>\r\n          <b-col cols=\"12\" class=\"mb-2 text-right\">\r\n            <b-button variant=\"success\" @click=\"getCarregamento()\">\r\n              <b-icon-search />\r\n              Buscar\r\n            </b-button>\r\n          </b-col>\r\n        </b-row>\r\n        <hr />\r\n      </b-collapse>\r\n\r\n      <b-row>\r\n        <b-col>\r\n          <b-input-group prepend=\"Filtro\" size=\"sm\" class=\"mb-2\">\r\n            <b-form-input\r\n              id=\"input-filtro\"\r\n              type=\"search\"\r\n              v-model=\"filtro\"\r\n              placeholder=\"Informe a carga, nome da transportadora, motorista ou placa...\"\r\n            ></b-form-input>\r\n          </b-input-group>\r\n        </b-col>\r\n      </b-row>\r\n      <b-row>\r\n        <b-col class=\"text-right\">\r\n          <div class=\"d-flex float-right align-items-center hspaced-4 mb-2\">\r\n            <b-dropdown size=\"sm\" text=\"Marcas\" variant=\"info\" right>\r\n              <b-form-checkbox\r\n                v-for=\"m of marcas\"\r\n                :key=\"m.id\"\r\n                class=\"mb-1 ml-1\"\r\n                switch\r\n                left\r\n                v-model=\"m.checked\"\r\n              >\r\n                {{ m.reduzido }}\r\n              </b-form-checkbox>\r\n            </b-dropdown>\r\n            <b-form-checkbox switch v-model=\"filtroassinados\"\r\n              >Assinados</b-form-checkbox\r\n            >\r\n            <b-form-checkbox switch v-model=\"filtrochecklistassinados\"\r\n              >Checklist Assinados</b-form-checkbox\r\n            >\r\n          </div>\r\n        </b-col>\r\n      </b-row>\r\n\r\n      <b-row>\r\n        <b-col cols=\"12\" class=\"lista\">\r\n          <b-list-group>\r\n            <b-list-group-item\r\n              v-for=\"r in romaneios\"\r\n              v-b-toggle=\"`collapse-romaneio-${r.id}`\"\r\n              :variant=\"classselected(r)\"\r\n              :key=\"r.id\"\r\n              @click=\"doselected(r)\"\r\n              class=\"flex-column align-items-start\"\r\n            >\r\n              <div class=\"d-flex w-100 justify-content-between\">\r\n                <div class=\"mb-3\">\r\n                  Carga:\r\n                  <span class=\"mb-3\"\r\n                    ><b\r\n                      ><span v-copy @click.stop=\"\">{{ r.id }}</span></b\r\n                    ></span\r\n                  >\r\n                </div>\r\n                <div style=\"min-width: 80px\">\r\n                  <b-progress\r\n                    :value=\"r.perc\"\r\n                    :label=\"`${r.perc}%`\"\r\n                    :max=\"100\"\r\n                    :variant=\"classperc(r.perc)\"\r\n                    show-progress\r\n                  ></b-progress>\r\n                </div>\r\n              </div>\r\n\r\n              <div class=\"d-flex w-100 justify-content-between\">\r\n                <h5 class=\"mb-3\">{{ r.codTransp }} - {{ r.transp }}</h5>\r\n                <div style=\"min-width: 80px\">\r\n                  <b-row>\r\n                    <b-col class=\"text-right\">\r\n                      <span class=\"iconbutton\" @click.stop=\"assinar(r)\">\r\n                        <b-icon-pen-fill\r\n                          v-if=\"r.PercAssinados == 100\"\r\n                          variant=\"success\"\r\n                          title=\"Assinar\"\r\n                        />\r\n                        <b-icon-pen-fill\r\n                          v-else\r\n                          variant=\"danger\"\r\n                          title=\"Assinar\"\r\n                        />\r\n                      </span>\r\n                    </b-col>\r\n                    <b-col class=\"text-right\" v-if=\"r.checklistassinatura == 1\">\r\n                      <span\r\n                        class=\"iconbutton\"\r\n                        @click.stop.prevent=\"ChamaDiretoTela(r.tURL)\"\r\n                      >\r\n                        <b-icon-truck variant=\"success\" title=\"Checklist\" />\r\n                      </span>\r\n                    </b-col>\r\n                    <b-col class=\"text-right\" v-if=\"r.checklistassinatura == 0\">\r\n                      <span\r\n                        class=\"iconbutton\"\r\n                        @click.stop.prevent=\"ChamaModal(r.id)\"\r\n                      >\r\n                        <b-icon-truck variant=\"danger\" title=\"checklist\" />\r\n                      </span>\r\n                    </b-col>\r\n\r\n                    <b-col class=\"text-right\" v-if=\"r.checklistfotos == 0\">\r\n                      <span\r\n                        class=\"iconbutton\"\r\n                        @click.stop.prevent=\"ChamarModalFoto(r.id)\"\r\n                      >\r\n                        <b-icon-camera-fill\r\n                          variant=\"danger\"\r\n                          title=\"Checklist\"\r\n                        />\r\n                      </span>\r\n                    </b-col>\r\n                    <b-col class=\"text-right\" v-else=\"r.checklistfotos == 1\">\r\n                      <span\r\n                        class=\"iconbutton\"\r\n                        @click.stop.prevent=\"ChamarModalFotoTrue(r.id)\"\r\n                      >\r\n                        <b-icon-camera-fill\r\n                          variant=\"success\"\r\n                          title=\"checklist\"\r\n                        />\r\n                      </span>\r\n                    </b-col>\r\n\r\n                    <b-col class=\"text-right\">\r\n                      <span>\r\n                        <b-form-checkbox @change=\"marcar\" />\r\n                      </span>\r\n                    </b-col>\r\n                  </b-row>\r\n                </div>\r\n              </div>\r\n\r\n              <div>\r\n                <b-row>\r\n                  <b-col cols=\"6\">\r\n                    <b-row style=\"font-style: italic; font-size: 14px\">\r\n                      <b-col class=\"text-nowrap\" cols=\"12\" lg=\"3\"\r\n                        >Romaneios: <b>{{ r.Romaneios.length }}</b></b-col\r\n                      >\r\n                      <b-col class=\"text-nowrap\" cols=\"12\" lg=\"3\"\r\n                        >Pedidos: <b>{{ r.TPedidos }}</b></b-col\r\n                      >\r\n                      <b-col class=\"text-nowrap\" cols=\"12\" lg=\"3\"\r\n                        >Volumes: <b>{{ r.volumes }}</b></b-col\r\n                      >\r\n                      <b-col class=\"text-nowrap\" cols=\"12\" lg=\"3\"\r\n                        >Última Coleta:\r\n                        <b>{{ r.ultimacoleta | time }}</b></b-col\r\n                      >\r\n                      <b-col class=\"text-nowrap\" cols=\"12\" lg=\"3\"\r\n                        >Valor Total: <b>{{ r.Valor_Com_IPI | R$ }}</b></b-col\r\n                      >\r\n                    </b-row>\r\n                  </b-col>\r\n                  <b-col cols=\"6\" class=\"text-right\">\r\n                    <b-row>\r\n                      <b-col cols=\"12\" lg=\"9\">\r\n                        <span\r\n                          ><b>{{ r.motorista }}</b></span\r\n                        >\r\n                      </b-col>\r\n                      <b-col cols=\"12\" lg=\"3\">\r\n                        <span class=\"text-nowrap\" v-copy @click.stop=\"\">{{\r\n                          r.placa\r\n                        }}</span>\r\n                      </b-col>\r\n                    </b-row>\r\n                  </b-col>\r\n                </b-row>\r\n              </div>\r\n\r\n              <b-collapse\r\n                :id=\"`collapse-romaneio-${r.id}`\"\r\n                v-model=\"r.collapsed\"\r\n                @input=\"getCarregamentoRomaneioDetail(r.idCarregamento)\"\r\n              >\r\n                <b-list-group>\r\n                  <b-list-group-item\r\n                    v-for=\"p in r.Romaneios\"\r\n                    :key=\"p.Romaneio\"\r\n                    :variant=\"\r\n                      p.checked == true\r\n                        ? 'warning'\r\n                        : p.sigImage\r\n                        ? 'success'\r\n                        : ''\r\n                    \"\r\n                    @click.stop=\"\"\r\n                  >\r\n                    <div class=\"d-flex w-100 justify-content-between\">\r\n                      <div class=\"mb-3\">\r\n                        Romaneio:\r\n                        <span class=\"font-weight-bold mb-3\" v-copy>{{\r\n                          p.Romaneio\r\n                        }}</span>\r\n                        Valor:\r\n                        <span class=\"font-weight-bold mb-3\" v-copy>{{\r\n                          p.Valor_Com_IPI | R$\r\n                        }}</span>\r\n                      </div>\r\n                      <div style=\"min-width: 80px\">\r\n                        <b-progress\r\n                          :value=\"p.PercColetados\"\r\n                          :label=\"`${p.PercColetados}%`\"\r\n                          :max=\"100\"\r\n                          :variant=\"classperc(p.PercColetados)\"\r\n                          show-progress\r\n                        ></b-progress>\r\n                      </div>\r\n                    </div>\r\n\r\n                    <div class=\"d-flex w-100 justify-content-between\">\r\n                      <div>\r\n                        <span\r\n                          class=\"text-nowrap iconbutton\"\r\n                          @click=\"modalpedidos(p.Pedidos)\"\r\n                          >Pedidos:\r\n                          <b\r\n                            ><span v-copy @click.stop=\"\">{{\r\n                              p.Pedidos.length\r\n                            }}</span></b\r\n                          ></span\r\n                        >\r\n                        |\r\n                        <span class=\"text-nowrap\"\r\n                          >Volumes: <b>{{ p.TVolumes }}</b></span\r\n                        >\r\n                        |\r\n                        <span class=\"text-nowrap\"\r\n                          >Peso: <b>{{ p.PesoBruto }}</b></span\r\n                        >\r\n                        |\r\n                        <span class=\"text-nowrap\"\r\n                          >Cubagem: <b>{{ p.Cubagem }}</b></span\r\n                        >\r\n                      </div>\r\n                      <div>\r\n                        <b-row>\r\n                          <b-col>\r\n                            <span\r\n                              class=\"iconbutton\"\r\n                              v-if=\"p.sigImage\"\r\n                              @click.stop=\"assinarromaneio(r, p.Romaneio)\"\r\n                            >\r\n                              <b-icon-pen-fill\r\n                                variant=\"success\"\r\n                                title=\"Assinar\"\r\n                              />\r\n                            </span>\r\n                            <span\r\n                              class=\"iconbutton\"\r\n                              v-else\r\n                              @click.stop=\"assinarromaneio(r, p.Romaneio)\"\r\n                            >\r\n                              <b-icon-pen-fill\r\n                                variant=\"danger\"\r\n                                title=\"Assinar\"\r\n                              />\r\n                            </span>\r\n                          </b-col>\r\n\r\n                          <b-col>\r\n                            <b-form-checkbox\r\n                              v-model=\"p.checked\"\r\n                              @click.stop=\"\"\r\n                            />\r\n                          </b-col>\r\n                        </b-row>\r\n                      </div>\r\n                    </div>\r\n                  </b-list-group-item>\r\n                </b-list-group>\r\n              </b-collapse>\r\n            </b-list-group-item>\r\n          </b-list-group>\r\n        </b-col>\r\n      </b-row>\r\n    </b-card>\r\n\r\n    <!-- MODAIS -->\r\n    <b-modal\r\n      id=\"modal-assinar\"\r\n      ref=\"modal-assinar\"\r\n      size=\"lg\"\r\n      scrollable\r\n      no-close-on-backdrop\r\n      :title=\"signatureTitle\"\r\n      ok-only\r\n      ok-title=\"Confirmar Assinaturas\"\r\n      @shown=\"signatureShown\"\r\n      @ok=\"signatureOk\"\r\n      @hide=\"signatureHidden\"\r\n      :ok-disabled=\"!signatureValid\"\r\n    >\r\n      <b-card no-body>\r\n        <b-tabs card v-model=\"tabIndex\">\r\n          <b-tab title=\"Detalhes\" active>\r\n            <div class=\"p-3\">\r\n              <b-row>\r\n                <b-col class=\"colsalign\">\r\n                  <span>Transportadora:</span>\r\n                </b-col>\r\n                <b-col cols=\"12\" sm=\"8\">\r\n                  <div class=\"font-weight-bold\">{{ selected.transp }}</div>\r\n                </b-col>\r\n              </b-row>\r\n              <b-row>\r\n                <b-col class=\"colsalign\">\r\n                  <span class=\"colsalign\">Motorista:</span>\r\n                </b-col>\r\n                <b-col cols=\"12\" sm=\"8\">\r\n                  <div class=\"font-weight-bold\">{{ selected.motorista }}</div>\r\n                </b-col>\r\n              </b-row>\r\n              <b-row>\r\n                <b-col class=\"colsalign\">\r\n                  <span>Placa:</span>\r\n                </b-col>\r\n                <b-col cols=\"12\" sm=\"8\">\r\n                  <div class=\"font-weight-bold\">{{ selected.placa }}</div>\r\n                </b-col>\r\n              </b-row>\r\n              <b-row>\r\n                <b-col class=\"colsalign\">\r\n                  <span>Romaneios:</span>\r\n                </b-col>\r\n                <b-col cols=\"12\" sm=\"8\">\r\n                  <div\r\n                    class=\"font-weight-bold\"\r\n                    :class=\"selectedcheckedlength > 0 ? 'text-danger' : ''\"\r\n                  >\r\n                    {{\r\n                      `${\r\n                        selectedcheckedlength > 0\r\n                          ? selectedcheckedlength + \" de \"\r\n                          : \"\"\r\n                      }`\r\n                    }}{{\r\n                      selected &&\r\n                      selected.Romaneios &&\r\n                      selected.Romaneios.length\r\n                    }}\r\n                  </div>\r\n                </b-col>\r\n              </b-row>\r\n              <b-row>\r\n                <b-col class=\"colsalign\">\r\n                  <span>Volumes:</span>\r\n                </b-col>\r\n                <b-col cols=\"12\" sm=\"8\">\r\n                  <div class=\"font-weight-bold\">{{ selected.volumes }}</div>\r\n                </b-col>\r\n              </b-row>\r\n              <b-row>\r\n                <b-col class=\"colsalign\">\r\n                  <span>Última Coleta:</span>\r\n                </b-col>\r\n                <b-col cols=\"12\" sm=\"8\">\r\n                  <div class=\"font-weight-bold\">\r\n                    {{ selected.ultimacoleta | dateBR }}\r\n                    {{ selected.ultimacoleta | time }}\r\n                  </div>\r\n                </b-col>\r\n              </b-row>\r\n            </div>\r\n          </b-tab>\r\n          <b-tab title=\"Assinatura Motorista\">\r\n            <Signature\r\n              v-if=\"tabIndex == 1\"\r\n              ref=\"signatureRef\"\r\n              :sigImage=\"sigImage\"\r\n              :buttons=\"['clear']\"\r\n              @evtSignatureChange=\"sigChange = true\"\r\n              v-model=\"sigImage\"\r\n            />\r\n          </b-tab>\r\n          <b-tab title=\"Assinatura Conferente\">\r\n            <b-form-group\r\n              id=\"input-group-obsconferente\"\r\n              label-for=\"input-obsconferente\"\r\n              label=\"Observação\"\r\n            >\r\n              <b-form-textarea\r\n                id=\"input-obsconferente\"\r\n                rows=\"3\"\r\n                v-model=\"sigObsConf\"\r\n              />\r\n            </b-form-group>\r\n            <b-form-group\r\n              id=\"input-group-opcoes\"\r\n              label-for=\"input-opcoes\"\r\n              label=\"Opções\"\r\n            >\r\n              <b-form-checkbox-group\r\n                id=\"input-opcoes\"\r\n                :options=\"signatureOptions\"\r\n                v-model=\"opcoes\"\r\n              />\r\n            </b-form-group>\r\n            <Signature\r\n              v-if=\"tabIndex == 2\"\r\n              ref=\"signatureConfRef\"\r\n              :sigImage=\"sigImageConf\"\r\n              :buttons=\"['clear']\"\r\n              @evtSignatureChange=\"sigChangeConf = true\"\r\n              v-model=\"sigImageConf\"\r\n            />\r\n          </b-tab>\r\n          <b-tab title=\"Assinatura Responsável Carga\">\r\n            <Signature\r\n              v-if=\"tabIndex == 3\"\r\n              ref=\"signatureRef\"\r\n              :sigImage=\"sigImageResponCarga\"\r\n              :buttons=\"['clear']\"\r\n              @evtSignatureChange=\"sigChangeResponCarga = true\"\r\n              v-model=\"sigImageResponCarga\"\r\n            />\r\n          </b-tab>\r\n        </b-tabs>\r\n      </b-card>\r\n    </b-modal>\r\n\r\n    <b-modal\r\n      id=\"modal-pedidos\"\r\n      ref=\"modal-pedidos\"\r\n      size=\"lg\"\r\n      scrollable\r\n      no-close-on-backdrop\r\n      :title=\"pedidosTitle\"\r\n      ok-only\r\n      ok-title=\"Fechar\"\r\n    >\r\n      <b-list-group>\r\n        <b-list-group-item\r\n          v-b-toggle=\"`collapse-pedido-${p.Pedido}`\"\r\n          v-for=\"p in pedidos\"\r\n          :key=\"p.Pedido\"\r\n          :variant=\"classpedidos(p)\"\r\n          @click.stop=\"pedidosselected = p\"\r\n          class=\"flex-column align-items-start\"\r\n        >\r\n          <div class=\"d-flex w-100 justify-content-between\">\r\n            <div class=\"mb-3\">\r\n              Pedido:\r\n              <span class=\"mb-3\"\r\n                ><b\r\n                  ><span v-copy @click.stop=\"\">{{ p.Pedido }}</span></b\r\n                ></span\r\n              >\r\n              |\r\n              <span class=\"text-nowrap\"\r\n                >Notas:\r\n                <b\r\n                  ><span v-copy @click.stop=\"\">{{ pedidosNotasSplit }}</span></b\r\n                ></span\r\n              >\r\n            </div>\r\n            <div style=\"min-width: 80px\">\r\n              <b-progress\r\n                :value=\"p.Percentual\"\r\n                :label=\"`${p.Percentual}%`\"\r\n                :max=\"100\"\r\n                :variant=\"classperc(p.Percentual)\"\r\n                show-progress\r\n              ></b-progress>\r\n            </div>\r\n          </div>\r\n          <div class=\"d-flex w-100 justify-content-between\">\r\n            <h5 class=\"mb-3\">{{ p.Codigo_Cliente }} - {{ p.NomeCliente }}</h5>\r\n          </div>\r\n\r\n          <div class=\"d-flex w-100 justify-content-between\">\r\n            <div style=\"font-weight: italic; font-size: 14px\">\r\n              <span class=\"text-nowrap\"\r\n                >Marca: <b>{{ p.marca }}</b></span\r\n              >\r\n              |\r\n              <span class=\"text-nowrap\"\r\n                >Volumes: <b>{{ p.Volumes }}</b></span\r\n              >\r\n              |\r\n              <span class=\"text-nowrap\"\r\n                >Cubagem: <b>{{ p.Cubagem }}</b></span\r\n              >\r\n              |\r\n              <span class=\"text-nowrap\"\r\n                >Peso Bruto: <b>{{ p.PesoBruto }}</b></span\r\n              >\r\n            </div>\r\n            <!-- <span class=\"font-weight-bold\">{{r.motorista}} [ {{r.placa}} ]</span> -->\r\n          </div>\r\n\r\n          <b-collapse :id=\"`collapse-pedido-${p.Pedido}`\" v-model=\"p.collapsed\">\r\n            <b-list-group>\r\n              <b-list-group-item\r\n                v-for=\"n in p.Notas\"\r\n                :key=\"n.Numero_nota\"\r\n                @click.stop=\"\"\r\n              >\r\n                <div class=\"d-flex w-100 justify-content-between\">\r\n                  <div class=\"mb-3\">\r\n                    Nota:\r\n                    <span class=\"font-weight-bold mb-3\" v-copy @click.stop=\"\">{{\r\n                      n.Numero_nota\r\n                    }}</span>\r\n                  </div>\r\n                  <div style=\"min-width: 80px\">\r\n                    <b-progress\r\n                      :value=\"n.PercColeta\"\r\n                      :label=\"`${n.PercColeta}%`\"\r\n                      :max=\"100\"\r\n                      :variant=\"classperc(n.PercColeta)\"\r\n                      show-progress\r\n                    ></b-progress>\r\n                  </div>\r\n                </div>\r\n                <div class=\"d-flex w-100 justify-content-between\">\r\n                  <div style=\"font-weight: italic; font-size: 14px\">\r\n                    <span class=\"text-nowrap\"\r\n                      >Volumes: <b>{{ n.TVolumes }}</b></span\r\n                    >\r\n                    |\r\n                    <span class=\"text-nowrap\"\r\n                      >Última Coleta:\r\n                      <b\r\n                        >{{ n.UltimaColeta | dateBR }}\r\n                        {{ n.UltimaColeta | time }}</b\r\n                      ></span\r\n                    >\r\n                  </div>\r\n                  <!-- <span class=\"font-weight-bold\">{{r.motorista}} [ {{r.placa}} ]</span> -->\r\n                </div>\r\n              </b-list-group-item>\r\n            </b-list-group>\r\n          </b-collapse>\r\n        </b-list-group-item>\r\n      </b-list-group>\r\n    </b-modal>\r\n\r\n    <b-modal\r\n      id=\"modal-1\"\r\n      hide-header-close\r\n      centered\r\n      title=\"Qual o Tipo do Caminhão?\"\r\n    >\r\n      <b-row>\r\n        <b-col cols=\"12\" sm=\"4\" class=\"buttons-modal-chamainspesao\">\r\n          <b-button\r\n            id=\"1\"\r\n            class=\"Layoutcaminhaobutton\"\r\n            @click=\"chamatelasiderbau()\"\r\n          >\r\n            <img\r\n              src=\"@/assets/siderebau.png\"\r\n              class=\"layout-icon-button-caminhao\"\r\n              alt=\"Ícone Sider e Baú\"\r\n            />\r\n            <p class=\"text-button\">Sider e Baú</p>\r\n          </b-button>\r\n        </b-col>\r\n        <b-col cols=\"12\" sm=\"4\" class=\"buttons-modal-chamainspesao\">\r\n          <b-button\r\n            class=\"Layoutcaminhaobutton\"\r\n            id=\"2\"\r\n            @click=\"chamatelatruck()\"\r\n          >\r\n            <img\r\n              src=\"@/assets/caminhaotruck.png\"\r\n              class=\"layout-icon-button-caminhao\"\r\n              alt=\"Ícone Sider e Baú\"\r\n            />\r\n            <p class=\"text-button\">Truck</p></b-button\r\n          >\r\n        </b-col>\r\n        <b-col cols=\"12\" sm=\"4\" class=\"buttons-modal-chamainspesao\">\r\n          <b-button\r\n            class=\"Layoutcaminhaobutton\"\r\n            id=\"3\"\r\n            @click=\"chamatelacontainer()\"\r\n          >\r\n            <img\r\n              src=\"@/assets/caminhaocontainer.png\"\r\n              class=\"layout-icon-button-caminhao\"\r\n              alt=\"Ícone Sider e Baú\"\r\n            />\r\n            <p class=\"text-button\">Container</p></b-button\r\n          >\r\n        </b-col>\r\n      </b-row>\r\n    </b-modal>\r\n\r\n    <b-modal\r\n      id=\"modal-Foto\"\r\n      hide-header-close\r\n      centered\r\n      ok-only\r\n      ok-title=\"Fechar\"\r\n      ok-variant=\"secondary\"\r\n      title=\"Foto da Carga\"\r\n      @hidden=\"onModalHidden\"\r\n    >\r\n      <b-row>\r\n        <CameraCapture\r\n          :idcarregamentoinspecao=\"idcarregamentoinspecao\"\r\n          :key=\"cameraKey\"\r\n        />\r\n      </b-row>\r\n    </b-modal>\r\n\r\n    <b-modal\r\n      id=\"modal-Foto-True\"\r\n      hide-header-close\r\n      centered\r\n      ok-only\r\n      ok-title=\"Fechar\"\r\n      ok-variant=\"secondary\"\r\n      title=\"Foto da Carga\"\r\n      size=\"xl\"\r\n    >\r\n      <b-container fluid class=\"p-4 container-fluid-color\">\r\n        <b-row class=\"thumbnail-container\">\r\n          <div v-for=\"(f, i) of Files\" :key=\"i\">\r\n            <b-img\r\n              class=\"thumbnail-fluid-files\"\r\n              thumbnail\r\n              fluid\r\n              :src=\"f.Files\"\r\n            ></b-img>\r\n          </div>\r\n        </b-row>\r\n      </b-container>\r\n    </b-modal>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport API from \"../../../services/api.service\";\r\nimport Signature from \"../../../components/Signature\";\r\nimport Properties from \"../../../components/Properties\";\r\nimport { mapGetters } from \"vuex\";\r\nimport CameraCapture from \"../../../components/CameraCapture\";\r\n\r\nexport default {\r\n  name: \"Carregamento\",\r\n  components: {\r\n    Signature,\r\n    Properties,\r\n    CameraCapture,\r\n  },\r\n\r\n  data() {\r\n    return {\r\n      modalVisivel: false,\r\n      idcarregamentoinspecao: null,\r\n      cameraKey: 0,\r\n      form: {\r\n        idCarregamento: 0,\r\n        entrada: new Date(),\r\n        nometransp: \"\",\r\n        motorista: \"\",\r\n        placa: \"\",\r\n      },\r\n      filtro: \"\",\r\n      filterOn: [\"id\", \"transp\", \"motorista\", \"placa\"],\r\n      filtroassinados: false,\r\n      filtrochecklistassinados: false,\r\n      filtrocoletados: true,\r\n      timer: null,\r\n      updatetimeout: 15000,\r\n      updatestop: false,\r\n      data: [],\r\n      marcas: [],\r\n      sigOpcoes: [],\r\n      tabIndex: 0,\r\n      sigImage: null,\r\n      sigImageConf: null,\r\n      sigImageResponCarga: null,\r\n      sigObsConf: \"\",\r\n      sigChange: false,\r\n      sigChangeConf: false,\r\n      sigChangeResponCarga: false,\r\n      selected: [],\r\n      pedidosselected: null,\r\n      pedidos: [],\r\n      opcoes: [],\r\n\r\n      formcollapsed: false,\r\n      Files: [],\r\n      PedidosRomaneios: [],\r\n    };\r\n  },\r\n  computed: {\r\n    ...mapGetters([\"gtxConfigParemp\", \"gtxConfigGrupoemp\"]),\r\n    hoje() {\r\n      const h = new Date();\r\n      return (\r\n        h.getDay().toString().padStart(2, \"0\") +\r\n        \"/\" +\r\n        h.getMonth().toString().padStart(2, \"0\") +\r\n        \"/\" +\r\n        h.getFullYear().toString().padStart(4, \"0\")\r\n      );\r\n    },\r\n    fields() {\r\n      return [\r\n        // { key: \"transp\", label: \"Transportadora\", sortable: true },\r\n        // { key: \"motorista\", sortable: true },\r\n        // { key: \"placa\", sortable: true },\r\n        // { key: \"perc\", label: \"Coletas\", sortable: true },\r\n        { key: \"carga\", label: \"Carga\" },\r\n        { key: \"actions\", label: \"\", sortable: false },\r\n      ];\r\n    },\r\n    parametros() {\r\n      return {\r\n        idCarregamento: this.form.idCarregamento,\r\n      };\r\n    },\r\n    params() {\r\n      return {\r\n        idCarregamento: this.form.idCarregamento,\r\n        grupoempresa: this.gtxConfigParemp || 8,\r\n        entrada: this.form.entrada,\r\n        nometransp: this.form.nometransp,\r\n        motorista: this.form.motorista,\r\n        placa: this.form.placa,\r\n      };\r\n    },\r\n    // paramsdetails() {\r\n    //   return { idCarregamento: this.form.idCarregamento };\r\n    // },\r\n    marcasselected() {\r\n      return this.marcas.filter((m) => m.checked);\r\n    },\r\n\r\n    romaneios() {\r\n      return this.data\r\n        .map((r) => ({\r\n          id: r.id,\r\n          codTransp: r.Codigo_Transp,\r\n          transp: r.Razao_Social,\r\n          motorista: r.Motorista,\r\n          ultimacoleta: r.UltimaColeta,\r\n          volumes: r.TVolumes,\r\n          coletados: r.TVolumesColetados,\r\n          TPedidos: r.TPedidos,\r\n          perc: r.PercColetados,\r\n          placa: r.Placa,\r\n          sigImage: r.sigImage,\r\n          sigImageConf: r.sigImageConf,\r\n          sigImageResponCarga: r.sigImageResponCarga,\r\n          PercAssinados: r.PercAssinados,\r\n          checklistassinatura: r.checklistassinatura,\r\n          checklistfotos: r.checklistfotos,\r\n          idTiposCaminhao: r.idTiposCaminhao,\r\n          sigObsConf: r.sigObsConf,\r\n          signed:\r\n            (r.sigImage && r.sigImage !== \"\") ||\r\n            (r.sigImageConf && r.sigImageConf !== \"\") ||\r\n            (r.sigImageResponCarga && r.sigImageResponCarga !== \"\")\r\n              ? true\r\n              : false,\r\n          Romaneios: r.Romaneios || [],\r\n          collapsed: r.collapsed,\r\n          checked: r.checked,\r\n          Opcoes: r.Opcoes,\r\n          _rowVariant:\r\n            r.sigImage && r.sigImageConf && r.sigImageResponCarga\r\n              ? \"success\"\r\n              : \"\",\r\n          tURL: r.tURL,\r\n          Valor_Com_IPI: r.Romaneios.reduce((a, b) => a + b.Valor_Com_IPI, 0),\r\n        }))\r\n        .filter((f) => this.romaneiosfiltros(f));\r\n      //.filter(f=>f.signed == this.filtroassinados && (f.perc > 99) == this.filtrocoletados )\r\n    },\r\n    paramsignature() {\r\n      return {\r\n        idCarregamento: this.selected.id,\r\n        sigImage: this.sigImage,\r\n        sigImageConf: this.sigImageConf,\r\n        sigImageResponCarga: this.sigImageResponCarga,\r\n        sigObsConf: this.sigObsConf,\r\n        opcoes: JSON.stringify(this.opcoes),\r\n        romaneios: this.selected.Romaneios.filter((r) => r.checked),\r\n      };\r\n    },\r\n    signatureOptions() {\r\n      return this.sigOpcoes.map((o) => ({\r\n        text: o.descricao,\r\n        value: o.id,\r\n      }));\r\n    },\r\n    selectedchecked() {\r\n      return this.selected.Romaneios\r\n        ? this.selected.Romaneios.filter((c) => c.checked)\r\n        : [];\r\n    },\r\n    selectedcheckedlength() {\r\n      return this.selectedchecked.length || 0;\r\n    },\r\n    signatureFields() {\r\n      return {\r\n        Transportadora: this.selected.transp,\r\n        Motorista: this.selected.motorista,\r\n        Placa: this.selected.placa,\r\n      };\r\n    },\r\n    signatureValid() {\r\n      return (\r\n        (this.sigChange && this.sigImage && this.sigImage !== \"\") ||\r\n        (this.sigChangeConf && this.sigImageConf && this.sigImageConf !== \"\") ||\r\n        (this.sigChangeResponCarga &&\r\n          this.sigImageResponCarga &&\r\n          this.sigImageResponCarga !== \"\")\r\n      );\r\n    },\r\n    signatureTitle() {\r\n      return \"Carga: \" + ((this.selected && this.selected.id) || \"\");\r\n    },\r\n    pedidosTitle() {\r\n      return (\r\n        \"Romaneio: \" +\r\n        ((this.pedidos && this.pedidos[0] && this.pedidos[0].Romaneio) || \"\")\r\n      );\r\n    },\r\n    pedidosNotasSplit() {\r\n      return (\r\n        (this.pedidos &&\r\n          this.pedidos[0] &&\r\n          this.pedidos[0].Notas &&\r\n          this.pedidos[0].Notas.map((n) => n.Numero_nota).join(\",\")) ||\r\n        \"\"\r\n      );\r\n    },\r\n  },\r\n  created() {\r\n    API.getLocalDBDocument(\"carregamento\").then((doc) => {\r\n      if (doc) {\r\n        this.form.idCarregamento = doc.form.idCarregamento || 0;\r\n        // this.form.entrada = doc.entrada || new Date();\r\n        this.form.nometransp = doc.form.nometransp || \"\";\r\n        this.form.motorista = doc.form.motorista || \"\";\r\n        this.form.placa = doc.form.placa || \"\";\r\n        this.updatetimeout = doc.updatetimeout || this.updatetimeout;\r\n        this.filtroassinados = doc.filtroassinados || this.filtroassinados;\r\n        this.marcas = doc.marcas || this.marcas;\r\n        this.filtro = doc.filtro || this.filtro;\r\n        if (this.marcas.length == 0) {\r\n          this.getMarcas();\r\n        }\r\n      } else {\r\n        if (this.marcas.length == 0) {\r\n          this.getMarcas();\r\n        }\r\n      }\r\n    });\r\n  },\r\n  beforeMount() {\r\n    this.getCarregamentoOpcoes();\r\n\r\n    this.getCarregamento();\r\n\r\n    // seta o timer que atualiza os totais ...\r\n    this.updatestop = false;\r\n    this.timer = setInterval(() => {\r\n      if (!this.updatestop) this.getCarregamentoTotais();\r\n    }, this.updatetimeout);\r\n  },\r\n  methods: {\r\n    onModalHidden() {\r\n      this.getCarregamento();\r\n    },\r\n    refreshCamera() {\r\n      // Atualiza a chave da câmera para forçar a atualização do componente CameraCapture\r\n      this.cameraKey += 1;\r\n    },\r\n\r\n    teste(val) {\r\n      console.log(\"teste:\", val);\r\n      val.collapsed = !val.collapsed;\r\n    },\r\n\r\n    ChamaModal(id) {\r\n      this.idcarregamentoinspecao = id;\r\n      this.$bvModal.show(\"modal-1\");\r\n    },\r\n\r\n    ChamarModalFoto(id) {\r\n      this.idcarregamentoinspecao = id;\r\n      this.$bvModal.show(\"modal-Foto\");\r\n    },\r\n\r\n    ChamarModalFotoTrue(id) {\r\n      this.idcarregamentoinspecao = id;\r\n      this.$bvModal.show(\"modal-Foto-True\");\r\n      this.InspecaoCarregamentoFotosGet(id);\r\n    },\r\n\r\n    ChamaDiretoTela(tURL) {\r\n      // this.$router.push({\r\n      //   name: \"inspecaosiderebau\",\r\n      //   params: { GUID: GUID },\r\n      // });\r\n      this.$router.push(tURL);\r\n    },\r\n\r\n    chamatelasiderbau() {\r\n      this.$router.push({\r\n        name: \"inspecaosiderebau\",\r\n        params: { id: this.idcarregamentoinspecao },\r\n      });\r\n    },\r\n\r\n    chamatelasiderbau() {\r\n      this.$router.push({\r\n        name: \"inspecaosiderebau\",\r\n        params: { id: this.idcarregamentoinspecao },\r\n      });\r\n    },\r\n    chamatelatruck() {\r\n      this.$router.push({\r\n        name: \"inspecaotruck\",\r\n        params: { id: this.idcarregamentoinspecao },\r\n      });\r\n    },\r\n    chamatelacontainer() {\r\n      this.$router.push({\r\n        name: \"inspecaocontainer\",\r\n        params: { id: this.idcarregamentoinspecao },\r\n      });\r\n    },\r\n    romaneiosfiltros(item) {\r\n      // console.log('romaneiosfiltros(item)', item);\r\n      let ret = false;\r\n      const marcas =\r\n        this.marcas.filter((m) => m.checked).map((m) => m.id) || [];\r\n      //const marcas = []\r\n\r\n      // ret = ((item.signed == this.filtroassinados) && ((item.perc > 99) == this.filtrocoletados));\r\n      ret =\r\n        (item.PercAssinados == 100) == this.filtroassinados &&\r\n        (item.checklistassinatura == 1) == this.filtrochecklistassinados;\r\n\r\n      if (marcas.length > 0) {\r\n        ret =\r\n          ret &&\r\n          item.Romaneios.filter((r) =>\r\n            r.Marcas.find((m) => marcas.includes(m.id))\r\n          ).length > 0;\r\n      }\r\n\r\n      if (this.filtro !== \"\") {\r\n        ret =\r\n          ret &&\r\n          (item.id.toString().includes(this.filtro) ||\r\n            item.transp.includes(this.filtro.toUpperCase()) ||\r\n            item.motorista.includes(this.filtro.toUpperCase()) ||\r\n            item.placa.includes(this.filtro.toUpperCase()));\r\n      }\r\n\r\n      return ret;\r\n    },\r\n    marcar(check) {\r\n      if (this.data.find((d) => d.id == this.selected.id)) {\r\n        this.data\r\n          .find((d) => d.id == this.selected.id)\r\n          .Romaneios.map((r) => {\r\n            r.checked = check;\r\n          });\r\n      }\r\n    },\r\n    modalpedidos(pedidos) {\r\n      this.pedidos = pedidos;\r\n      this.$bvModal.show(\"modal-pedidos\");\r\n    },\r\n    getMarcas() {\r\n      // console.log('getMarcas', this.marcas);\r\n      API.get(\"v2/Servicos/Marcas/Get\", { pesquisa: \"%\", PageSize: 30 }).then(\r\n        (apidata) => {\r\n          if (apidata.data.Success == \"True\" || apidata.data.Success) {\r\n            const res = API.prepareData(apidata.data);\r\n            // console.log(res);\r\n            this.marcas = res.data;\r\n          } else {\r\n            this.marcas = [];\r\n          }\r\n        }\r\n      );\r\n    },\r\n    getCarregamentoOpcoes() {\r\n      API.get(\"v2/Servicos/Carregamento/OpcoesGet\", {}).then((apidata) => {\r\n        if (apidata.data.Success == \"True\" || apidata.data.Success) {\r\n          const res = API.prepareData(apidata.data);\r\n          this.sigOpcoes = res.apiresponse.Data;\r\n        } else {\r\n          this.sigOpcoes = [];\r\n        }\r\n      });\r\n    },\r\n    getCarregamento() {\r\n      this.updatestop = true;\r\n      API.get(\"v2/Servicos/Carregamento/Get\", this.params).then((apidata) => {\r\n        if (apidata.data.Success == \"True\" || apidata.data.Success) {\r\n          const res = API.prepareData(apidata.data);\r\n          this.data = res.apiresponse.Data;\r\n          this.formcollapsed = false;\r\n          API.setLocalDBDocument(this.$data, \"carregamento\");\r\n        } else {\r\n          this.data = [];\r\n          this.formcollapsed = true;\r\n        }\r\n      });\r\n    },\r\n    getCarregamentoRomaneioDetail(idCarregamento) {\r\n      API.get(\"v2/Servicos/CarregamentoRomaneiosDetails/Get\", {\r\n        params: { idCarregamento: idCarregamento },\r\n      }).then((api) => {\r\n        if (api.data.Success == \"True\" || api.data.Success) {\r\n          this.PedidosRomaneios = api.data.Data;\r\n          this.formcollapsed = false;\r\n        } else {\r\n          this.PedidosRomaneios = [];\r\n          this.formcollapsed = true;\r\n        }\r\n      });\r\n    },\r\n\r\n    InspecaoCarregamentoFotosGet(id) {\r\n      API.get(\"v2/Servicos/CarregamentoFotos/Get\", {\r\n        params: { idCarregamento: id },\r\n      }).then((api) => {\r\n        if (api.data.Success == \"True\" || api.data.Success) {\r\n          this.Files = api.data.Data;\r\n        } else {\r\n          this.Files = [];\r\n        }\r\n      });\r\n    },\r\n    getCarregamentoTotais() {\r\n      API.get(\"v2/Servicos/CarregamentoTotais/Get\", this.params, false).then(\r\n        (apidata) => {\r\n          if (apidata.data.Success == \"True\" || apidata.data.Success) {\r\n            const res = API.prepareData(apidata.data);\r\n\r\n            //console.log('getCarregamentoTotais:hit');\r\n\r\n            res.apiresponse.Data.map((t) => {\r\n              if (this.data.find((c) => c.id == t.id)) {\r\n                this.data.find((c) => c.id == t.id).TVolumesColetados =\r\n                  t.TVolumesColetados;\r\n                this.data.find((c) => c.id == t.id).PercColetados =\r\n                  t.PercColetados;\r\n                this.data.find((c) => c.id == t.id).sigImage = t.sigImage;\r\n                this.data.find((c) => c.id == t.id).sigImageConf =\r\n                  t.sigImageConf;\r\n                this.data.find((c) => c.id == t.id).sigImageResponCarga =\r\n                  t.sigImageResponCarga;\r\n                this.data.find((c) => c.id == t.id).sigObsConf = t.sigObsConf;\r\n                this.data.find((c) => c.id == t.id).Opcoes = t.Opcoes;\r\n                this.data.find((c) => c.id == t.id).UltimaColeta =\r\n                  t.UltimaColeta;\r\n              }\r\n            });\r\n          }\r\n        }\r\n      );\r\n    },\r\n    async assinar(item) {\r\n      console.log(\"assinar.item:\", item);\r\n      let perc = item.perc;\r\n\r\n      // sugerido não poder liberar sem estar 100% coletado\r\n      /*\r\n      if (perc < 100) {\r\n        this.$root.toastdanger(\"A carga não está 100% coletada, não é possível solicitar a assinatura !\");\r\n      }\r\n      */\r\n      if (perc < 100) {\r\n        await this.$root\r\n          .showmessage(\r\n            \"A carga não está 100% coletada, deseja realmente solicitar a assinatura ?\"\r\n          )\r\n          .then((choice) => {\r\n            if (choice) {\r\n              perc = 100;\r\n            }\r\n          });\r\n      }\r\n\r\n      if (perc > 99.9) {\r\n        // this.selected = item;\r\n        this.doselected(item);\r\n\r\n        const params = {\r\n          idCarregamento: item.id,\r\n          Romaneios: this.selectedchecked.map((r) => r.Romaneio).join(\",\"),\r\n        };\r\n        console.log(\"assinar.params:\", params);\r\n\r\n        // busca a assinatuda da API ...\r\n        API.get(\"v2/Servicos/CarregamentoSignature/Get\", params, false).then(\r\n          (apidata) => {\r\n            const res = API.prepareData(apidata.data);\r\n            console.log(\"res:\", res);\r\n            if (res.success && res.data.length > 0) {\r\n              const data = res.data[0];\r\n              this.sigImage = data.sigImage || \"\";\r\n              this.sigImageConf = data.sigImageConf || \"\";\r\n              this.sigImageResponCarga = data.sigImageResponCarga || \"\";\r\n              this.sigObsConf = data.sigObsConf || \"\";\r\n              this.opcoes = JSON.parse(data.Opcoes || \"[]\");\r\n            } else {\r\n              this.sigImage = \"\";\r\n              this.sigImageConf = \"\";\r\n              this.sigImageResponCarga = \"\";\r\n              this.sigObsConf = \"\";\r\n              this.opcoes = [];\r\n            }\r\n            this.sigChange = false;\r\n            this.sigChangeConf = false;\r\n            this.sigChangeResponCarga = false;\r\n\r\n            this.$bvModal.show(\"modal-assinar\");\r\n          }\r\n        );\r\n        /*\r\n        // console.log(\"assinar.opcoes:\", item.Opcoes);\r\n        if (item.Romaneios.find(r=>r.checked)) {\r\n          this.sigImage = item.Romaneios.find(r=>r.checked).sigImage;\r\n          this.sigImageConf = item.Romaneios.find(r=>r.checked).sigImageConf;\r\n          this.sigObsConf = item.Romaneios.find(r=>r.checked).sigObsConf;\r\n          this.opcoes = JSON.parse(item.Romaneios.find(r=>r.checked).Opcoes || \"[]\");\r\n        } else {\r\n          this.sigImage = item.sigImage;\r\n          this.sigImageConf = item.sigImageConf;\r\n          this.sigObsConf = item.sigObsConf;\r\n          this.opcoes = JSON.parse(item.Opcoes || \"[]\");\r\n        }\r\n        this.sigChange = false;\r\n        this.sigChangeConf = false;\r\n        // console.log(\"assinar.item:\", item);\r\n        this.$bvModal.show(\"modal-assinar\");\r\n        */\r\n      }\r\n    },\r\n    assinarromaneio(carga, romaneio) {\r\n      if (this.data.find((d) => d.id == carga.id)) {\r\n        // desmarca os outros ...\r\n        this.data\r\n          .find((d) => d.id == carga.id)\r\n          .Romaneios.filter((r) => r.checked)\r\n          .map((m) => (m.checked = false));\r\n        if (\r\n          this.data\r\n            .find((d) => d.id == carga.id)\r\n            .Romaneios.find((r) => r.Romaneio == romaneio)\r\n        ) {\r\n          this.data\r\n            .find((d) => d.id == carga.id)\r\n            .Romaneios.find((r) => r.Romaneio == romaneio).checked = true;\r\n          this.assinar(carga);\r\n        }\r\n      }\r\n    },\r\n    signatureShown() {\r\n      this.updatestop = true;\r\n    },\r\n    signatureHidden() {\r\n      this.updatestop = false;\r\n    },\r\n    signatureOk() {\r\n      // console.log(\"signatureOk.sigImage:\", this.sigImage);\r\n      API.post(\r\n        \"v2/Servicos/Carregamento/SignatureSet\",\r\n        this.paramsignature\r\n      ).then((apidata) => {\r\n        if (apidata.data.Success == \"True\" || apidata.data.Success) {\r\n          if (this.data.find((c) => c.id == this.selected.id)) {\r\n            this.data.find((c) => c.id == this.selected.id).sigImage =\r\n              this.sigImage;\r\n            this.data.find((c) => c.id == this.selected.id).sigImageConf =\r\n              this.sigImageConf;\r\n            this.data.find(\r\n              (c) => c.id == this.selected.id\r\n            ).sigImageResponCarga = this.sigImageResponCarga;\r\n            this.data.find((c) => c.id == this.selected.id).sigObsConf =\r\n              this.sigObsConf;\r\n            this.data.find((c) => c.id == this.selected.id).Opcoes =\r\n              JSON.stringify(this.opcoes);\r\n            this.data\r\n              .find((c) => c.id == this.selected.id)\r\n              .Romaneios.filter((r) => r.checked)\r\n              .map((d) => {\r\n                d.sigImage = this.sigImage;\r\n                d.sigImageConf = this.sigImageConf;\r\n                d.sigImageResponCarga = this.sigImageResponCarga;\r\n                d.sigObsConf = this.sigObsConf;\r\n                d.Opcoes = JSON.stringify(this.opcoes);\r\n                d.checked = false;\r\n              });\r\n          }\r\n          const res = API.prepareData(apidata.data);\r\n\r\n          this.$root.toastsuccess(res.data[0].Mensagem);\r\n          this.updatestop = false;\r\n\r\n          if (\r\n            !this.sigImage ||\r\n            this.sigImage == \"\" ||\r\n            !this.sigImageConf ||\r\n            this.sigImageConf == \"\"\r\n            // !this.sigImageResponCarga ||\r\n            // this.sigImageResponCarga == \"\"\r\n          ) {\r\n            if (!this.sigImage || this.sigImage == \"\")\r\n              this.$root.toastdanger(\"Assinatura do motorista não informada!\");\r\n            if (!this.sigImageConf || this.sigImageConf == \"\")\r\n              this.$root.toastdanger(\"Assinatura do conferente não informada!\");\r\n            // if (!this.sigImageResponCarga || this.sigImageResponCarga == \"\")\r\n            //   this.$root.toastdanger(\r\n            //     \"Assinatura do responsável da carga não informada!\"\r\n            //   );\r\n          }\r\n        } else {\r\n          this.$root.toastdanger(apidata.Error);\r\n          this.formcollapsed = false;\r\n        }\r\n      });\r\n    },\r\n    doselected(item) {\r\n      this.selected = item;\r\n    },\r\n    classperc(perc) {\r\n      return perc > 99 ? \"success\" : \"primary\";\r\n    },\r\n    classselected(item) {\r\n      return item.id == this.selected.id ? \"primary\" : \"\";\r\n    },\r\n    classpedidos(item) {\r\n      return this.pedidosselected && item.Pedido == this.pedidosselected.Pedido\r\n        ? \"primary\"\r\n        : \"\";\r\n    },\r\n  },\r\n  watch: {\r\n    formcollapsed(collapsed) {\r\n      this.updatestop = collapsed;\r\n    },\r\n    updatetimeout() {\r\n      clearInterval(this.timer);\r\n      console.log(\"updatetimeout:\", new Date());\r\n      this.timer = null;\r\n      this.timer = setInterval(() => {\r\n        console.log(\"Carregamento.timer:\", new Date().toLocaleTimeString());\r\n      }, this.runtimeout());\r\n    },\r\n    runtimeout() {\r\n      if (!this.updatestop) this.getCarregamentoTotais();\r\n    },\r\n  },\r\n  beforeDestroy() {\r\n    this.updatestop = true;\r\n    clearInterval(this.timer);\r\n    this.timer = null;\r\n  },\r\n};\r\n</script>\r\n<style>\r\n.colsalign {\r\n  text-align: right;\r\n}\r\n.buttons-modal-chamainspesao {\r\n  text-align: center;\r\n}\r\n.Layoutcaminhaobutton {\r\n  height: 82px;\r\n  width: 126px;\r\n}\r\n.text-button {\r\n  color: black;\r\n  font-weight: bold;\r\n}\r\n\r\n.layout-icon-button-caminhao {\r\n  margin-bottom: -15px;\r\n}\r\n.container-fluid-color {\r\n  background-color: rgb(72, 81, 86);\r\n}\r\n.thumbnail-container {\r\n  margin-left: 20px;\r\n  margin-right: 20px;\r\n\r\n  justify-content: center;\r\n}\r\n.thumbnail-fluid-files {\r\n  margin-left: 6px;\r\n  margin-right: 6px;\r\n  margin-top: 6px;\r\n  margin-bottom: 6px;\r\n  max-width: 272px;\r\n}\r\n@media (max-width: 576px) {\r\n  .container,\r\n  .container-sm {\r\n    max-width: 609px;\r\n  }\r\n}\r\n@media screen and (max-width: 600px) {\r\n  .colsalign {\r\n    text-align: left;\r\n  }\r\n  .lista {\r\n    padding-left: 3px;\r\n    padding-right: 3px;\r\n  }\r\n}\r\n</style>\r\n"]}]}