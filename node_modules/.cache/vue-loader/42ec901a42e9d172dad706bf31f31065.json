{"remainingRequest":"C:\\k1-services\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\k1-services\\src\\pages\\coleta\\views\\index.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\k1-services\\src\\pages\\coleta\\views\\index.vue","mtime":1670977910609},{"path":"C:\\k1-services\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1670977934221},{"path":"C:\\k1-services\\node_modules\\babel-loader\\lib\\index.js","mtime":1670977935138},{"path":"C:\\k1-services\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1670977934221},{"path":"C:\\k1-services\\node_modules\\vue-loader\\lib\\index.js","mtime":1670977935327}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KDQppbXBvcnQgQXBpU2VydmljZSBmcm9tICcuLi8uLi8uLi9zZXJ2aWNlcy9hcGkuc2VydmljZScNCmltcG9ydCBDb2xldGFFQU4gZnJvbSAnLi4vLi4vLi4vY29tcG9uZW50cy9Db2xldGFFQU4nDQppbXBvcnQgeyBzYXZlVG9DU1YgfSBmcm9tICcuLi8uLi8uLi9zZXJ2aWNlcy9jc3YnDQppbXBvcnQgeyBtYXBBY3Rpb25zIH0gZnJvbSAndnVleCcNCg0KZXhwb3J0IGRlZmF1bHQgew0KDQogICAgbmFtZTogJ0NvbGV0YUxpdnJlJywNCg0KICAgIGJlZm9yZU1vdW50KCkgew0KDQogICAgICAgIHRoaXMuY29uc3VsdGFDb2xldGFzKCkNCg0KICAgIH0sDQoNCiAgICBkYXRhKCkgew0KDQogICAgICAgIHJldHVybiB7DQogICAgICAgICAgICBub21lOiB7DQogICAgICAgICAgICAgICAgdmFsdWU6ICcnLA0KICAgICAgICAgICAgICAgIHNob3c6IGZhbHNlLA0KICAgICAgICAgICAgICAgIHR5cGU6ICd0ZXh0JywNCiAgICAgICAgICAgICAgICB0aXRsZTogJ05vbWUgZGEgY2F0ZWdvcmlhJywNCiAgICAgICAgICAgICAgICBwbGFjZWhvbGRlcjogJ0luZm9ybWUgbyBub21lIGRhIGNhdGVnb3JpYScNCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICBjb2xldGFzOiBbXSwNCiAgICAgICAgICAgIGNvbnN1bHRhY29sZXRhczogW10sDQogICAgICAgICAgICBjb2xldGFzeG1sOiAnJywNCiAgICAgICAgICAgIGRlc3Rpbm86IG51bGwsDQogICAgICAgICAgICBkZXN0aW5vczogWw0KICAgICAgICAgICAgICAgIHsgdmFsdWU6IDEsIHRleHQ6ICdDb25mZXLDqm5jaWEgZGUgSW1vYmlsaXphZG9zJyB9LA0KICAgICAgICAgICAgICAgIHsgdmFsdWU6IDIsIHRleHQ6ICdDb25mZXLDqm5jaWEgRXhwZWRpw6fDtWVzJyB9LA0KICAgICAgICAgICAgICAgIHsgdmFsdWU6IG51bGwsIHRleHQ6ICctJywgZGlzYWJsZWQ6IHRydWUgfSwNCiAgICAgICAgICAgICAgICB7IHZhbHVlOiAtMSwgdGV4dDogJ1NhbHZhciBlbSBBcnF1aXZvIENTVicgfSwNCiAgICAgICAgICAgICAgICANCiAgICAgICAgICAgIF0sDQogICAgICAgIH0NCg0KICAgIH0sDQoNCiAgICBjb21wb25lbnRzOiB7DQoNCiAgICAgICAgQ29sZXRhRUFODQogICAgICAgIA0KICAgIH0sDQoNCiAgICBjb21wdXRlZDogew0KDQogICAgICAgIGNvbmZpZygpIHsNCg0KICAgICAgICAgICAgcmV0dXJuIGA8ZGF0YT48aWRDb2xldGFUaXBvPiR7dGhpcy5kZXN0aW5vfTwvaWRDb2xldGFUaXBvPjxOb21lQ2F0ZWdvcmlhPiR7dGhpcy5ub21lLnZhbHVlfTwvTm9tZUNhdGVnb3JpYT48L2RhdGE+YA0KDQogICAgICAgIH0sDQoNCiAgICAgICAgY29sZXRhc05PZW50ZXIoKSB7DQogICAgICAgICAgICByZXR1cm4gdGhpcy5jb2xldGFzLm1hcChjID0+IHtyZXR1cm4ge2VhbjogYy5lYW4ucmVwbGFjZSgnXG4nLCcnKX19KQ0KICAgICAgICB9LA0KDQogICAgICAgIHBhZ2VDb2xldGFzKCkgew0KICAgICAgICAgICAgcmV0dXJuIFsNCiAgICAgICAgICAgICAgICB7IHRpdGxlOiBgQ29sZXRhcyBFbnZpYWRhcyAoICR7dGhpcy5jb25zdWx0YWNvbGV0YXMubGVuZ3RofSApYA0KICAgICAgICAgICAgICAgICwgdGFibGU6IHRydWUNCiAgICAgICAgICAgICAgICAsIGRhdGE6IHRoaXMuY29uc3VsdGFjb2xldGFzDQogICAgICAgICAgICAgICAgLCBmaWVsZHM6IFsNCiAgICAgICAgICAgICAgICAgICAgeyBrZXk6ICdDYXRlZ29yaWEnLCBzb3J0YWJsZTogdHJ1ZSB9LA0KICAgICAgICAgICAgICAgICAgICB7IGtleTogJ0VhbicsIHNvcnRhYmxlOiB0cnVlIH0sDQogICAgICAgICAgICAgICAgICAgIHsga2V5OiAnRGF0YUNvbGV0YScsIHNvcnRhYmxlOiB0cnVlIH0NCiAgICAgICAgICAgICAgICBdfQ0KICAgICAgICAgICAgXQ0KICAgICAgICB9DQoNCiAgICB9LA0KDQogICAgbWV0aG9kczogew0KDQogICAgICAgIC4uLm1hcEFjdGlvbnMoWydhY3RUb2FzdCddKSwNCg0KICAgICAgICBvbkVudmlhQ29sZXRhWE1MKGNvbGV0YXMpIHsNCg0KICAgICAgICAgICAgdGhpcy5jb2xldGFzeG1sID0gY29sZXRhcw0KDQogICAgICAgICAgICB0aGlzLiRidk1vZGFsLnNob3coJ2NvbGV0YWNhdGVnb3JpYScpDQoNCiAgICAgICAgfSwNCg0KICAgICAgICBvbkVudmlhQ29sZXRhKGNvbGV0YXMpIHsNCg0KICAgICAgICAgICAgdGhpcy5jb2xldGFzID0gY29sZXRhcw0KDQogICAgICAgICAgICB0aGlzLiRidk1vZGFsLnNob3coJ2NvbGV0YWNhdGVnb3JpYScpDQoNCiAgICAgICAgfSwNCg0KICAgICAgICBlbnZpYUNvbGV0YXMoKSB7DQoNCiAgICAgICAgICAgIGNvbnN0IHBhcmFtcyA9IHsgY29uZmlnOiB0aGlzLmNvbmZpZywgZGF0YTogdGhpcy5jb2xldGFzeG1sIH0NCg0KICAgICAgICAgICAgLy8gc2FsdmEgZW0gYXJxdWl2byB0ZXh0byAuLi4NCiAgICAgICAgICAgIGlmICh0aGlzLmRlc3Rpbm8gPT0gLTEpIHsNCiAgICAgICAgICAgICAgICAvLyBjb25zb2xlLmxvZygnZW52aWFDb2xldGFzOicsIHRoaXMuY29sZXRhcykNCiAgICAgICAgICAgICAgICBzYXZlVG9DU1YoIHRoaXMuY29sZXRhc05PZW50ZXIsICBgJHt0aGlzLm5vbWUudmFsdWV9LmNzdmAgKQ0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICBpZiAodGhpcy5kZXN0aW5vID4gMCkgew0KICAgICAgICAgICAgICAgIEFwaVNlcnZpY2Uuc2V0QXV0aEhlYWRlcigpDQogICAgICAgICAgICAgICAgQXBpU2VydmljZS5wb3N0KCdTZXJ2aWNvcy9Db2xldGFzL0luc2VydCcsIHBhcmFtcykNCiAgICAgICAgICAgICAgICAgICAgLnRoZW4oKHJlcykgPT4gew0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5jb2xldGFzID0gW10NCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuY29sZXRhc3htbCA9ICcnDQogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmNvbnN1bHRhQ29sZXRhcygpDQogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmFjdFRvYXN0KHsgbWVzc2FnZTogJ1JlZ2lzdHJvIHNhbHZvIGNvbSBzdWNlc3NvICEnLCB2YXJpYW50OiAnc3VjY2Vzcyd9KQ0KICAgICAgICAgICAgICAgICAgICB9KQ0KICAgICAgICAgICAgICAgICAgICAuY2F0Y2goZSA9PiB7DQogICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnRXJybzogJywgZSkNCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuYWN0VG9hc3QoeyBtZXNzYWdlOiAnRXJybyBhbyBpbmNsdWlyIG8gcmVnaXN0cm8gIScsIHZhcmlhbnQ6ICdkYW5nZXInfSkNCiAgICAgICAgICAgICAgICAgICAgfSkNCiAgICAgICAgICAgIH0NCg0KICAgICAgICB9LA0KDQogICAgICAgIGNvbnN1bHRhQ29sZXRhcygpIHsNCg0KICAgICAgICAgICAgQXBpU2VydmljZS5zZXRBdXRoSGVhZGVyKCkNCiAgICAgICAgICAgIEFwaVNlcnZpY2UucG9zdCgnU2Vydmljb3MvQ29sZXRhcy9TZWxlY3QnLCB7fSkNCiAgICAgICAgICAgICAgICAudGhlbigocmVzKSA9PiB7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuY29uc3VsdGFjb2xldGFzID0gW10NCiAgICAgICAgICAgICAgICAgICAgaWYgKChyZXMuc3RhdHVzID09ICcyMDAnKSAmJiAocmVzLmRhdGEuU3VjY2VzcyA9PSAnVHJ1ZScpKQ0KICAgICAgICAgICAgICAgICAgICAgIHRoaXMuY29uc3VsdGFjb2xldGFzID0gcmVzLmRhdGEuRGF0YQ0KICAgICAgICAgICAgICAgIH0pDQogICAgICAgICAgICAgICAgLmNhdGNoKGUgPT4gew0KICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnRXJybzogJywgZSkNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5hY3RUb2FzdCh7IG1lc3NhZ2U6ICdFcnJvIGFvIGNvbnN1bHRhciBjb2xldGFzICEnLCB2YXJpYW50OiAnZGFuZ2VyJ30pDQogICAgICAgICAgICAgICAgfSkNCg0KICAgICAgICB9DQoNCiAgICB9DQogICAgDQp9DQo="},{"version":3,"sources":["index.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA+DA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA","file":"index.vue","sourceRoot":"src/pages/coleta/views","sourcesContent":["<template>\r\n    <div>\r\n\r\n        <b-card class=\"m-2\" bg-variant=\"dark\" text-variant=\"warning\">\r\n            <b-form-group \r\n                id=\"input-group-destino\"\r\n                label=\"Destino\"\r\n                label-for=\"input-destino\">\r\n                <b-form-select\r\n                    autofocus\r\n                    id=\"input-destino\"\r\n                    v-model=\"destino\"\r\n                    :options=\"destinos\">\r\n                </b-form-select>\r\n            </b-form-group>             \r\n        </b-card>\r\n\r\n        <ColetaEAN\r\n            :disableenvio=\"(destino || 0) == 0\"\r\n            :eanfields=\"[{key: 'ean', label: 'Ean'}, {key: 'actions', label: 'Ações'}]\"\r\n            :histfields=\"[{key: 'ean', label: 'Ean'}, {key: 'actions', label: 'Ações'}]\"\r\n            :customPages=\"pageColetas\"\r\n            @evt-coletas-xml=\"onEnviaColetaXML\"\r\n            @evt-coletas=\"onEnviaColeta\"\r\n        />\r\n\r\n<!--         coletasxml: {{coletasxml}}<br>\r\n        destino: {{(destino || 0) == 0}}<br>\r\n        config: {{config}} -->\r\n\r\n        <b-modal\r\n            id=\"modal-enviar\"\r\n            title=\"Escolha o destino da coleta\"\r\n            ok-only\r\n            :ok-disabled=\"!destino\"\r\n            @ok=\"enviaColetas\">\r\n\r\n            <b-form-group \r\n                id=\"input-group-destino\"\r\n                label=\"Destino\"\r\n                label-for=\"input-destino\">\r\n                <b-form-select\r\n                    id=\"input-destino\"\r\n                    v-model=\"destino\"\r\n                    :options=\"destinos\">\r\n                </b-form-select>\r\n            </b-form-group> \r\n\r\n        </b-modal>\r\n\r\n        <Inputmodal\r\n            idmodal=\"coletacategoria\"\r\n            v-model=\"nome.value\"\r\n            :type=\"nome.type\"\r\n            :title=\"nome.title\"\r\n            :placeholder=\"nome.placeholder\"\r\n            @inputmodel=\"enviaColetas\"\r\n        />\r\n\r\n    </div>\r\n</template>\r\n\r\n<script>\r\nimport ApiService from '../../../services/api.service'\r\nimport ColetaEAN from '../../../components/ColetaEAN'\r\nimport { saveToCSV } from '../../../services/csv'\r\nimport { mapActions } from 'vuex'\r\n\r\nexport default {\r\n\r\n    name: 'ColetaLivre',\r\n\r\n    beforeMount() {\r\n\r\n        this.consultaColetas()\r\n\r\n    },\r\n\r\n    data() {\r\n\r\n        return {\r\n            nome: {\r\n                value: '',\r\n                show: false,\r\n                type: 'text',\r\n                title: 'Nome da categoria',\r\n                placeholder: 'Informe o nome da categoria'\r\n            },\r\n            coletas: [],\r\n            consultacoletas: [],\r\n            coletasxml: '',\r\n            destino: null,\r\n            destinos: [\r\n                { value: 1, text: 'Conferência de Imobilizados' },\r\n                { value: 2, text: 'Conferência Expedições' },\r\n                { value: null, text: '-', disabled: true },\r\n                { value: -1, text: 'Salvar em Arquivo CSV' },\r\n                \r\n            ],\r\n        }\r\n\r\n    },\r\n\r\n    components: {\r\n\r\n        ColetaEAN\r\n        \r\n    },\r\n\r\n    computed: {\r\n\r\n        config() {\r\n\r\n            return `<data><idColetaTipo>${this.destino}</idColetaTipo><NomeCategoria>${this.nome.value}</NomeCategoria></data>`\r\n\r\n        },\r\n\r\n        coletasNOenter() {\r\n            return this.coletas.map(c => {return {ean: c.ean.replace('\\n','')}})\r\n        },\r\n\r\n        pageColetas() {\r\n            return [\r\n                { title: `Coletas Enviadas ( ${this.consultacoletas.length} )`\r\n                , table: true\r\n                , data: this.consultacoletas\r\n                , fields: [\r\n                    { key: 'Categoria', sortable: true },\r\n                    { key: 'Ean', sortable: true },\r\n                    { key: 'DataColeta', sortable: true }\r\n                ]}\r\n            ]\r\n        }\r\n\r\n    },\r\n\r\n    methods: {\r\n\r\n        ...mapActions(['actToast']),\r\n\r\n        onEnviaColetaXML(coletas) {\r\n\r\n            this.coletasxml = coletas\r\n\r\n            this.$bvModal.show('coletacategoria')\r\n\r\n        },\r\n\r\n        onEnviaColeta(coletas) {\r\n\r\n            this.coletas = coletas\r\n\r\n            this.$bvModal.show('coletacategoria')\r\n\r\n        },\r\n\r\n        enviaColetas() {\r\n\r\n            const params = { config: this.config, data: this.coletasxml }\r\n\r\n            // salva em arquivo texto ...\r\n            if (this.destino == -1) {\r\n                // console.log('enviaColetas:', this.coletas)\r\n                saveToCSV( this.coletasNOenter,  `${this.nome.value}.csv` )\r\n            }\r\n\r\n            if (this.destino > 0) {\r\n                ApiService.setAuthHeader()\r\n                ApiService.post('Servicos/Coletas/Insert', params)\r\n                    .then((res) => {\r\n                        this.coletas = []\r\n                        this.coletasxml = ''\r\n                        this.consultaColetas()\r\n                        this.actToast({ message: 'Registro salvo com sucesso !', variant: 'success'})\r\n                    })\r\n                    .catch(e => {\r\n                        console.log('Erro: ', e)\r\n                        this.actToast({ message: 'Erro ao incluir o registro !', variant: 'danger'})\r\n                    })\r\n            }\r\n\r\n        },\r\n\r\n        consultaColetas() {\r\n\r\n            ApiService.setAuthHeader()\r\n            ApiService.post('Servicos/Coletas/Select', {})\r\n                .then((res) => {\r\n                    this.consultacoletas = []\r\n                    if ((res.status == '200') && (res.data.Success == 'True'))\r\n                      this.consultacoletas = res.data.Data\r\n                })\r\n                .catch(e => {\r\n                    console.log('Erro: ', e)\r\n                    this.actToast({ message: 'Erro ao consultar coletas !', variant: 'danger'})\r\n                })\r\n\r\n        }\r\n\r\n    }\r\n    \r\n}\r\n</script>\r\n"]}]}