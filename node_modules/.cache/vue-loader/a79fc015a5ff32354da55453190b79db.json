{"remainingRequest":"C:\\k1-services\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\k1-services\\src\\pages\\ecommerce\\views\\Pedidos.vue?vue&type=style&index=0&lang=css&","dependencies":[{"path":"C:\\k1-services\\src\\pages\\ecommerce\\views\\Pedidos.vue","mtime":1670977910623},{"path":"C:\\k1-services\\node_modules\\css-loader\\dist\\cjs.js","mtime":1670977934642},{"path":"C:\\k1-services\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":1670977935796},{"path":"C:\\k1-services\\node_modules\\postcss-loader\\src\\index.js","mtime":1670977935130},{"path":"C:\\k1-services\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1670977934221},{"path":"C:\\k1-services\\node_modules\\vue-loader\\lib\\index.js","mtime":1670977935327}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoNCiNkaXZQcmluY2lwYWwgew0KICBmb250LXNpemU6IDEycHg7DQp9DQoNCiNjZW50ZXIgew0KICBkaXNwbGF5OiBibG9jazsNCn0NCg0KI3JvdyB7DQogIGp1c3RpZnktY29udGVudDogc3BhY2UtYmV0d2VlbjsNCiAgbWFyZ2luOiAxcHgsIDFweCwgMXB4LCAxcHg7DQp9DQoNCiNsaW5rVGFiZWxhIHsNCiAgY29sb3I6IGJsdWU7DQp9DQoNCiNib3RvZXMgew0KICB3aWR0aDogbWluLWNvbnRlbnQ7DQogIHdoaXRlLXNwYWNlOiBub3dyYXA7DQogIG1hcmdpbjogMnB4Ow0KfQ0KDQojaW5wdXREYXRlIHsNCiAgd2lkdGg6IDM1MHB4Ow0KfQ0KDQojcGFnaW5hdGlvbiB7DQogIGRpc3BsYXk6IGZsZXg7DQogIGp1c3RpZnktY29udGVudDogZmxleC1lbmQ7DQp9DQoNCi5kcmFnLW92ZXIgew0KICBiYWNrZ3JvdW5kLWNvbG9yOiBzaWx2ZXI7DQogIGJvcmRlci1yaWdodDogNXB4IHNvbGlkIGxpZ2h0Z3JlZW47DQogIGJvcmRlci1sZWZ0OiA1cHggc29saWQgbGlnaHRncmVlbjsNCn0NCg=="},{"version":3,"sources":["Pedidos.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA+iCA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA","file":"Pedidos.vue","sourceRoot":"src/pages/ecommerce/views","sourcesContent":["<template>\r\n  <div id=\"divPrincipal\" class=\"text-center\">\r\n    <b-card class=\"m-2\">\r\n      <b-row id=\"row\" class=\"m-2\">\r\n        <div class=\"d-flex\">\r\n          <b-button>\r\n            <strong>{{ pedidosTotaisCount }}</strong>\r\n          </b-button>\r\n\r\n          <b-button\r\n            class=\"ml-1\"\r\n            :variant=\"somenteAtrasados ? 'danger' : ''\"\r\n            @click=\"atrasados\"\r\n          >\r\n            Somente em atraso\r\n          </b-button>\r\n\r\n          <div class=\"ml-2\">\r\n            <b-input-group prepend=\"Filtro\" size=\"sm\">\r\n              <b-form-input\r\n                id=\"input-filtro\"\r\n                type=\"search\"\r\n                v-model=\"filtro\"\r\n                :debounce=\"1000\"\r\n              ></b-form-input>\r\n            </b-input-group>\r\n          </div>\r\n        </div>\r\n\r\n        <div>\r\n          <b-row>\r\n            <b-col>\r\n              <b-input-group style=\"width: 250px\">\r\n                <b-form-datepicker\r\n                  size=\"sm\"\r\n                  v-model=\"dataInicial\"\r\n                  placeholder=\"Data Inicial\"\r\n                  locale=\"pt-br\"\r\n                  :date-format-options=\"{\r\n                    year: 'numeric',\r\n                    month: 'numeric',\r\n                    day: 'numeric',\r\n                  }\"\r\n                ></b-form-datepicker>\r\n\r\n                <b-input-group-append>\r\n                  <b-button variant=\"danger\" @click=\"clearInicialDate\">\r\n                    <b-icon-trash></b-icon-trash>\r\n                  </b-button>\r\n                </b-input-group-append>\r\n              </b-input-group>\r\n            </b-col>\r\n\r\n            <b-col>\r\n              <b-input-group style=\"width: 250px\">\r\n                <b-form-datepicker\r\n                  size=\"sm\"\r\n                  v-model=\"dataFinal\"\r\n                  placeholder=\"Data Final\"\r\n                  locale=\"pt-br\"\r\n                  :date-format-options=\"{\r\n                    year: 'numeric',\r\n                    month: 'numeric',\r\n                    day: 'numeric',\r\n                  }\"\r\n                ></b-form-datepicker>\r\n\r\n                <b-input-group-append>\r\n                  <b-button variant=\"danger\" @click=\"clearFinalDate\">\r\n                    <b-icon-trash></b-icon-trash>\r\n                  </b-button>\r\n                </b-input-group-append>\r\n              </b-input-group>\r\n            </b-col>\r\n\r\n            <b-dropdown class=\"mr-2\" right size=\"sm\" text=\"Marketplaces\">\r\n              <b-form-checkbox\r\n                style=\"width: 200px\"\r\n                class=\"mb-1 ml-1\"\r\n                v-for=\"market in marketPlacesList\"\r\n                :key=\"market.value\"\r\n                size=\"sm\"\r\n                :value=\"market.value\"\r\n                v-model=\"marketPlacesListSelected\"\r\n                name=\"check-button\"\r\n                switch\r\n                >{{ market.text }}</b-form-checkbox\r\n              >\r\n            </b-dropdown>\r\n\r\n            <b-dropdown class=\"mr-2\" right text=\"Status\" size=\"sm\">\r\n              <b-form-checkbox\r\n                style=\"width: 300px\"\r\n                class=\"mb-1 ml-1\"\r\n                v-for=\"status in statusList\"\r\n                :key=\"status.value\"\r\n                size=\"sm\"\r\n                :value=\"status.value\"\r\n                v-model=\"statusListSelected\"\r\n                name=\"check-button2\"\r\n                switch\r\n                >{{ status.text }}</b-form-checkbox\r\n              >\r\n            </b-dropdown>\r\n\r\n            <b-dropdown class=\"mr-2\" right size=\"sm\" text=\"Colunas Visiveis\">\r\n              <b-form-checkbox\r\n                style=\"width: 200px\"\r\n                class=\"mb-1 ml-1\"\r\n                v-for=\"market in fields\"\r\n                :key=\"market.key\"\r\n                size=\"sm\"\r\n                v-model=\"market.visible\"\r\n                name=\"check-button\"\r\n                switch\r\n              >\r\n                {{ market.label || market.key }}\r\n              </b-form-checkbox>\r\n            </b-dropdown>\r\n\r\n            <b-dropdown class=\"mr-2\" right size=\"sm\" text=\"Empresa\">\r\n              <b-form-checkbox\r\n                style=\"width: 300px\"\r\n                class=\"mb-1 ml-1\"\r\n                v-for=\"emp in empresa\"\r\n                :key=\"emp.Empresa\"\r\n                size=\"sm\"\r\n                v-model=\"filtroEmpresas\"\r\n                name=\"check-button\"\r\n                :value=\"emp.Empresa\"\r\n                switch\r\n                >{{ emp.NomeEmpresa }}</b-form-checkbox\r\n              >\r\n            </b-dropdown>\r\n\r\n            <b-dropdown class=\"mr-2\" right size=\"sm\" text=\"Ações\">\r\n              <b-button class=\"m-2\" @click=\"gerarRomaneios\"\r\n                >Gerar romaneios</b-button\r\n              >\r\n            </b-dropdown>\r\n          </b-row>\r\n        </div>\r\n\r\n        <div>\r\n          <b-button variant=\"danger\" class=\"mr-2\" @click=\"btnFiltros\">\r\n            <b-spinner small v-if=\"this.loading\"></b-spinner>\r\n\r\n            <span v-else>Filtrar</span>\r\n          </b-button>\r\n        </div>\r\n      </b-row>\r\n\r\n      <b-table\r\n        foot-clone\r\n        no-footer-sorting\r\n        id=\"my-table\"\r\n        :current-page=\"paginaAtiva\"\r\n        :per-page=\"porPagina\"\r\n        head-variant=\"dark\"\r\n        sort-by=\"DataCompra\"\r\n        sort-desc\r\n        selectable\r\n        striped\r\n        bordered\r\n        hovers\r\n        responsive\r\n        small\r\n        select-mode=\"single\"\r\n        :filter=\"filtro\"\r\n        :filter-included-fields=\"filterOn\"\r\n        :items=\"pedidosListEmpresa\"\r\n        :fields=\"pedidosFields\"\r\n        :tbody-tr-class=\"rowClass\"\r\n        @row-selected=\"onRowSelected\"\r\n        @filtered=\"(filtro) => (pedidosListEmpresa = filtro)\"\r\n      >\r\n        <template #head()=\"data\">\r\n          <div\r\n            :id=\"data.field.key\"\r\n            draggable=\"true\"\r\n            @dragstart=\"dragStart\"\r\n            @dragenter=\"dragEnter\"\r\n            @dragover=\"dragOver\"\r\n            @dragleave=\"dragLeave\"\r\n            @drop=\"drop\"\r\n          >\r\n            {{ data.label }}\r\n          </div>\r\n        </template>\r\n\r\n        <template #cell(actions)=\"row\">\r\n          <a\r\n            target=\"_blank\"\r\n            id=\"linkTabela\"\r\n            v-if=\"row.item.UrlRastreio != null\"\r\n            :href=\"row.item.UrlRastreio\"\r\n          >\r\n            <b-icon-truck font-scale=\"1.5\"></b-icon-truck>\r\n          </a>\r\n          &nbsp; &nbsp;\r\n          <a\r\n            target=\"_blank\"\r\n            id=\"linkTabela\"\r\n            v-if=\"row.item.urlImpressao != null\"\r\n            :href=\"row.item.urlImpressao\"\r\n          >\r\n            <b-icon-printer font-scale=\"1.5\"></b-icon-printer>\r\n          </a>\r\n        </template>\r\n\r\n        <template #cell(Numero)=\"row\">\r\n          <span @click=\"detalhes(row, 'oc')\">\r\n            {{ row.item.Numero }}\r\n            &nbsp; &nbsp; &nbsp;\r\n            {{ row.detailsShowing ? \"-\" : \"+\" }}\r\n          </span>\r\n        </template>\r\n\r\n        <template #cell(Status)=\"row\">\r\n          <span @click=\"detalhes(row, 'status')\">\r\n            {{ row.item.Rastreio[row.item.Rastreio.length - 1][\"Evento\"] }}\r\n            &nbsp; &nbsp; &nbsp;\r\n            {{ row.detailsShowing ? \"-\" : \"+\" }}\r\n          </span>\r\n        </template>\r\n        <template #cell(DataStatus)=\"row\">{{\r\n          row.item.Rastreio[row.item.Rastreio.length - 1][\"DataEvento\"]\r\n            | dateBRHora\r\n        }}</template>\r\n\r\n        <template #cell(Percentual)=\"row\">{{ row.item.Percentual }}%</template>\r\n\r\n        <template #cell(DataPrevisaoEntrega)=\"row\">{{\r\n          row.item.DataPrevisaoEntrega | dateBR\r\n        }}</template>\r\n\r\n        <template #cell(PedidoHubURL)=\"row\">\r\n          <a target=\"_blank\" :href=\"row.item.PedidoHubURL\" id=\"linkTabela\">{{\r\n            row.item.OrdemCompra\r\n          }}</a>\r\n        </template>\r\n\r\n        <template #cell(DataCompra)=\"row\">{{\r\n          new Date(row.item.DataCompra).toLocaleDateString()\r\n        }}</template>\r\n\r\n        <template #cell(ValorComFrete)=\"row\">{{\r\n          row.item.ValorComFrete | R$\r\n        }}</template>\r\n\r\n        <template #cell(ValorFrete)=\"row\">\r\n          <span>{{ row.item.ValorFrete | R$ }}</span>\r\n        </template>\r\n\r\n        <template #cell(ValorFreteDestacado)=\"row\">\r\n          <span style=\"color:red\">{{ row.item.ValorFreteDestacado | R$ }}</span>\r\n        </template>\r\n\r\n        <template #cell(Transportadora)=\"row\">{{\r\n          row.item.Transportadora.substr(0, 15)\r\n        }}</template>\r\n\r\n        <template #cell(Redespacho)=\"row\">{{\r\n          row.item.Redespacho != null ? row.item.Redespacho.substr(0, 15) : \"\"\r\n        }}</template>\r\n\r\n        <template #cell(DiasAtraso)=\"row\">\r\n          {{\r\n            calculaAtraso(\r\n              row.item.DataPrevisaoEntrega,\r\n              row.item.Eventos.filter(\r\n                (e) => e.Status == \"Entregue ao Destinatário\"\r\n              )\r\n                .map((e) => e.Data)\r\n                .toLocaleString()\r\n            )\r\n          }}\r\n        </template>\r\n\r\n        <template #cell(DataRealEntrega)=\"row\">\r\n          <span v-for=\"(item, index) in row.item.Eventos\" :key=\"index\">\r\n            <div v-if=\"item.Status == 'Entregue ao Destinatário'\">\r\n              {{ new Date(item.Data).toLocaleString() }}\r\n            </div>\r\n          </span>\r\n        </template>\r\n\r\n        <template #cell(Observacao)=\"row\">\r\n          <b-icon-pencil\r\n            scale=\"1.5\"\r\n            @click=\"getAcompanhamentoRelacionamentos(row.item)\"\r\n          ></b-icon-pencil>\r\n        </template>\r\n\r\n        <template #row-details=\"row\">\r\n          <b-card v-show=\"oc\">\r\n            <div>\r\n              <b-row>\r\n                <table border=\"1\">\r\n                  <tr>\r\n                    <th>Item</th>\r\n\r\n                    <th>Descrição</th>\r\n\r\n                    <th>Qtde_Faturada</th>\r\n\r\n                    <th>Qtde_Solicitada</th>\r\n\r\n                    <th>TotalComIPI</th>\r\n\r\n                    <th>TotalLiquido</th>\r\n\r\n                    <th>Valor_Unitario</th>\r\n\r\n                    <th>Valor_Unitario_Bruto</th>\r\n                  </tr>\r\n\r\n                  <tr v-for=\"item in row.item.Itens\" :key=\"item.StatusId\">\r\n                    <td>{{ item.Item }}</td>\r\n\r\n                    <td>{{ item.Descricao }}</td>\r\n\r\n                    <td>{{ item.Qtde_Faturada }}</td>\r\n\r\n                    <td>{{ item.Qtde_Solicitada }}</td>\r\n\r\n                    <td>R$ {{ item.TotalComIPI }}</td>\r\n\r\n                    <td>R$ {{ item.TotalLiquido }}</td>\r\n\r\n                    <td>R$ {{ item.Valor_Unitario }}</td>\r\n\r\n                    <td>R$ {{ item.Valor_Unitario_Bruto }}</td>\r\n                  </tr>\r\n                </table>\r\n\r\n                <b-button\r\n                  v-show=\"\r\n                    row.item.Status != 'Cancelado' &&\r\n                      row.item.Status != 'Finalizado'\r\n                  \"\r\n                  class=\"ml-2\"\r\n                  id=\"center\"\r\n                  variant=\"danger\"\r\n                  v-b-modal.modal-motivo-cancelamento\r\n                  >Cancelar OC</b-button\r\n                >\r\n\r\n                <b-modal\r\n                  id=\"modal-motivo-cancelamento\"\r\n                  ref=\"modal\"\r\n                  title=\"Descreva o motivo do cancelamento\"\r\n                  @hidden=\"resetModal\"\r\n                  @ok=\"handleOk(row)\"\r\n                >\r\n                  <form ref=\"form\" @submit.stop.prevent=\"handleSubmit\">\r\n                    <b-form-group\r\n                      label=\"Motivo\"\r\n                      label-for=\"name-input\"\r\n                      invalid-feedback=\"Motivo do cancelamento é obrigatório\"\r\n                      :state=\"motivoState\"\r\n                    >\r\n                      <b-form-input\r\n                        id=\"name-input\"\r\n                        v-model=\"motivo\"\r\n                        :state=\"motivoState\"\r\n                        required\r\n                      ></b-form-input>\r\n                    </b-form-group>\r\n                  </form>\r\n                </b-modal>\r\n              </b-row>\r\n            </div>\r\n          </b-card>\r\n\r\n          <b-card class=\"m-0\" v-show=\"status\">\r\n            <div>\r\n              <table border=\"1\">\r\n                <tr>\r\n                  <th>Status</th>\r\n\r\n                  <th>Data</th>\r\n                </tr>\r\n\r\n                <tr v-for=\"item in row.item.Rastreio\" :key=\"item.Id\">\r\n                  <td>{{ item.Evento }}</td>\r\n                  <td>{{ new Date(item.DataEvento).toLocaleString() }}</td>\r\n                </tr>\r\n              </table>\r\n\r\n              <br />\r\n            </div>\r\n          </b-card>\r\n        </template>\r\n\r\n        <!-- \r\n          Footer personalizado para somar as colunas de valores\r\n        deixar o primeiro template em branco e preencher os outros com \r\n        as colunas que quero mostrar\r\n        -->\r\n        <template #foot()>\r\n          <div></div>\r\n        </template>\r\n\r\n        <template #foot(ValorComFrete)>\r\n          <div>{{ valor | R$ }}</div>\r\n        </template>\r\n\r\n        <template #foot(ValorFrete)>\r\n          <div>{{ valorFrete | R$ }}</div>\r\n        </template>\r\n      </b-table>\r\n\r\n      <b-row id=\"pagination\" class=\"m-2\">\r\n        <div>\r\n          <b-input style=\"width:50px\" v-model=\"porPagina\"></b-input>\r\n        </div>\r\n\r\n        <b-pagination\r\n          id=\"pagination\"\r\n          :total-rows=\"pedidosTotaisCount\"\r\n          :per-page=\"porPagina\"\r\n          aria-controls=\"my-table\"\r\n          v-model=\"paginaAtiva\"\r\n        ></b-pagination>\r\n      </b-row>\r\n    </b-card>\r\n\r\n    <!-- Legenda -->\r\n    <b-card\r\n      header=\"Legenda de Cores da Tabela\"\r\n      class=\"m-2\"\r\n      header-bg-variant=\"dark\"\r\n      text-variant=\"white\"\r\n    >\r\n      <b-card-group deck>\r\n        <b-card\r\n          bg-variant=\"success\"\r\n          text-variant=\"white\"\r\n          header=\"Criados\"\r\n          class=\"text-center\"\r\n        >\r\n          <b-card-text>Pedidos Novos Criados.</b-card-text>\r\n        </b-card>\r\n        <b-card\r\n          bg-variant=\"danger\"\r\n          text-variant=\"white\"\r\n          header=\"Cancelados\"\r\n          class=\"text-center\"\r\n        >\r\n          <b-card-text>Pedidos Cancelados.</b-card-text>\r\n        </b-card>\r\n        <b-card\r\n          bg-variant=\"info\"\r\n          text-variant=\"white\"\r\n          header=\"Devoluções\"\r\n          class=\"text-center\"\r\n        >\r\n          <b-card-text>Notas Fiscais de Devolução.</b-card-text>\r\n        </b-card>\r\n        <b-card\r\n          bg-variant=\"warning\"\r\n          text-variant=\"white\"\r\n          header=\"Em Atraso\"\r\n          class=\"text-center\"\r\n        >\r\n          <b-card-text>Pedidos Em Atraso.</b-card-text>\r\n        </b-card>\r\n      </b-card-group>\r\n    </b-card>\r\n\r\n    <!-- MODAL -->\r\n\r\n    <b-modal\r\n      size=\"lg\"\r\n      ref=\"AcompanhamentosModal\"\r\n      id=\"AcompanhamentosModal\"\r\n      centered\r\n      hide-footer\r\n      hide-header\r\n    >\r\n      <AcompanhamentosVue :headerId=\"this.acompanhamentoID\" />\r\n    </b-modal>\r\n\r\n    <!-- MODAL -->\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { mapActions, mapGetters } from \"vuex\";\r\nimport ApiService from \"../../../services/api.service\";\r\nimport AcompanhamentosVue from \"../../../components/Acompanhamentos.vue\";\r\nimport loading from \"../../../store/loading\";\r\nimport { timeout } from \"q\";\r\n\r\nexport default {\r\n  name: \"EcommercePedidos\",\r\n  components: {\r\n    AcompanhamentosVue,\r\n  },\r\n  data() {\r\n    return {\r\n      acompanhamentoID: 0,\r\n      motivo: \"\",\r\n      motivoState: null,\r\n      visivel: \"\",\r\n      filtro: \"\",\r\n      filterOn: [\r\n        \"Itens\",\r\n        \"EntregaEmAtraso\",\r\n        \"Fantasia\",\r\n        \"Numero\",\r\n        \"PedidoHubURL\",\r\n        \"OCKappes\",\r\n        \"Cidade\",\r\n        \"Cliente\",\r\n        \"Estado\",\r\n        \"MarketPlace\",\r\n        \"Numero_Nota\",\r\n        \"OrdemCompra\",\r\n        \"Transportadora\",\r\n        \"Romaneio\",\r\n        \"OcId\",\r\n        \"Redespacho\",\r\n      ],\r\n      filtroEmpresas: [\"8\", \"34\"],\r\n      porPagina: 20,\r\n      paginaAtiva: 1,\r\n      marketPlacesListSelected: [],\r\n      statusListSelected: [],\r\n      utilizouFiltro: \"\",\r\n      filtrado: [],\r\n\r\n      loading: false,\r\n      somenteAtrasados: \"\",\r\n      pedidosAtrasados: [],\r\n\r\n      oc: false,\r\n      status: false,\r\n\r\n      dataInicial: new Date(1609549200000),\r\n      dataFinal: \"\",\r\n\r\n      marketPlacesList: [],\r\n      statusList: [],\r\n      pedidosList: [],\r\n      fields: [\r\n        {\r\n          key: \"Empresa\",\r\n          sortable: true,\r\n          label: \"Empresa\",\r\n          visible: true,\r\n        },\r\n        {\r\n          key: \"OcId\",\r\n          sortable: true,\r\n          label: \"Id OC\",\r\n          visible: true,\r\n        },\r\n        {\r\n          key: \"OCKappes\",\r\n          sortable: true,\r\n          tdClass: \"text-nowrap\",\r\n          label: \"OC Kappes\",\r\n          visible: true,\r\n        },\r\n        {\r\n          key: \"Numero\",\r\n          sortable: true,\r\n          label: \"Pedido\",\r\n          visible: true,\r\n          _showDetails: false,\r\n        },\r\n        {\r\n          key: \"DataCompra\",\r\n          sortable: true,\r\n          tdClass: \"text-nowrap\",\r\n          label: \"Data\",\r\n          visible: true,\r\n        },\r\n        {\r\n          key: \"Percentual\",\r\n          sortable: false,\r\n          label: \"Perc Coleta\",\r\n          visible: true,\r\n        },\r\n        {\r\n          key: \"PedidoHubURL\",\r\n          sortable: true,\r\n          tdClass: \"text-nowrap\",\r\n          label: \"OC Parceiro\",\r\n          visible: true,\r\n        },\r\n        {\r\n          key: \"MarketPlace\",\r\n          sortable: true,\r\n          tdClass: \"text-nowrap\",\r\n          label: \"Marketplace\",\r\n          visible: true,\r\n        },\r\n        {\r\n          key: \"Transportadora\",\r\n          sortable: true,\r\n          tdClass: \"text-nowrap\",\r\n          visible: true,\r\n        },\r\n        {\r\n          key: \"Fantasia\",\r\n          sortable: true,\r\n          tdClass: \"text-nowrap\",\r\n          label: \"Cliente\",\r\n          visible: true,\r\n        },\r\n        {\r\n          key: \"Telefone\",\r\n          sortable: true,\r\n          visible: true,\r\n          label: \"Fone\",\r\n        },\r\n        {\r\n          key: \"Cidade\",\r\n          sortable: true,\r\n          tdClass: \"text-nowrap\",\r\n          visible: true,\r\n        },\r\n        {\r\n          key: \"Estado\",\r\n          sortable: true,\r\n          label: \"UF\",\r\n          tdClass: \"text-nowrap\",\r\n          visible: true,\r\n        },\r\n        {\r\n          key: \"Status\",\r\n          sortable: true,\r\n          tdClass: \"text-nowrap\",\r\n          visible: true,\r\n          _showDetails: false,\r\n        },\r\n        {\r\n          key: \"DataStatus\",\r\n          sortable: true,\r\n          tdClass: \"text-nowrap\",\r\n          visible: true,\r\n        },\r\n        {\r\n          key: \"ValorComFrete\",\r\n          sortable: true,\r\n          tdClass: \"text-nowrap\",\r\n          label: \"Valor\",\r\n          visible: true,\r\n        },\r\n        {\r\n          key: \"ValorFrete\",\r\n          sortable: true,\r\n          tdClass: \"text-nowrap\",\r\n          visible: true,\r\n        },\r\n        {\r\n          key: \"ValorFreteDestacado\",\r\n          sortable: true,\r\n          tdClass: \"text-nowrap\",\r\n          visible: true,\r\n          label: \"Destacado\",\r\n        },\r\n        {\r\n          key: \"Romaneio\",\r\n          sortable: true,\r\n          tdClass: \"text-nowrap\",\r\n          visible: true,\r\n        },\r\n        {\r\n          key: \"Numero_Nota\",\r\n          sortable: true,\r\n          tdClass: \"text-nowrap\",\r\n          label: \"Nota\",\r\n          visible: true,\r\n        },\r\n        {\r\n          key: \"DataPrevisaoEntrega\",\r\n          sortable: true,\r\n          tdClass: \"text-nowrap\",\r\n          label: \"Previsao Entrega\",\r\n          visible: true,\r\n        },\r\n        {\r\n          key: \"Actions\",\r\n          sortable: false,\r\n          tdClass: \"text-nowrap\",\r\n          label: \"Ações\",\r\n          visible: true,\r\n        },\r\n        {\r\n          key: \"Redespacho\",\r\n          sortable: true,\r\n          tdClass: \"text-nowrap\",\r\n          label: \"Redespacho\",\r\n          visible: true,\r\n        },\r\n        {\r\n          key: \"DiasAtraso\",\r\n          sortable: true,\r\n          tdClass: \"text-nowrap\",\r\n          label: \"Dias Atraso\",\r\n          visible: true,\r\n        },\r\n        {\r\n          key: \"DataRealEntrega\",\r\n          sortable: true,\r\n          tdClass: \"text-nowrap\",\r\n          label: \"Data Entrega\",\r\n          visible: true,\r\n        },\r\n        {\r\n          key: \"Observacao\",\r\n          tdClass: \"text-nowrap\",\r\n          label: \"OBS\",\r\n          visible: true,\r\n        },\r\n        {\r\n          key: \"Rastreio\",\r\n          tdClass: \"text-nowrap\",\r\n          label: \"Rastreio\",\r\n          visible: false,\r\n        },\r\n      ],\r\n      dragfieldstart: \"\",\r\n    };\r\n  },\r\n\r\n  created() {\r\n    this.acthome(\"/ecommerce\");\r\n    this.buscarUltimaPesquisa();\r\n    this.pedidosList = [];\r\n    this.buscar();\r\n  },\r\n\r\n  // async mounted() {\r\n  //   const pesquisa = await localStorage.getItem(\"ultimaPesquisa\");\r\n\r\n  //   this.fields.map(e => {\r\n  //     if (JSON.parse(pesquisa).fields.find(f => f.key == e.key)) {\r\n  //       e.visible = JSON.parse(pesquisa).fields.find(\r\n  //         f => f.key == e.key\r\n  //       ).visible;\r\n  //     } else {\r\n  //       e.visible = false;\r\n  //     }\r\n  //   });\r\n  // },\r\n\r\n  computed: {\r\n    pedidosFields() {\r\n      return this.fields.filter((f) => f.visible);\r\n    },\r\n\r\n    pedidosTotaisCount() {\r\n      return this.pedidosListEmpresa.length;\r\n    },\r\n\r\n    valor() {\r\n      var sum = this.pedidosListEmpresa.reduce(\r\n        (acumulador, valorAtual) => acumulador + valorAtual.ValorComFrete,\r\n        0\r\n      );\r\n      return Math.round(sum * 100) / 100;\r\n    },\r\n    valorFrete() {\r\n      var sum = this.pedidosListEmpresa.reduce(\r\n        (acumulador, valorAtual) => acumulador + valorAtual.ValorFrete,\r\n        0\r\n      );\r\n      return Math.round(sum * 100) / 100;\r\n    },\r\n\r\n    pedidosListEmpresa() {\r\n      return this.filtrado.filter((res) =>\r\n        this.filtroEmpresas.find((e) => e == res.Empresa)\r\n      );\r\n    },\r\n\r\n    empresa() {\r\n      return this.pedidosList.reduce((a, b) => {\r\n        if (!a.find((f) => f.Empresa == b.Empresa)) {\r\n          a.push({ Empresa: b.Empresa, NomeEmpresa: b.Nome_Empresa });\r\n        }\r\n        return a;\r\n      }, []);\r\n    },\r\n  },\r\n\r\n  methods: {\r\n    ...mapActions([\"acthome\"]),\r\n\r\n    rowClass(item, type) {\r\n      if (!item || type !== \"row\") return;\r\n      if (item.Valor < 0) return \"table-info\";\r\n      if (item.Status === \"Cancelado\") return \"table-danger\";\r\n      if (item.Status === \"Criado\") return \"table-success\";\r\n      if (item.EntregaEmAtraso == true) return \"table-warning\";\r\n    },\r\n\r\n    onRowSelected(items) {\r\n      // console.log(items[0].PedidoHubURL);\r\n    },\r\n\r\n    buscar() {\r\n      ApiService.get(\"v2/IntranetEcommerceB2C/Marketplaces/Combo\").then(\r\n        (result) => {\r\n          this.marketPlacesList = result.data.Data;\r\n        }\r\n      );\r\n      ApiService.get(\"v2/IntranetEcommerceB2C/Pedidos/Status\").then(\r\n        (result) => {\r\n          this.statusList = result.data.Data;\r\n        }\r\n      );\r\n    },\r\n\r\n    async btnFiltros() {\r\n      await this.salvarPesquisas();\r\n      this.loading = true;\r\n      ApiService.post(\"v2/IntranetEcommerceB2C/Pedidos/Get\", {\r\n        status: this.statusListSelected,\r\n        marketplaces: this.marketPlacesListSelected,\r\n        dataInicial: this.dataInicial,\r\n        dataFinal: this.dataFinal,\r\n      }).then((result) => {\r\n        console.log(\"result\", result.data);\r\n        if (result.data.Success) {\r\n          this.pedidosList = result.data.Data;\r\n          this.filtrado = result.data.Data;\r\n          this.utilizouFiltro = new Date();\r\n        }\r\n        this.loading = false;\r\n        this.empresas;\r\n      });\r\n    },\r\n\r\n    async salvarPesquisas() {\r\n      const ultimaPesquisa = {\r\n        marketplaces: this.marketPlacesListSelected,\r\n        status: this.statusListSelected,\r\n        dataInicial: this.dataInicial,\r\n        dataFinal: this.dataFinal,\r\n        porPagina: this.porPagina,\r\n        fields: this.fields,\r\n        filtroEmpresas: this.filtroEmpresas,\r\n      };\r\n      await localStorage.setItem(\r\n        \"ultimaPesquisa\",\r\n        JSON.stringify(ultimaPesquisa)\r\n      );\r\n    },\r\n\r\n    async buscarUltimaPesquisa() {\r\n      const pesquisa = await localStorage.getItem(\"ultimaPesquisa\");\r\n      this.statusListSelected = JSON.parse(pesquisa).status\r\n        ? JSON.parse(pesquisa).status\r\n        : this.status;\r\n      this.marketPlacesListSelected = JSON.parse(pesquisa).marketplaces\r\n        ? JSON.parse(pesquisa).marketplaces\r\n        : this.marketplaces;\r\n      this.dataInicial = JSON.parse(pesquisa).dataInicial\r\n        ? JSON.parse(pesquisa).dataInicial\r\n        : this.dataInicial;\r\n      this.dataFinal = JSON.parse(pesquisa).dataFinal\r\n        ? JSON.parse(pesquisa).dataFinal\r\n        : this.dataFinal;\r\n      this.porPagina = JSON.parse(pesquisa).porPagina\r\n        ? JSON.parse(pesquisa).porPagina\r\n        : this.porPagina;\r\n      // adicionar as fields para as colunas\r\n      this.fields = JSON.parse(pesquisa).fields\r\n        ? JSON.parse(pesquisa).fields\r\n        : this.fields;\r\n      this.filtroEmpresas = JSON.parse(pesquisa).filtroEmpresas\r\n        ? JSON.parse(pesquisa).filtroEmpresas\r\n        : this.filtroEmpresas;\r\n      this.btnFiltros();\r\n    },\r\n\r\n    clearInicialDate() {\r\n      this.dataInicial = \"\";\r\n    },\r\n\r\n    clearFinalDate() {\r\n      this.dataFinal = \"\";\r\n    },\r\n\r\n    atrasados() {\r\n      this.pedidosAtrasados = [];\r\n      if (this.filtro == \"\") {\r\n        this.filtro = \"true\";\r\n        this.somenteAtrasados = true;\r\n        this.pedidosAtrasados = this.pedidosList.filter(\r\n          (atrasado) => atrasado.EntregaEmAtraso === true\r\n        );\r\n      } else {\r\n        this.filtro = \"\";\r\n        this.somenteAtrasados = false;\r\n      }\r\n    },\r\n\r\n    detalhes(row, text) {\r\n      if (\r\n        row.item._showDetails == undefined ||\r\n        row.item._showDetails == false\r\n      ) {\r\n        if (text == \"status\") {\r\n          this.status = true;\r\n        } else if (text == \"oc\") {\r\n          this.oc = true;\r\n        }\r\n        row.item._showDetails = true;\r\n      } else {\r\n        row.item._showDetails = false;\r\n        this.status = false;\r\n        this.oc = false;\r\n      }\r\n    },\r\n\r\n    gerarRomaneios() {\r\n      ApiService.get(\r\n        \"v2/IntranetEcommerceB2C/Pedidos/GeraRomaneioFatura\", {}, true, 45000,\r\n       \r\n      )\r\n        .then((res) => {\r\n          this.$root.toastsuccess(res);\r\n          this.btnFiltros();\r\n        })\r\n        .catch((e) => {\r\n          this.$root.toastdanger(\"Erro ao gerar romaneios! \" + e);\r\n        });\r\n    },\r\n\r\n    resetModal() {\r\n      this.motivo = \"\";\r\n      this.motivoState = null;\r\n    },\r\n    handleOk(row) {\r\n      this.handleSubmit(row);\r\n    },\r\n    handleSubmit(row) {\r\n      if (this.motivo == \"\") {\r\n        return;\r\n      }\r\n      // Hide the modal manually\r\n      this.$nextTick(() => {\r\n        // envia via api o processo de cancelamento\r\n        console.log(\"OcId: \" + row.item.OcId + \" || Motivo: \" + this.motivo);\r\n        var data = {\r\n          OcId: row.item.OcId,\r\n          Motivo: this.motivo,\r\n        };\r\n        ApiService.post(\"v2/IntranetEcommerceB2C/OrdemCompra/Cancelar\", data)\r\n          .then((data) => {\r\n            console.log(data);\r\n            this.$root.toastsuccess(\"OC cancelado com sucesso!\");\r\n          })\r\n          .catch((e) => {\r\n            this.$root.toastdanger(\"Erro ao cancelar a OC!\");\r\n          });\r\n\r\n        this.$bvModal.hide(\"modal-motivo-cancelamento\");\r\n      });\r\n    },\r\n\r\n    /* DRAG COLUMNS */\r\n    dragStart(e) {\r\n      console.log(\"dragStart in :\", e.target.id);\r\n      this.dragfieldstart = e.target.id;\r\n    },\r\n    dragEnter(e) {\r\n      e.preventDefault();\r\n      e.target.classList.add(\"drag-over\");\r\n    },\r\n\r\n    dragOver(e) {\r\n      e.preventDefault();\r\n      e.target.classList.add(\"drag-over\");\r\n    },\r\n\r\n    dragLeave(e) {\r\n      e.target.classList.remove(\"drag-over\");\r\n    },\r\n\r\n    drop(e) {\r\n      console.log(\"drop in :\", e.target.id);\r\n      e.target.classList.remove(\"drag-over\");\r\n      // move o from para o to\r\n      this.changecolumns(this.dragfieldstart, e.target.id);\r\n    },\r\n    changecolumns(ColumnA, ColumnB) {\r\n      const start = this.fields.findIndex((f) => (f.key || f) == ColumnA);\r\n      let from = start;\r\n      let to = this.fields.findIndex((f) => (f.key || f) == ColumnB);\r\n      // move a colunaA para o indice da coluna B\r\n      this.move(from, to);\r\n\r\n      // move a colunaA para o indice da coluna B\r\n      //from = this.fields.findIndex((f) => (f.key || f) == ColumnB);\r\n      //to = start;\r\n      //this.move(from, to);\r\n    },\r\n    move(from, to) {\r\n      this.fields.splice(to, 0, this.fields.splice(from, 1)[0]);\r\n    },\r\n\r\n    calculaAtraso(data1, data2) {\r\n      //  console.error(\"data1\", data1);\r\n      //  console.error(\"data2\", data2);\r\n\r\n      var previsao = new Date(data1);\r\n      var hoje = new Date();\r\n      var entrega = new Date(data2);\r\n      if (data1 == null) {\r\n        return \"\";\r\n      } else {\r\n        if (data2 != \"\") {\r\n          var diffEntrega = Math.abs(entrega - previsao);\r\n          var diasDiff = diffEntrega / (1000 * 3600 * 24);\r\n          if (previsao > entrega) {\r\n            return \"-\" + Math.round(diasDiff);\r\n          } else {\r\n            return Math.round(diasDiff);\r\n          }\r\n        } else {\r\n          var diff = Math.abs(hoje - previsao);\r\n          var days = diff / (1000 * 3600 * 24);\r\n          if (previsao >= hoje) {\r\n            return \"-\" + Math.round(days);\r\n          } else {\r\n            return Math.round(days);\r\n          }\r\n        }\r\n      }\r\n    },\r\n\r\n    async getAcompanhamentoRelacionamentos(item) {\r\n      var res = await ApiService.post(\r\n        \"v2/Acompanhamentos/Relacionamentos/Get\",\r\n        {\r\n          Chave: item.Id,\r\n          Tabela: \"Pedidos\",\r\n        }\r\n      );\r\n\r\n      if (res.data.Success /* true */) {\r\n        this.acompanhamentoID = res.data.Data[0].AcompanhamentoId;\r\n        this.$refs[\"AcompanhamentosModal\"].show();\r\n      } else {\r\n        /* false */\r\n        var res1 = await ApiService.post(\r\n          \"v2/Acompanhamentos/Relacionamentos/Save\",\r\n          {\r\n            Chave: item.Id,\r\n            Tabela: \"Pedidos\",\r\n            AcompanhamentoId: null,\r\n            AcompanhamentoDescricao: \"Acompanhamentos Pedido \" + item.Numero,\r\n          }\r\n        );\r\n        this.acompanhamentoID = res1.data.Data[0].AcompanhamentoId;\r\n        this.$refs[\"AcompanhamentosModal\"].show();\r\n      }\r\n    },\r\n  },\r\n};\r\n</script>\r\n\r\n<style>\r\n#divPrincipal {\r\n  font-size: 12px;\r\n}\r\n\r\n#center {\r\n  display: block;\r\n}\r\n\r\n#row {\r\n  justify-content: space-between;\r\n  margin: 1px, 1px, 1px, 1px;\r\n}\r\n\r\n#linkTabela {\r\n  color: blue;\r\n}\r\n\r\n#botoes {\r\n  width: min-content;\r\n  white-space: nowrap;\r\n  margin: 2px;\r\n}\r\n\r\n#inputDate {\r\n  width: 350px;\r\n}\r\n\r\n#pagination {\r\n  display: flex;\r\n  justify-content: flex-end;\r\n}\r\n\r\n.drag-over {\r\n  background-color: silver;\r\n  border-right: 5px solid lightgreen;\r\n  border-left: 5px solid lightgreen;\r\n}\r\n</style>\r\n"]}]}