{"remainingRequest":"C:\\k1-services\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\k1-services\\src\\components\\InputSearch2.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\k1-services\\src\\components\\InputSearch2.vue","mtime":1701906516403},{"path":"C:\\k1-services\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1670977934221},{"path":"C:\\k1-services\\node_modules\\babel-loader\\lib\\index.js","mtime":1670977935138},{"path":"C:\\k1-services\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1670977934221},{"path":"C:\\k1-services\\node_modules\\vue-loader\\lib\\index.js","mtime":1674603023821}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KDQppbXBvcnQgeyBtYXBBY3Rpb25zIH0gZnJvbSAndnVleCcNCmltcG9ydCBBcGlTZXJ2aWNlIGZyb20gJy4uL3NlcnZpY2VzL2FwaS5zZXJ2aWNlJw0KaW1wb3J0IFRhYmxlRWRpdEFwaSBmcm9tICcuLi9jb21wb25lbnRzL1RhYmxlRWRpdEFwaScNCmV4cG9ydCBkZWZhdWx0IHsNCg0KICAgIG5hbWU6ICdJbnB1dFNlYXJjaDInLA0KDQogICAgY29tcG9uZW50czogew0KDQogICAgICAgIFRhYmxlRWRpdEFwaQ0KDQogICAgfSwNCg0KICAgIHByb3BzOiB7DQogICAgICAgIHBrOiB7IHR5cGU6IFN0cmluZywgZGVmYXVsdCgpIHsgcmV0dXJuICctJyB9IH0sDQogICAgICAgIGlkOiB7IHR5cGU6IFN0cmluZywgZGVmYXVsdCgpIHsgcmV0dXJuICdJbnB1dFNlYXJjaERlZmF1bHQnIH0gfSwNCiAgICAgICAgbW9kYWx0aXRsZTogeyB0eXBlOiBTdHJpbmcsIGRlZmF1bHQoKSB7IHJldHVybiAnUmVzdWx0YWRvIGRhIGJ1c2NhJyB9IH0sDQogICAgICAgIHJvdXRlYXBpOiB7IHR5cGU6IFN0cmluZywgZGVmYXVsdCgpIHsgcmV0dXJuICcnIH0gfSwNCiAgICAgICAgcGFyYW1zOiB7IHR5cGU6IE9iamVjdCwgZGVmYXVsdCgpIHsgDQogICAgICAgICAgICByZXR1cm4gew0KICAgICAgICAgICAgICAgICAgICBwYXJhbXM6IHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHBlc3F1aXNhOiAnJw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KICAgICAgICB9LA0KICAgICAgICBmaWVsZExpc3Q6IHsgdHlwZTogQXJyYXksIGRlZmF1bHQoKSB7DQogICAgICAgICAgICAgICAgcmV0dXJuIFsNCiAgICAgICAgICAgICAgICAgICAgeyBrZXk6ICd2YWx1ZScsIGNhcHRpb246ICdDw7NkaWdvJywgc29ydGFibGU6IHRydWUgfSwNCiAgICAgICAgICAgICAgICAgICAgeyBrZXk6ICd0ZXh0JywgY2FwdGlvbjogJ0Rlc2NyacOnw6NvJywgc29ydGFibGU6IHRydWUgfQ0KICAgICAgICAgICAgICAgIF0NCiAgICAgICAgICAgIH0NCiAgICAgICAgfSwNCiAgICAgICAgc2l6ZTogeyB0eXBlOiBTdHJpbmcsIGRlZmF1bHQoKSB7IHJldHVybiAnc20nIH0gfSwNCiAgICAgICAgYnV0dG9uQ2FwdGlvbjogeyB0eXBlOiBTdHJpbmcsIGRlZmF1bHQoKSB7IHJldHVybiAnQnVzY2FyJyB9IH0NCiAgICB9LA0KDQogICAgZGF0YSgpIHsNCiAgICAgICAgcmV0dXJuIHsNCiAgICAgICAgICAgIHZhbHVlOiB0aGlzLnBrIHx8ICctJywNCiAgICAgICAgICAgIHRleHQ6ICcnLA0KICAgICAgICAgICAgbGlzdExvYWQ6IGZhbHNlLA0KICAgICAgICAgICAgaXRlbXNMaXN0OiBbXQ0KICAgICAgICB9DQogICAgfSwNCg0KICAgIGNvbXB1dGVkOiB7DQogICAgICAgIHBhcmFtc2FwaSgpIHsNCiAgICAgICAgICAgIHJldHVybiB7IHBlc3F1aXNhOiB0aGlzLnRleHQgfSAvLyB2b3UgdGVyIHF1ZSBlbmdlc3NhciBhcXVpDQogICAgICAgIH0NCiAgICB9LA0KDQogICAgbWV0aG9kczogew0KDQogICAgICAgIC4uLm1hcEFjdGlvbnMoWydhY3RBbGVydCddKSwNCg0KICAgICAgICBpbnB1dCgpIHsNCiAgICAgICAgICAgIHRoaXMuJGVtaXQoJ2lucHV0JywgdGhpcy52YWx1ZSkNCiAgICAgICAgfSwNCg0KICAgICAgICBzZWFyY2goZXZ0LCB0ZXh0ID0gbnVsbCkgew0KDQogICAgICAgICAgICBpZiAodGV4dCkgew0KICAgICAgICAgICAgICAgIHRoaXMudGV4dCA9IHRleHQNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgdGhpcy5saXN0TG9hZCA9IHRydWUNCg0KICAgICAgICAgICAgQXBpU2VydmljZQ0KICAgICAgICAgICAgICAgIC5wb3N0KHRoaXMucm91dGVhcGksIHRoaXMucGFyYW1zYXBpKQ0KICAgICAgICAgICAgICAgIC50aGVuKHJlcyA9PiB7DQoNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5saXN0TG9hZCA9IGZhbHNlDQogICAgICAgICAgICAgICAgICAgIGlmIChyZXMuZGF0YS5TdWNjZXNzID09ICdGYWxzZScpIHsNCg0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5hY3RBbGVydCh7dmFyaWFudDogJ2RhbmdlcicsIG1lc3NhZ2U6IHJlcy5kYXRhLkVycm9yfSkNCg0KICAgICAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHJlcy5kYXRhLlN1Y2Nlc3MgPT0gJ1RydWUnKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5pdGVtc0xpc3QgPSByZXMuZGF0YS5EYXRhLm1hcChkID0+IHsgcmV0dXJuIHt2YWx1ZTogZC52YWx1ZSwgdGV4dDogZC50ZXh0fSB9KQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLml0ZW1zTGlzdC5sZW5ndGg+MSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLiRidk1vZGFsLnNob3coYElucHV0U2VhcmNoX01vZGFsLSR7dGhpcy5pZH1gKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc2VhcmNoRm91bmRlZCh0aGlzLml0ZW1zTGlzdFswXSkNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9LA0KDQogICAgICAgICAgICAgICAgZXJyb3IgPT4gew0KICAgICAgICAgICAgICAgICAgICBsZXQgbGVycm9yID0gew0KICAgICAgICAgICAgICAgICAgICAgICAgc3RhdHVzOiAwLA0KICAgICAgICAgICAgICAgICAgICAgICAgY29kZTogLTEsDQogICAgICAgICAgICAgICAgICAgICAgICBtZXNzYWdlOiAnJywNCiAgICAgICAgICAgICAgICAgICAgICAgIGVycm9yOiB7fSwNCiAgICAgICAgICAgICAgICAgICAgICAgIHJlc3BvbnNlOiB7fQ0KICAgICAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICAgICAgaWYgKGVycm9yID09ICdFcnJvcjogTmV0d29yayBFcnJvcicpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGxlcnJvci5zdGF0dXMgPSA1MDUNCiAgICAgICAgICAgICAgICAgICAgICAgIGxlcnJvci5tZXNzYWdlID0gJ0Vycm8gbmEgcmVkZScNCiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGxlcnJvci5lcnJvciA9IGVycm9yDQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoZXJyb3IuaGFzT3duUHJvcGVydHkoJ3Jlc3BvbnNlJykpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXJyb3IucmVzcG9uc2UgPSBlcnIucmVzcG9uc2UNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoZXJyb3IucmVzcG9uc2UuaGFzT3duUHJvcGVydHkoJ3N0YXR1cycpKSBsZXJyb3Iuc3RhdHVzID0gZXJyLnJlc3BvbnNlLnN0YXR1cw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChlcnJvci5yZXNwb25zZS5oYXNPd25Qcm9wZXJ0eSgnbWVzc2FnZScpKSBsZXJyb3IubWVzc2FnZSA9IGVyci5yZXNwb25zZS5tZXNzYWdlDQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgICAgICBpZiAoZXJyb3IuaGFzT3duUHJvcGVydHkoJ3N0YXR1cycpKQ0KICAgICAgICAgICAgICAgICAgICBpZiAoZXJyb3Iuc3RhdHVzID09PSA0MDEpIGxlcnJvci5tZXNzYWdlID0gJ0Vycm8gbmEgYXV0ZW50aWNhw6fDo28sIHZlcmlmaXF1ZSB1c3XDoXJpbyBlIHNlbmhhJw0KDQogICAgICAgICAgICAgICAgICAgIGlmIChlcnJvci5oYXNPd25Qcm9wZXJ0eSgnc3RhdHVzJykpDQogICAgICAgICAgICAgICAgICAgIGlmIChlcnJvci5zdGF0dXMgPT09IDQwMCkgZXJyb3IubWVzc2FnZSA9IGVycm9yLnJlc3BvbnNlLmRhdGENCg0KICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnU2VhcmNoQXBpOjpzZWFyY2g6ICcsIGVycm9yKQ0KDQogICAgICAgICAgICAgICAgICAgIHN0b3JlLmRpc3BhdGNoKCdhY3RTeXN0ZW1FcnJvckxvZycsIGVycm9yKQ0KDQogICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdTZWFyY2hBcGkuc2VhcmNoLmVycm9yOicsIGVycm9yKQ0KDQogICAgICAgICAgICAgICAgICAgIHRoaXMuZXZ0RXJyb3IoZXJyb3IubWVzc2FnZSkNCg0KICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoZXJyb3IpDQogICAgICAgICAgICAgICAgfSkNCiAgICAgICAgfSwNCg0KICAgICAgICBzZWFyY2hGb3VuZGVkKHNlbGVjdGVkKSB7DQoNCiAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKCdJbnB1dFNlYXJjaDIuc2VhcmNoRm91bmRlZCcsIHNlbGVjdGVkKQ0KDQogICAgICAgICAgICB0aGlzLnRleHQgPSBzZWxlY3RlZC50ZXh0DQogICAgICAgICAgICB0aGlzLnZhbHVlID0gc2VsZWN0ZWQudmFsdWUNCg0KICAgICAgICAgICAgdGhpcy4kYnZNb2RhbC5oaWRlKGBJbnB1dFNlYXJjaF9Nb2RhbC0ke3RoaXMuaWR9YCkNCg0KICAgICAgICAgICAgdGhpcy5pbnB1dCgpDQogICAgICAgIH0sICAgICAgIA0KDQogICAgICAgIGV2dHNlbGVjdChldnQpIHsNCg0KICAgICAgICAgICAgdGhpcy5zZWFyY2hGb3VuZGVkKGV2dFswXSkNCg0KICAgICAgICB9LA0KDQogICAgICAgIGV2dEVycm9yKGVycm9yTWVzc2FnZSkgew0KICAgICAgICAgICAgdGhpcy4kZW1pdCgnZXZ0LWVycm9yJywgZXJyb3JNZXNzYWdlKQ0KICAgICAgICB9DQogICAgfQ0KICAgIA0KfQ0K"},{"version":3,"sources":["InputSearch2.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA8BA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;;AAEA;;AAEA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA","file":"InputSearch2.vue","sourceRoot":"src/components","sourcesContent":["<template>\r\n    <div>\r\n        <b-overlay :show=\"listLoad\" rounded=\"sm\">\r\n        <b-input-group :prepend=\"value\" :size=\"size\" @keyup.enter=\"search\">\r\n                <b-form-input type=\"search\" v-model=\"text\" v-bind=\"$attrs\"/>\r\n            <b-input-group-append>\r\n                <b-button size=\"sm\" text=\"Button\" variant=\"primary\" @click=\"search\" :disabled=\"text==''\">{{ buttonCaption }}</b-button>\r\n            </b-input-group-append>\r\n        </b-input-group>\r\n        </b-overlay>\r\n\r\n        <b-modal :id=\"`InputSearch_Modal-${id}`\" okOnly scrollable no-close-on-backdrop :title=\"modaltitle\">\r\n            <TableEditApi\r\n                :fields=\"fieldList\"\r\n                :items=\"itemsList\"\r\n                :page=\"1\"\r\n                :perPage=\"10\"\r\n                :buttons=\"[]\"\r\n                @evt-select=\"evtselect\"/>\r\n        </b-modal>\r\n        <!--\r\n        <b-row>\r\n            <b-col>value: {{value}}</b-col>\r\n            <b-col>text: {{text}}</b-col>\r\n            <b-col>paramsapi: {{paramsapi}}</b-col>\r\n        </b-row>\r\n        -->\r\n    </div>\r\n</template>\r\n<script>\r\nimport { mapActions } from 'vuex'\r\nimport ApiService from '../services/api.service'\r\nimport TableEditApi from '../components/TableEditApi'\r\nexport default {\r\n\r\n    name: 'InputSearch2',\r\n\r\n    components: {\r\n\r\n        TableEditApi\r\n\r\n    },\r\n\r\n    props: {\r\n        pk: { type: String, default() { return '-' } },\r\n        id: { type: String, default() { return 'InputSearchDefault' } },\r\n        modaltitle: { type: String, default() { return 'Resultado da busca' } },\r\n        routeapi: { type: String, default() { return '' } },\r\n        params: { type: Object, default() { \r\n            return {\r\n                    params: {\r\n                        pesquisa: ''\r\n                    }\r\n                }\r\n            }\r\n        },\r\n        fieldList: { type: Array, default() {\r\n                return [\r\n                    { key: 'value', caption: 'Código', sortable: true },\r\n                    { key: 'text', caption: 'Descrição', sortable: true }\r\n                ]\r\n            }\r\n        },\r\n        size: { type: String, default() { return 'sm' } },\r\n        buttonCaption: { type: String, default() { return 'Buscar' } }\r\n    },\r\n\r\n    data() {\r\n        return {\r\n            value: this.pk || '-',\r\n            text: '',\r\n            listLoad: false,\r\n            itemsList: []\r\n        }\r\n    },\r\n\r\n    computed: {\r\n        paramsapi() {\r\n            return { pesquisa: this.text } // vou ter que engessar aqui\r\n        }\r\n    },\r\n\r\n    methods: {\r\n\r\n        ...mapActions(['actAlert']),\r\n\r\n        input() {\r\n            this.$emit('input', this.value)\r\n        },\r\n\r\n        search(evt, text = null) {\r\n\r\n            if (text) {\r\n                this.text = text\r\n            }\r\n\r\n            this.listLoad = true\r\n\r\n            ApiService\r\n                .post(this.routeapi, this.paramsapi)\r\n                .then(res => {\r\n\r\n                    this.listLoad = false\r\n                    if (res.data.Success == 'False') {\r\n\r\n                        this.actAlert({variant: 'danger', message: res.data.Error})\r\n\r\n                    } else {\r\n                        if (res.data.Success == 'True') {\r\n                            this.itemsList = res.data.Data.map(d => { return {value: d.value, text: d.text} })\r\n                            if (this.itemsList.length>1) {\r\n                                this.$bvModal.show(`InputSearch_Modal-${this.id}`)\r\n                            } else {\r\n                                this.searchFounded(this.itemsList[0])\r\n                            }\r\n                        }\r\n                    }\r\n                },\r\n\r\n                error => {\r\n                    let lerror = {\r\n                        status: 0,\r\n                        code: -1,\r\n                        message: '',\r\n                        error: {},\r\n                        response: {}\r\n                    }\r\n\r\n                    if (error == 'Error: Network Error') {\r\n                        lerror.status = 505\r\n                        lerror.message = 'Erro na rede'\r\n                    } else {\r\n                        lerror.error = error\r\n                        if (error.hasOwnProperty('response')) {\r\n                            lerror.response = err.response\r\n                            if (error.response.hasOwnProperty('status')) lerror.status = err.response.status\r\n                            if (error.response.hasOwnProperty('message')) lerror.message = err.response.message\r\n                        }\r\n                    }\r\n\r\n                    if (error.hasOwnProperty('status'))\r\n                    if (error.status === 401) lerror.message = 'Erro na autenticação, verifique usuário e senha'\r\n\r\n                    if (error.hasOwnProperty('status'))\r\n                    if (error.status === 400) error.message = error.response.data\r\n\r\n                    console.log('SearchApi::search: ', error)\r\n\r\n                    store.dispatch('actSystemErrorLog', error)\r\n\r\n                    console.log('SearchApi.search.error:', error)\r\n\r\n                    this.evtError(error.message)\r\n\r\n                    throw new Error(error)\r\n                })\r\n        },\r\n\r\n        searchFounded(selected) {\r\n\r\n            // console.log('InputSearch2.searchFounded', selected)\r\n\r\n            this.text = selected.text\r\n            this.value = selected.value\r\n\r\n            this.$bvModal.hide(`InputSearch_Modal-${this.id}`)\r\n\r\n            this.input()\r\n        },       \r\n\r\n        evtselect(evt) {\r\n\r\n            this.searchFounded(evt[0])\r\n\r\n        },\r\n\r\n        evtError(errorMessage) {\r\n            this.$emit('evt-error', errorMessage)\r\n        }\r\n    }\r\n    \r\n}\r\n</script>"]}]}