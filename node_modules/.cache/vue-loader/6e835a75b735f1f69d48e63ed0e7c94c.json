{"remainingRequest":"C:\\k1-services\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\k1-services\\src\\pages\\covid\\components\\QrcodeFunc.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\k1-services\\src\\pages\\covid\\components\\QrcodeFunc.vue","mtime":1701906516469},{"path":"C:\\k1-services\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1670977934221},{"path":"C:\\k1-services\\node_modules\\babel-loader\\lib\\index.js","mtime":1670977935138},{"path":"C:\\k1-services\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1670977934221},{"path":"C:\\k1-services\\node_modules\\vue-loader\\lib\\index.js","mtime":1674603023821}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KDQppbXBvcnQgeyBtYXBBY3Rpb25zLCBtYXBHZXR0ZXJzIH0gZnJvbSAndnVleCcNCmltcG9ydCBTZWFyY2hBcGkgZnJvbSAnLi4vLi4vLi4vY29tcG9uZW50cy9TZWFyY2hBcGknDQpleHBvcnQgZGVmYXVsdCB7DQogICAgDQogICAgbmFtZTogJ1FyY29kZUZ1bmMnLA0KDQogICAgZGF0YSgpIHsNCiAgICAgICAgcmV0dXJuIHsNCiAgICAgICAgICAgIGZ1bmM6IHt2YWx1ZTogJy0nLCB0ZXh0OiAnJ30sDQogICAgICAgICAgICBzaG93Y2FtOiB0cnVlLA0KICAgICAgICAgICAgdGVzdGVzOiAnJywNCiAgICAgICAgICAgIGNhbWVyYXM6IHsNCiAgICAgICAgICAgICAgICBub1JlYXJDYW1lcmE6IGZhbHNlLA0KICAgICAgICAgICAgICAgIG5vRnJvbnRDYW1lcmE6IGZhbHNlLA0KICAgICAgICAgICAgICAgIHRvcmNoTm90U3VwcG9ydGVkOiBmYWxzZSwNCiAgICAgICAgICAgICAgICB0b3JjaEFjdGl2ZTogZmFsc2UsDQogICAgICAgICAgICAgICAgY29uZmlnOiBudWxsLA0KICAgICAgICAgICAgICAgIHNlbGVjdGVkOiAnYXV0bycsDQogICAgICAgICAgICAgICAgZGF0YTogW10NCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgIH0sDQoNCiAgICBjb21wb25lbnRzOiB7DQoNCiAgICAgICAgU2VhcmNoQXBpDQogICAgDQogICAgfSwNCg0KICAgIGNvbXB1dGVkOiB7DQoNCiAgICAgICAgLi4ubWFwR2V0dGVycyhbJ2d0eGZ1bmNEYXRhJ10pLA0KDQogICAgICAgIGNhbkNoYW5nZUNhbSgpIHsNCiAgICAgICAgICAgIHJldHVybiAodGhpcy5jYW1lcmFzLmRhdGEubGVuZ3RoPjEpDQogICAgICAgIH0sDQoNCiAgICAgICAgY2FwdGlvbkJ1dHRvbigpIHsNCiAgICAgICAgICAgIHJldHVybiAodGhpcy5zaG93Y2FtKSA/ICdQZXNxdWlzYXIgZnVuY2lvbsOhcmlvJyA6ICdMZXIgUVJDb2RlJw0KICAgICAgICB9LA0KDQogICAgICAgIHJlYWRvaygpIHsNCiAgICAgICAgICAgIHJldHVybiAodGhpcy5jYW1lcmFzLnNlbGVjdGVkID09ICdvZmYnKQ0KICAgICAgICB9LA0KDQogICAgICAgIGljb24oKSB7DQogICAgICAgICAgICByZXR1cm4gKHRoaXMudG9yY2hBY3RpdmUpID8gJ2xpZ2h0bmluZycgOiAnbGlnaHRuaW5nLWZpbGwnDQogICAgICAgIH0NCg0KICAgIH0sDQoNCiAgICBtZXRob2RzOiB7DQoNCiAgICAgICAgLi4ubWFwQWN0aW9ucyhbJ2FjdGZ1bmNidXNjYXInXSksDQoNCiAgICAgICAgbGltcGFCdXNjYSgpIHsNCiAgICAgICAgICAgIHRoaXMuZnVuYyA9IHt2YWx1ZTogJy0nLCB0ZXh0OiAnJ30NCiAgICAgICAgfSwNCg0KICAgICAgICBhc3luYyBvbkRlY29kZShkZWNvZGVkU3RyaW5nKSB7DQoNCiAgICAgICAgICAgIGlmIChkZWNvZGVkU3RyaW5nLmxlbmd0aCA9PSAzNikgew0KICAgIA0KICAgICAgICAgICAgICAgIHRoaXMuY2FtZXJhcy5zZWxlY3RlZCA9ICdvZmYnDQogICAgICAgICAgICAgICAgYXdhaXQgdGhpcy50aW1lb3V0KDgwMCkNCiAgICAgICAgICAgICAgICB0aGlzLmNhbWVyYXMuc2VsZWN0ZWQgPSAnYXV0bycNCiAgICANCiAgICAgICAgICAgICAgICB0aGlzLmJ1c2NhRnVuYyhkZWNvZGVkU3RyaW5nKQ0KICAgICAgICAgICAgfQ0KICAgICAgICB9LA0KDQogICAgICAgIG9uQ2FtZXJhQ2hhbmdlICgpIHsNCg0KICAgICAgICAgICAgaWYgKCghdGhpcy5jYW1lcmFzLm5vRnJvbnRDYW1lcmEpICYmICh0aGlzLmNhbWVyYXMuc2VsZWN0ZWQgIT09ICdmcm9udCcpKSB7DQogICAgICAgICAgICAgICAgdGhpcy5jYW1lcmFzLnNlbGVjdGVkID0gJ2Zyb250Jw0KICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICBpZiAoKCF0aGlzLmNhbWVyYXMubm9SZWFyQ2FtZXJhKSAmJiAodGhpcy5jYW1lcmFzLnNlbGVjdGVkICE9PSAncmVhcicpKSB7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuY2FtZXJhcy5zZWxlY3RlZCA9ICdyZWFyJw0KICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuY2FtZXJhcy5zZWxlY3RlZCA9ICdhdXRvJw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgDQoNCiAgICAgICAgfSwNCg0KICAgICAgICBvbkluaXQgKHByb21pc2UpIHsNCiAgICAgICAgICAgIHByb21pc2UudGhlbihjYW1zID0+IHsNCiAgICAgICAgICAgICAgICBpZiAodGhpcy5jYW1lcmFzLmRhdGEubGVuZ3RoID09IDApIHRoaXMuY2FtZXJhcy5kYXRhID0gY2Ftcy5jYXBhYmlsaXRpZXMuZmFjaW5nTW9kZS5tYXAoYyA9PiB7cmV0dXJuIHt2YWx1ZTogYywgdGV4dDogY319KQ0KICAgICAgICAgICAgICAgIHRoaXMudG9yY2hBY3RpdmUgPSAhY2Ftcy5jYXBhYmlsaXRpZXMudG9yY2gNCg0KICAgICAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKCdjYW1lcmFzOicsIHRoaXMuY2FtZXJhcykNCiAgICAgICAgICAgIH0pDQogICAgICAgICAgICBwcm9taXNlLmNhdGNoKGVycm9yID0+IHsNCiAgICAgICAgICAgICAgICBjb25zdCBjYW1lcmFNaXNzaW5nRXJyb3IgPSBlcnJvci5uYW1lID09PSAnT3ZlcmNvbnN0cmFpbmVkRXJyb3InDQogICAgICAgICAgICAgICAgY29uc3QgdHJpZWRSZWFyQ2FtZXJhID0gdGhpcy5jYW1lcmFzLnNlbGVjdGVkID09PSAncmVhcicNCiAgICAgICAgICAgICAgICBjb25zdCB0cmllZEZyb250Q2FtZXJhID0gdGhpcy5jYW1lcmFzLnNlbGVjdGVkID09PSAnZnJvbnQnDQoNCiAgICAgICAgICAgICAgICBpZiAodHJpZWRSZWFyQ2FtZXJhICYmIGNhbWVyYU1pc3NpbmdFcnJvcikgew0KICAgICAgICAgICAgICAgICAgICB0aGlzLmNhbWVyYXMubm9SZWFyQ2FtZXJhID0gdHJ1ZQ0KICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgIGlmICh0cmllZEZyb250Q2FtZXJhICYmIGNhbWVyYU1pc3NpbmdFcnJvcikgew0KICAgICAgICAgICAgICAgICAgICB0aGlzLmNhbWVyYXMubm9Gcm9udENhbWVyYSA9IHRydWUNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9KQ0KICAgICAgICB9LA0KDQogICAgICAgIGJ1c2NhRnVuYyhidXNjYSkgew0KICAgICAgICAgICAgbGV0IHBhcmFtcyA9IHsNCiAgICAgICAgICAgICAgICBwZXNxdWlzYTogKHR5cGVvZihidXNjYSk9PSdvYmplY3QnKSA/IGJ1c2NhLnZhbHVlIDogYnVzY2ENCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIHRoaXMuJGVtaXQoJ2V2dC1idXNjYScsIHBhcmFtcykNCiAgICAgICAgfSwNCg0KICAgICAgICBjYW1lcmFPayhjYW0pIHsNCg0KICAgICAgICB9LA0KDQogICAgICAgIGFzeW5jIHRpbWVvdXQgKG1zKSB7DQogICAgICAgICAgICByZXR1cm4gbmV3IFByb21pc2UocmVzb2x2ZSA9PiB7DQogICAgICAgICAgICAgICAgd2luZG93LnNldFRpbWVvdXQocmVzb2x2ZSwgbXMpDQogICAgICAgICAgICB9KQ0KICAgICAgICB9DQoNCiAgICB9LA0KDQogICAgd2F0Y2g6IHsNCiAgICAgICAgZnVuYyhmdW5jKSB7DQogICAgICAgICAgICAvLyBjb25zb2xlLmxvZygnZnVuYzonLCBmdW5jKQ0KICAgICAgICAgICAgaWYgKHRoaXMuZnVuYy52YWx1ZSAhPT0gJy0nKSB0aGlzLmJ1c2NhRnVuYyhmdW5jKQ0KICAgICAgICB9DQogICAgfQ0KICAgIA0KfQ0K"},{"version":3,"sources":["QrcodeFunc.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA8BA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA","file":"QrcodeFunc.vue","sourceRoot":"src/pages/covid/components","sourcesContent":["<template>\r\n\r\n    <div>\r\n        <div style=\"border: 5px solid transparent;\" v-show=\"showcam\">\r\n            <b-button size=\"sm\" variant=\"info\" @click=\"onCameraChange\" class=\"btn-cams\" :disabled=\"!canChangeCam\"><b-icon-camera/></b-button>\r\n            <b-button size=\"sm\" variant=\"warning\" class=\"btn-torch\"><b-icon :icon=\"icon\"/></b-button>\r\n            <qrcode-stream :camera=\"cameras.selected\" @init=\"onInit\" @decode=\"onDecode\">\r\n                <b-icon-check2-circle v-show=\"readok\" class=\"readok\"/>\r\n            </qrcode-stream>\r\n        </div>\r\n\r\n        <div class=\"pt-2 pb-2\" v-show=\"!showcam\">\r\n            <SearchApi id=\"input-func\" pkid=\"searchFunc\" route=\"Servicos/Funcionarios/Select\" title=\"Funcionário\" v-model=\"func\"/> \r\n        </div>\r\n\r\n        <!-- <b-button block variant=\"primary\" @click=\"showcam = !showcam\" class=\"mt-2 mb-3\">{{ captionButton }}</b-button> -->\r\n        <b-button block variant=\"primary\" @click=\"showcam = !showcam\" class=\"mt-2 mb-3\">{{ captionButton }}</b-button>\r\n        \r\n        <!-- cameras:\r\n        {{ cameras }}<br>\r\n        canChangeCam: {{ canChangeCam }}<br>\r\n        icon: {{ icon }}<br>\r\n        testes: {{ testes }} -->\r\n        \r\n\r\n    </div>\r\n    \r\n</template>\r\n\r\n<script>\r\nimport { mapActions, mapGetters } from 'vuex'\r\nimport SearchApi from '../../../components/SearchApi'\r\nexport default {\r\n    \r\n    name: 'QrcodeFunc',\r\n\r\n    data() {\r\n        return {\r\n            func: {value: '-', text: ''},\r\n            showcam: true,\r\n            testes: '',\r\n            cameras: {\r\n                noRearCamera: false,\r\n                noFrontCamera: false,\r\n                torchNotSupported: false,\r\n                torchActive: false,\r\n                config: null,\r\n                selected: 'auto',\r\n                data: []\r\n            }\r\n        }\r\n    },\r\n\r\n    components: {\r\n\r\n        SearchApi\r\n    \r\n    },\r\n\r\n    computed: {\r\n\r\n        ...mapGetters(['gtxfuncData']),\r\n\r\n        canChangeCam() {\r\n            return (this.cameras.data.length>1)\r\n        },\r\n\r\n        captionButton() {\r\n            return (this.showcam) ? 'Pesquisar funcionário' : 'Ler QRCode'\r\n        },\r\n\r\n        readok() {\r\n            return (this.cameras.selected == 'off')\r\n        },\r\n\r\n        icon() {\r\n            return (this.torchActive) ? 'lightning' : 'lightning-fill'\r\n        }\r\n\r\n    },\r\n\r\n    methods: {\r\n\r\n        ...mapActions(['actfuncbuscar']),\r\n\r\n        limpaBusca() {\r\n            this.func = {value: '-', text: ''}\r\n        },\r\n\r\n        async onDecode(decodedString) {\r\n\r\n            if (decodedString.length == 36) {\r\n    \r\n                this.cameras.selected = 'off'\r\n                await this.timeout(800)\r\n                this.cameras.selected = 'auto'\r\n    \r\n                this.buscaFunc(decodedString)\r\n            }\r\n        },\r\n\r\n        onCameraChange () {\r\n\r\n            if ((!this.cameras.noFrontCamera) && (this.cameras.selected !== 'front')) {\r\n                this.cameras.selected = 'front'\r\n            } else {\r\n                if ((!this.cameras.noRearCamera) && (this.cameras.selected !== 'rear')) {\r\n                    this.cameras.selected = 'rear'\r\n                } else {\r\n                    this.cameras.selected = 'auto'\r\n                }\r\n            }\r\n           \r\n\r\n        },\r\n\r\n        onInit (promise) {\r\n            promise.then(cams => {\r\n                if (this.cameras.data.length == 0) this.cameras.data = cams.capabilities.facingMode.map(c => {return {value: c, text: c}})\r\n                this.torchActive = !cams.capabilities.torch\r\n\r\n                // console.log('cameras:', this.cameras)\r\n            })\r\n            promise.catch(error => {\r\n                const cameraMissingError = error.name === 'OverconstrainedError'\r\n                const triedRearCamera = this.cameras.selected === 'rear'\r\n                const triedFrontCamera = this.cameras.selected === 'front'\r\n\r\n                if (triedRearCamera && cameraMissingError) {\r\n                    this.cameras.noRearCamera = true\r\n                }\r\n\r\n                if (triedFrontCamera && cameraMissingError) {\r\n                    this.cameras.noFrontCamera = true\r\n                }\r\n            })\r\n        },\r\n\r\n        buscaFunc(busca) {\r\n            let params = {\r\n                pesquisa: (typeof(busca)=='object') ? busca.value : busca\r\n            }\r\n            this.$emit('evt-busca', params)\r\n        },\r\n\r\n        cameraOk(cam) {\r\n\r\n        },\r\n\r\n        async timeout (ms) {\r\n            return new Promise(resolve => {\r\n                window.setTimeout(resolve, ms)\r\n            })\r\n        }\r\n\r\n    },\r\n\r\n    watch: {\r\n        func(func) {\r\n            // console.log('func:', func)\r\n            if (this.func.value !== '-') this.buscaFunc(func)\r\n        }\r\n    }\r\n    \r\n}\r\n</script>\r\n\r\n<style scoped>\r\n    .readok {\r\n        color: lime;\r\n        width: 130px;\r\n        height: 130px;\r\n        position: relative;\r\n        margin: 0 auto;\r\n        top: 50%;\r\n        left: 50%;\r\n        transform: translate(-50%, -50%);\r\n    }\r\n    .btn-cams {\r\n        position: absolute;\r\n        z-index: 9;\r\n        right: 0;\r\n        margin-top: 2px;\r\n        margin-right: 22px;       \r\n    }\r\n    .btn-torch {\r\n        position: absolute;\r\n        z-index: 9;\r\n        right: 0;\r\n        margin-top: 2px;\r\n        margin-right: 64px;       \r\n    }\r\n</style>"]}]}