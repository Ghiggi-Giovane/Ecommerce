{"remainingRequest":"C:\\k1-services\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\k1-services\\src\\pages\\ecommerce\\views\\Docas.vue?vue&type=style&index=0&id=46fb8374&scoped=true&lang=css&","dependencies":[{"path":"C:\\k1-services\\src\\pages\\ecommerce\\views\\Docas.vue","mtime":1670977910622},{"path":"C:\\k1-services\\node_modules\\css-loader\\dist\\cjs.js","mtime":1670977934642},{"path":"C:\\k1-services\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":1670977935796},{"path":"C:\\k1-services\\node_modules\\postcss-loader\\src\\index.js","mtime":1670977935130},{"path":"C:\\k1-services\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1670977934221},{"path":"C:\\k1-services\\node_modules\\vue-loader\\lib\\index.js","mtime":1670977935327}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoNCi5kb2Mgew0KICBkaXNwbGF5OiBmbGV4Ow0KICBhbGlnbi1pdGVtczogY2VudGVyOw0KICBmbGV4LXdyYXA6IG5vd3JhcDsNCiAganVzdGlmeS1jb250ZW50OiBzcGFjZS1iZXR3ZWVuOw0KfQ0KDQouZ2FsbGVyeXBhbmVsIHsNCiAgbWluLXdpZHRoOiAyNTBweDsNCiAgbWluLWhlaWdodDogMjIwcHg7DQogIG1hcmdpbi1sZWZ0OiAwICFpbXBvcnRhbnQ7DQp9DQoubG9jayB7DQogIHBvc2l0aW9uOiByZWxhdGl2ZTsNCiAgdG9wOiAtMjhweDsNCiAgZmxvYXQ6IHJpZ2h0Ow0KfQ0KLmhhbmQgew0KICBjdXJzb3I6IHBvaW50ZXI7DQp9DQouY291bnRlciB7DQogIC8qIGJhY2tncm91bmQtY29sb3I6IGRhcmtyZWQ7ICovDQogIC13ZWJraXQtdHJhbnNpdGlvbjogLXdlYmtpdC10cmFuc2Zvcm0gMC41cyBlYXNlLWluLW91dDsNCiAgLW1zLXRyYW5zaXRpb246IC1tcy10cmFuc2Zvcm0gMC41cyBlYXNlLWluLW91dDsNCiAgdHJhbnNpdGlvbjogYmFja2dyb3VuZC1jb2xvciAwLjVzIGVhc2UtaW4tb3V0Ow0KICAvKiBjb2xvcjogd2hpdGVzbW9rZTsgKi8NCiAgcGFkZGluZzogMjBweCAwOw0KICBib3JkZXItcmFkaXVzOiA1cHg7DQogIG9wYWNpdHk6IDAuODU7DQogIC8qIGJvcmRlcjogMnB4IHNvbGlkIGZpcmVicmljazsgKi8NCn0NCg=="},{"version":3,"sources":["Docas.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA+bA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Docas.vue","sourceRoot":"src/pages/ecommerce/views","sourcesContent":["<template>\r\n  <div>\r\n    <section id=\"docasDepositos\">\r\n      <b-card class=\"ml-4 mr-4 mt-4\">\r\n        <div class=\"doc\">\r\n          <h3>Docas</h3>\r\n          <!-- <div>\r\n            <h4 class=\"iconbutton\" @click=\"showModalDocas\">\r\n              <b-icon-plus-square></b-icon-plus-square>\r\n            </h4>\r\n          </div>-->\r\n        </div>\r\n\r\n        <b-table\r\n          no-footer-sorting\r\n          id=\"table-docas\"\r\n          head-variant=\"dark\"\r\n          sort-desc\r\n          selectable\r\n          striped\r\n          bordered\r\n          hovers\r\n          responsive=\"sm\"\r\n          small\r\n          select-mode=\"single\"\r\n          :items=\"docas\"\r\n          :fields=\"docasFields\"\r\n          @row-selected=\"onRowSelectedDocas\"\r\n        >\r\n          <template #cell(Transportadoras)=\"row\">\r\n            <div class=\"text-center\">\r\n              <b-icon-pencil\r\n                scale=\"1.5\"\r\n                @click=\"showModalTransportadoras(row.item)\"\r\n              ></b-icon-pencil>\r\n            </div>\r\n          </template>\r\n        </b-table>\r\n      </b-card>\r\n\r\n      <hr />\r\n\r\n      <b-card class=\"ml-4 mr-4 mt-4\" v-if=\"depositos.length > 0\">\r\n        <div class=\"doc\">\r\n          <h3>Depósitos</h3>\r\n        </div>\r\n        <b-table\r\n          no-footer-sorting\r\n          id=\"table-depositos\"\r\n          head-variant=\"dark\"\r\n          sort-desc\r\n          selectable\r\n          striped\r\n          bordered\r\n          hovers\r\n          responsive\r\n          small\r\n          select-mode=\"single\"\r\n          :items=\"depositos\"\r\n          :fields=\"depositosFields\"\r\n          @row-selected=\"onRowSelectedDepositos\"\r\n        ></b-table>\r\n      </b-card>\r\n      <hr />\r\n      <b-card class=\"ml-4 mr-4 mt-4\" v-if=\"selectedDeposito != null\">\r\n        <div class=\"doc\">\r\n          <h3>Itens por depósito</h3>\r\n\r\n          <div>\r\n            <b-row style=\"align-items: baseline\">\r\n              <span class=\"mr-4\">\r\n                Qtde de itens no depósito:\r\n                <strong>{{ depositosItens.length }}</strong>\r\n              </span>\r\n              <b-form-input\r\n                style=\"width: 200px\"\r\n                v-model=\"filtroItens\"\r\n                placeholder=\"Item\"\r\n              ></b-form-input>\r\n              <h4 class=\"iconbutton mr-2\" @click=\"saveItens(depositosItens)\">\r\n                <b-icon-check2-square variant=\"success\"></b-icon-check2-square>\r\n              </h4>\r\n\r\n              <h4 class=\"iconbutton mr-2\" @click=\"showModalItens\">\r\n                <b-icon-plus-square variant=\"success\"></b-icon-plus-square>\r\n              </h4>\r\n            </b-row>\r\n          </div>\r\n        </div>\r\n        <b-table\r\n          no-footer-sorting\r\n          id=\"table-depositos-itens\"\r\n          head-variant=\"dark\"\r\n          sort-desc\r\n          selectable\r\n          striped\r\n          bordered\r\n          hovers\r\n          responsive\r\n          small\r\n          select-mode=\"single\"\r\n          :items=\"depositosItens\"\r\n          :fields=\"itensFields\"\r\n          :filter=\"filtroItens\"\r\n          :filter-included-fields=\"filterOn\"\r\n        >\r\n          <template #cell(Estoque)=\"row\">\r\n            <div>\r\n              <b-form-input\r\n                id=\"descricao-input\"\r\n                v-model=\"row.item.Estoque\"\r\n                required\r\n                :disabled=\"\r\n                  selectedDeposito == null ||\r\n                    selectedDeposito.ParEmpDepositoId != null\r\n                \"\r\n              ></b-form-input>\r\n            </div>\r\n          </template>\r\n          <template #cell(UltimaAtualizacao)=\"row\">{{\r\n            new Date(row.item.UltimaAtualizacao).toLocaleDateString()\r\n          }}</template>\r\n\r\n          <template #cell(actions)=\"row\" class=\"text-center\">\r\n            <a class=\"text-center\">\r\n              <b-icon-pencil\r\n                font-scale=\"1.5\"\r\n                @click=\"saveNewStoque(row.item)\"\r\n              ></b-icon-pencil>\r\n            </a>\r\n          </template>\r\n        </b-table>\r\n      </b-card>\r\n    </section>\r\n\r\n    <!--  MODAIS -->\r\n    <b-modal\r\n      centered\r\n      id=\"modal-itens\"\r\n      ref=\"modal\"\r\n      title=\"Adicionar nova Referência\"\r\n      @show=\"resetModal\"\r\n      @hidden=\"resetModal\"\r\n      @ok=\"handleOk\"\r\n    >\r\n      <form ref=\"form\" @submit.stop.prevent=\"handleSubmit\">\r\n        <b-form-tags\r\n          input-id=\"tags-pills\"\r\n          v-model=\"referencia\"\r\n          tag-variant=\"primary\"\r\n          tag-pills\r\n          size=\"sm\"\r\n          separator=\",  \"\r\n          placeholder=\"Separe as referências com espaço ou vírgula.\"\r\n          required\r\n        ></b-form-tags>\r\n      </form>\r\n    </b-modal>\r\n\r\n    <b-modal\r\n      centered\r\n      id=\"Transportadoras\"\r\n      ref=\"modal2\"\r\n      title=\"Cadastro de Transportadoras / Redespacho\"\r\n      size=\"xl\"\r\n      @ok=\"handleOkTr\"\r\n    >\r\n      <b-row>\r\n        <b-col><span>Transportadora</span></b-col>\r\n        <b-col><span>Transportadora do Pedido</span></b-col>\r\n        <b-col><span>Transportadora de Redespacho</span></b-col>\r\n      </b-row>\r\n      <b-row\r\n        v-for=\"(input, index) in this.transportadoras\"\r\n        :key=\"index\"\r\n        class=\"mb-1\"\r\n      >\r\n        <b-col>\r\n          <b-form-input\r\n            placeholder=\"Transportadora\"\r\n            id=\"Transportadora\"\r\n            v-model=\"input.Transportadora\"\r\n            required\r\n          ></b-form-input>\r\n        </b-col>\r\n        <b-col>\r\n          <b-form-input\r\n            placeholder=\"Transportadora Pedido\"\r\n            id=\"TranspPedido\"\r\n            v-model=\"input.TranspPedido\"\r\n            required\r\n          ></b-form-input>\r\n        </b-col>\r\n        <b-col>\r\n          <b-form-input\r\n            placeholder=\"Transportadora Redespacho\"\r\n            id=\"TranspRedespacho\"\r\n            v-model=\"input.TranspRedespacho\"\r\n            required\r\n          ></b-form-input>\r\n        </b-col>\r\n      </b-row>\r\n\r\n      <div class=\"text-center\">\r\n        <b-button @click=\"newInput\">Novo</b-button>\r\n      </div>\r\n    </b-modal>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport ApiService from \"../../../services/api.service\";\r\n\r\nexport default {\r\n  name: \"Docas\",\r\n  components: {},\r\n  data() {\r\n    return {\r\n      transportadoras: [],\r\n\r\n      docas: [],\r\n      depositos: [],\r\n      depositosItens: [],\r\n      selectedDeposito: null,\r\n      selectedDoca: null,\r\n      alteraEstoque: false,\r\n      filtroItens: \"\",\r\n      filterOn: [\"Item\"],\r\n\r\n      referencia: [],\r\n\r\n      docasFields: [\r\n        { key: \"Descricao\", sortable: true, label: \"Descrição\", visible: true },\r\n        {\r\n          key: \"PrazoDias\",\r\n          sortable: true,\r\n          label: \"Prazo em dias\",\r\n          visible: true,\r\n        },\r\n        {\r\n          key: \"ParEmpDepositoId\",\r\n          sortable: true,\r\n          label: \"ID deposito Interno\",\r\n          visible: true,\r\n        },\r\n        {\r\n          key: \"Transportadoras\",\r\n          sortable: true,\r\n          label: \"Transportadoras / Redespacho\",\r\n          visible: true,\r\n        },\r\n      ],\r\n      depositosFields: [\r\n        { key: \"Descricao\", sortable: true, label: \"Descrição\", visible: true },\r\n        {\r\n          key: \"ParEmpDepositoId\",\r\n          sortable: true,\r\n          label: \"ID deposito Interno\",\r\n          visible: true,\r\n        },\r\n        {\r\n          key: \"PrazoDias\",\r\n          sortable: true,\r\n          label: \"Prazo em dias\",\r\n          visible: true,\r\n        },\r\n      ],\r\n      itensFields: [\r\n        { key: \"Item\", sortable: true, visible: true },\r\n        {\r\n          key: \"Estoque\",\r\n          sortable: true,\r\n          visible: true,\r\n        },\r\n      ],\r\n    };\r\n  },\r\n\r\n  created() {\r\n    this.loadDocas();\r\n  },\r\n\r\n  methods: {\r\n    selecionado(Id) {\r\n      this.selectedOption = Id;\r\n\r\n      if (Id == 2) {\r\n        this.itensLoad();\r\n      }\r\n    },\r\n\r\n    async saveItens(item) {\r\n      await ApiService.post(\"v2/IntranetEcommerceB2C/DepositosItens/Save\", {\r\n        item,\r\n      })\r\n        .then((res) => {\r\n          this.$root.toastsuccess(\"Salvo com Sucesso!\");\r\n        })\r\n        .catch((e) => {\r\n          this.$root.toastdanger(\"Erro! \" + e);\r\n        });\r\n\r\n      this.depositosItensLoad(this.selectedDeposito.Id);\r\n    },\r\n\r\n    async loadDocas() {\r\n      await ApiService.get(\"v2/IntranetEcommerceB2C/Docas/Get\").then(\r\n        (result) => {\r\n          if (result.data.Success == true) {\r\n            this.docas = result.data.Data;\r\n          } else {\r\n            return;\r\n          }\r\n        }\r\n      );\r\n    },\r\n\r\n    onRowSelectedDocas(items) {\r\n      // console.log(items[0].Id);\r\n      this.selectedDoca = items[0].Id;\r\n\r\n      this.depositos = [];\r\n      this.depositosItens = [];\r\n      this.selectedDeposito = null;\r\n\r\n      this.depositosLoad(items[0].Id);\r\n    },\r\n    onRowSelectedDepositos(items) {\r\n      // console.log(items[0].Id);\r\n      this.depositosItens = [];\r\n      //this.selectedDeposito.ParEmpDepositoId = items[0].ParEmpDepositoId != null;\r\n      this.selectedDeposito = items[0];\r\n      this.depositosItensLoad(this.selectedDeposito.Id);\r\n    },\r\n\r\n    async depositosLoad(Id) {\r\n      await ApiService.post(\"v2/IntranetEcommerceB2C/Depositos/Get\", {\r\n        id: Id,\r\n      }).then((result) => {\r\n        if (result.data.Success == true) {\r\n          this.depositos = result.data.Data;\r\n        }\r\n      });\r\n    },\r\n\r\n    depositosItensLoad(Id) {\r\n      ApiService.post(\"v2/IntranetEcommerceB2C/DepositosItens/Get\", {\r\n        id: Id,\r\n      }).then((result) => {\r\n        if (result.data.Success == true) {\r\n          this.depositosItens = result.data.Data;\r\n        }\r\n      });\r\n    },\r\n\r\n    /* Modais */\r\n    showModalItens() {\r\n      this.$root.$emit(\"bv::show::modal\", \"modal-itens\", \"#btnShow\");\r\n    },\r\n    resetModal() {\r\n      this.referencia = [];\r\n    },\r\n    handleOk(bvModalEvent) {\r\n      // Prevent modal from closing\r\n      bvModalEvent.preventDefault();\r\n      // Trigger submit handler\r\n      this.handleSubmit();\r\n    },\r\n    async handleSubmit() {\r\n      var item = [];\r\n      // Exit when the form isn't valid\r\n      if (this.referencia.length > 0) {\r\n        this.referencia.forEach((ref) => {\r\n          item.push({\r\n            DepositoId: this.selectedDeposito.Id,\r\n            Item: ref,\r\n            Estoque: 0,\r\n          });\r\n        });\r\n        this.saveItens(item);\r\n      }\r\n\r\n      this.$nextTick(() => {\r\n        this.$bvModal.hide(\"modal-itens\");\r\n      });\r\n    },\r\n    showModalTransportadoras(itens) {\r\n      console.log(itens);\r\n      this.transportadoras = [];\r\n      this.transportadoras = itens.Transportadoras;\r\n\r\n      this.$root.$emit(\r\n        \"bv::show::modal\",\r\n        \"Transportadoras\",\r\n        \"#btnShow\",\r\n        itens.Id\r\n      );\r\n    },\r\n\r\n    handleOkTr() {\r\n      if (this.transportadoras == null) {\r\n        return;\r\n      } else if (\r\n        this.transportadoras[this.transportadoras.length - 1].TranspPedido\r\n          .length == 0 ||\r\n        this.transportadoras[this.transportadoras.length - 1].Transportadora\r\n          .length == 0\r\n      ) {\r\n        return;\r\n      } else {\r\n        this.handleSubmitTr();\r\n      }\r\n    },\r\n\r\n    async handleSubmitTr() {\r\n      console.log(this.transportadoras);\r\n\r\n      // envia para salvar\r\n      ApiService.post(\"v2/IntranetEcommerceB2C/DocasTranspRedespacho/Save\", {\r\n        Redespachos: this.transportadoras,\r\n        DocaId: this.selectedDoca,\r\n      }).then((res) => {\r\n        this.docas.find(\r\n          (id) => id.Id == this.selectedDoca\r\n        ).Transportadoras = res.data.Data;\r\n      });\r\n\r\n      this.$nextTick(() => {\r\n        this.$bvModal.hide(\"Transportadoras\");\r\n      });\r\n    },\r\n\r\n    newInput() {\r\n      if (this.transportadoras == null) this.transportadoras = [];\r\n      this.transportadoras.push({\r\n        Id: \"\",\r\n        DocaId: this.selectedDoca,\r\n        Transportadora: \"\",\r\n        TranspPedido: \"\",\r\n        TranspRedespacho: \"\",\r\n      });\r\n    },\r\n  },\r\n};\r\n</script>\r\n\r\n<style scoped>\r\n.doc {\r\n  display: flex;\r\n  align-items: center;\r\n  flex-wrap: nowrap;\r\n  justify-content: space-between;\r\n}\r\n\r\n.gallerypanel {\r\n  min-width: 250px;\r\n  min-height: 220px;\r\n  margin-left: 0 !important;\r\n}\r\n.lock {\r\n  position: relative;\r\n  top: -28px;\r\n  float: right;\r\n}\r\n.hand {\r\n  cursor: pointer;\r\n}\r\n.counter {\r\n  /* background-color: darkred; */\r\n  -webkit-transition: -webkit-transform 0.5s ease-in-out;\r\n  -ms-transition: -ms-transform 0.5s ease-in-out;\r\n  transition: background-color 0.5s ease-in-out;\r\n  /* color: whitesmoke; */\r\n  padding: 20px 0;\r\n  border-radius: 5px;\r\n  opacity: 0.85;\r\n  /* border: 2px solid firebrick; */\r\n}\r\n</style>\r\n"]}]}