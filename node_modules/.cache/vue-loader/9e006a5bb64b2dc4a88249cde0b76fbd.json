{"remainingRequest":"C:\\k1-services\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\k1-services\\src\\pages\\nfe\\views\\nfe.vue?vue&type=style&index=0&id=5b7143d6&scoped=true&lang=css&","dependencies":[{"path":"C:\\k1-services\\src\\pages\\nfe\\views\\nfe.vue","mtime":1701906516501},{"path":"C:\\k1-services\\node_modules\\css-loader\\dist\\cjs.js","mtime":1670977934642},{"path":"C:\\k1-services\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":1674603024162},{"path":"C:\\k1-services\\node_modules\\postcss-loader\\src\\index.js","mtime":1670977935130},{"path":"C:\\k1-services\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1670977934221},{"path":"C:\\k1-services\\node_modules\\vue-loader\\lib\\index.js","mtime":1674603023821}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKDQoudHJ1bmMgew0KICBtYXgtd2lkdGg6IDMwMHB4Ow0KICAtd2Via2l0LWxpbmUtY2xhbXA6IDI7DQogIC13ZWJraXQtYm94LW9yaWVudDogdmVydGljYWw7DQogIG92ZXJmbG93OiBoaWRkZW47DQogIHRleHQtb3ZlcmZsb3c6IGVsbGlwc2lzOw0KICBkaXNwbGF5OiAtd2Via2l0LWJveDsNCn0NCg=="},{"version":3,"sources":["nfe.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA6kBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"nfe.vue","sourceRoot":"src/pages/nfe/views","sourcesContent":["<template>\r\n  <div>\r\n    <CardCollapsed\r\n      ref=\"CardCollapsed\"\r\n      v-model=\"collapseformopen\"\r\n      title=\"Notas fiscais de entrada\"\r\n      @evtBusca=\"buscanfe\"\r\n    >\r\n      <template #collapsedform>\r\n        <div class=\"bg-light p-4\">\r\n          <b-row>\r\n            <b-col cols=\"12\" md=\"4\">\r\n              <b-form-group label=\"Depósito\" label-for=\"deposito\">\r\n                <b-form-select\r\n                  id=\"deposito\"\r\n                  v-model=\"deposito\"\r\n                  :options=\"paremp_depositos\"\r\n                ></b-form-select>\r\n              </b-form-group>\r\n            </b-col>\r\n            <b-col cols=\"12\" md=\"2\">\r\n              <b-form-group label=\"Data de Emissão\" label-for=\"form-database\">\r\n                <b-form-datepicker\r\n                  id=\"form-database\"\r\n                  v-model=\"database\"\r\n                  class=\"mb-2\"\r\n                  locale=\"pt\"\r\n                  size=\"sm\"\r\n                  :date-format-options=\"gtxConfigDatetimePickerFormat\"\r\n                ></b-form-datepicker>\r\n              </b-form-group>\r\n            </b-col>\r\n            <b-col cols=\"12\" md=\"2\">\r\n              <b-form-group label=\"Número Nota\" label-for=\"numero\">\r\n                <b-form-input\r\n                  id=\"numero\"\r\n                  type=\"number\"\r\n                  v-model=\"numero\"\r\n                ></b-form-input>\r\n              </b-form-group>\r\n            </b-col>\r\n            <b-col cols=\"12\" md=\"2\">\r\n              <b-form-group label=\"Série\" label-for=\"serie\">\r\n                <b-form-input\r\n                  id=\"serie\"\r\n                  type=\"number\"\r\n                  v-model=\"serie\"\r\n                ></b-form-input>\r\n              </b-form-group>\r\n            </b-col>\r\n            <b-col cols=\"12\" md=\"2\">\r\n              <b-form-group label=\"Natureza\" label-for=\"natureza\">\r\n                <b-form-input\r\n                  id=\"serie\"\r\n                  type=\"number\"\r\n                  v-model=\"codigo_natureza\"\r\n                ></b-form-input>\r\n              </b-form-group>\r\n            </b-col>\r\n          </b-row>\r\n          <b-row>\r\n            <b-col>\r\n              <b-form-group label=\"Nome Fornecedor\" label-for=\"nomefornec\">\r\n                <b-form-input\r\n                  id=\"nomefornec\"\r\n                  type=\"text\"\r\n                  v-model=\"nomefornec\"\r\n                ></b-form-input>\r\n              </b-form-group>\r\n            </b-col>\r\n          </b-row>\r\n          <b-row>\r\n            <b-col>\r\n              <b-form-group label=\"Chave DANFE\" label-for=\"chaveacesso\">\r\n                <b-form-input\r\n                  id=\"chaveacesso\"\r\n                  type=\"number\"\r\n                  v-model=\"chaveacesso\"\r\n                ></b-form-input>\r\n              </b-form-group>\r\n            </b-col>\r\n          </b-row>\r\n          <b-row>\r\n            <b-col class=\"text-right\">\r\n              <b-button variant=\"primary\" @click=\"buscanfe\">Buscar</b-button>\r\n            </b-col>\r\n          </b-row>\r\n          <!--\r\n        <b-row>\r\n          <b-col>\r\n            gtxParempEmpresaSelecionada: {{ gtxParempEmpresaSelecionada }}\r\n            <json-viewer\r\n                :value=\"gtxParempDataDepositos(gtxParempEmpresaSelecionada)\"\r\n                :expand-depth=\"5\"\r\n                copyable\r\n                boxed\r\n                sort\r\n              ></json-viewer>\r\n          </b-col>\r\n        </b-row>\r\n        --></div>\r\n      </template>\r\n\r\n      <template #collapsedbody>\r\n        <div>\r\n          <b-table\r\n            small\r\n            hover\r\n            striped\r\n            responsive\r\n            headerTitle=\"Extrato do Estoque\"\r\n            head-variant=\"dark\"\r\n            :items=\"tbl_nfe\"\r\n            :fields=\"nfe.fields\"\r\n          >\r\n            <template #cell(numero)=\"data\">\r\n              <span class=\"no-wrap\"\r\n                >{{ data.item.numero }}/{{ data.item.serie }}</span\r\n              >\r\n            </template>\r\n\r\n            <template #cell(fornecedor)=\"data\">\r\n              <span :title=\"data.item.fornecedor\"\r\n                >{{ data.item.fornecedor.substr(0, 15)\r\n                }}{{ data.item.fornecedor.substr(15) != \"\" ? \"...\" : \"\" }}</span\r\n              >\r\n            </template>\r\n\r\n            <template #cell(data_emissao)=\"data\">\r\n              <span>{{ data.item.data_emissao | dateBR }}</span>\r\n            </template>\r\n\r\n            <template #cell(data_entrada)=\"data\">\r\n              <span>{{ data.item.data_entrada | dateBR }}</span>\r\n            </template>\r\n\r\n            <template #cell(actions)=\"data\">\r\n              <span class=\"spaced\">\r\n                <b-button class=\"btn-icon\" variant=\"outline-primary\">\r\n                  <b-icon-clipboard-check\r\n                    @click=\"$root.copyclip(data.item.chaveacesso)\"\r\n                    title=\"Copiar Chave DANFE\"\r\n                  />\r\n                </b-button>\r\n                <b-button\r\n                  class=\"btn-icon\"\r\n                  variant=\"outline-primary\"\r\n                  @click=\"data.toggleDetails\"\r\n                >\r\n                  <b-icon-caret-down\r\n                    title=\"Ocultar produtos\"\r\n                    v-if=\"!data.detailsShowing\"\r\n                  />\r\n                  <b-icon-caret-up title=\"Ver produtos\" v-else />\r\n                </b-button>\r\n              </span>\r\n            </template>\r\n\r\n            <template #row-details=\"row\">\r\n              <b-card class=\"bg-light\">\r\n                <b-table\r\n                  small\r\n                  hover\r\n                  striped\r\n                  responsive\r\n                  headerTitle=\"Produtos\"\r\n                  class=\"mt-2\"\r\n                  :items=\"row.item.itens\"\r\n                  :fields=\"nfe.itens.fields\"\r\n                >\r\n                  <template #cell(actions)=\"data\" class=\"text-center\">\r\n                    <span class=\"spaced\">\r\n                      <b-button\r\n                        class=\"btn-icon\"\r\n                        title=\"Movimentar estoque\"\r\n                        size=\"sm\"\r\n                        style=\"font-size: 10px\"\r\n                        variant=\"success\"\r\n                        v-b-modal.modal-Movimentar\r\n                        :disabled=\"data.item.saldo_nota == 0\"\r\n                        @click=\"Movimentarshown(data.item)\"\r\n                      >\r\n                        <b-icon-cart-plus />\r\n                      </b-button>\r\n                      <b-button\r\n                        class=\"btn-icon\"\r\n                        title=\"Movimentar estoque\"\r\n                        size=\"sm\"\r\n                        style=\"font-size: 10px\"\r\n                        variant=\"success\"\r\n                        @click=\"onStockClick(data.item)\"\r\n                      >\r\n                        <b-icon-archive />\r\n                      </b-button>\r\n                    </span>\r\n                  </template>\r\n                </b-table>\r\n              </b-card>\r\n            </template>\r\n          </b-table>\r\n        </div>\r\n      </template>\r\n    </CardCollapsed>\r\n\r\n    <b-modal\r\n      id=\"modal-Movimentar\"\r\n      ref=\"modal-Movimentar\"\r\n      title=\"Movimentação de estoque\"\r\n      variant=\"dark\"\r\n      size=\"xl\"\r\n      hide-footer\r\n      centered\r\n    >\r\n      <b-row>\r\n        <b-col cols=\"12\">\r\n          <b-form-group label=\"Item\" label-for=\"input-itens\">\r\n            <SearchApi\r\n              id=\"input-itens\"\r\n              pkid=\"input-itensSearch\"\r\n              route=\"Servicos/Itens/MateriaPrima\"\r\n              v-model=\"itenssearch\"\r\n            />\r\n          </b-form-group>\r\n        </b-col>\r\n      </b-row>\r\n      <b-row>\r\n        <b-col cols=\"12\" md=\"4\">\r\n          <b-form-group label=\"Box\" label-for=\"input-box\">\r\n            <b-form-input\r\n              id=\"input-box\"\r\n              type=\"number\"\r\n              class=\"text-right\"\r\n              v-model=\"movimento.Box\"\r\n              debounce=\"1000\"\r\n            >\r\n            </b-form-input>\r\n          </b-form-group>\r\n        </b-col>\r\n\r\n        <b-col cols=\"12\" md=\"4\">\r\n          <b-form-group\r\n            :label=\"`Nível - ${movimento.Nivel}`\"\r\n            label-for=\"input-nivel\"\r\n          >\r\n            <b-form-input\r\n              id=\"input-nivel\"\r\n              type=\"range\"\r\n              min=\"1\"\r\n              max=\"5\"\r\n              class=\"text-right\"\r\n              v-model=\"movimento.Nivel\"\r\n              debounce=\"1000\"\r\n            >\r\n            </b-form-input>\r\n          </b-form-group>\r\n        </b-col>\r\n        <b-col cols=\"12\" sm=\"4\">\r\n          <b-form-group\r\n            label=\"Qtde Solicitada\"\r\n            label-for=\"input-qtdesolicitada\"\r\n          >\r\n            <b-form-input\r\n              id=\"input-qtdesolicitada\"\r\n              type=\"number\"\r\n              class=\"text-right\"\r\n              v-model=\"movimento.Qtde\"\r\n            >\r\n            </b-form-input>\r\n          </b-form-group>\r\n        </b-col>\r\n      </b-row>\r\n\r\n      <b-row>\r\n        <b-col><hr /></b-col>\r\n      </b-row>\r\n\r\n      <b-row>\r\n        <b-col class=\"text-right\">\r\n          <span class=\"spaced\">\r\n            <b-button\r\n              variant=\"primary\"\r\n              @click=\"movimentar\"\r\n              :disabled=\"!vmovimentar\"\r\n              >Salvar</b-button\r\n            >\r\n            <b-button variant=\"danger\" @click=\"$refs['modal-Movimentar'].hide()\"\r\n              >Cancelar</b-button\r\n            >\r\n          </span>\r\n        </b-col>\r\n      </b-row>\r\n    </b-modal>\r\n\r\n    <b-modal\r\n      id=\"modal-materiaisStock\"\r\n      ref=\"modal-materiaisStock\"\r\n      title=\"Movimentação de estoque\"\r\n      variant=\"dark\"\r\n      size=\"xl\"\r\n      hide-footer\r\n      centered\r\n      @shown=\"AlmoxarifadoMovimentacoesshown\"\r\n      @hidden=\"AlmoxarifadoMovimentacoeshidden\"\r\n    >\r\n      <!-- <GaiolasItensBusca :value=\"itembusca\" /> -->\r\n      <!--:value=\"itembusca\"-->\r\n      <!--@etv-gaiolasitensupdate=\"evtGaiolasItensUpdate\"/>-->\r\n      <AlmoxarifadoMovimentacoes\r\n        tipoMovimentacao=\"NFE\"\r\n        ref=\"AlmoxarifadoMovimentacoes\"\r\n      />\r\n    </b-modal>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { mapGetters } from \"vuex\";\r\nimport API from \"../../../services/api.service\";\r\nimport AlmoxarifadoMovimentacoes from \"../../almoxarifado/views/AlmoxarifadoMovimentacoes\";\r\nimport CardCollapsed from \"../../../components/CardCollapsed.vue\";\r\nimport SearchApi from \"../../../components/SearchApi.vue\";\r\n\r\nexport default {\r\n  name: \"Nfe\",\r\n\r\n  components: {\r\n    AlmoxarifadoMovimentacoes,\r\n    CardCollapsed,\r\n    SearchApi,\r\n  },\r\n\r\n  data() {\r\n    return {\r\n      itenssearch: { value: \"\", text: \"\" },\r\n      collapseformopen: false,\r\n      itensalmox: null,\r\n      empresa: this.gtxConfigParemp || 8,\r\n      deposito: null,\r\n      database: new Date(new Date().setDate(new Date().getDate() - 2)),\r\n      numero: null,\r\n      serie: null,\r\n      codigo_fornec: null,\r\n      nomefornec: null,\r\n      chaveacesso: null,\r\n      codigo_natureza: null,\r\n      paremp_depositos: [],\r\n      movimento: {\r\n        Empresa: null,\r\n        Deposito: null,\r\n        Item: \"\",\r\n        Box: 0,\r\n        Nivel: 1,\r\n        Entradas: 1,\r\n        Saidas: 2,\r\n        Saldo: 3,\r\n        QtdeSolicitada: 4,\r\n        Lote: 5,\r\n        Tipo: \"NFE\",\r\n        Qtde: 6,\r\n        Descricao: \"\",\r\n        DataMovimento: new Date(),\r\n        idItNFE: null,\r\n      },\r\n      nfe: {\r\n        currentPage: 1,\r\n        perPage: 20,\r\n        filter: \"\",\r\n        filterOn: [\"numero\", \"Fornecedor\", \"Valor\"],\r\n        fields: [\r\n          { key: \"numero\", label: \"Nota/Série\" },\r\n          { key: \"data_emissao\", label: \"Emissão\" },\r\n          { key: \"data_entrada\", label: \"Entrada\" },\r\n          \"fornecedor\",\r\n          { key: \"nitens\", label: \"Prod\" },\r\n          { key: \"qtde_nota\", label: \"Qtde\" },\r\n          { key: \"qtde_almox\", label: \"Lcto\" },\r\n          { key: \"qtde_saldo\", label: \"Saldo\" },\r\n          \"actions\",\r\n        ],\r\n        data: [],\r\n        itens: {\r\n          fields: [\r\n            \"item\",\r\n            { key: \"descricao\", label: \"Descrição\" },\r\n            \"un\",\r\n            { key: \"qtde_nota\", label: \"Qtde\" },\r\n            { key: \"qtde_almox\", label: \"Lcto\" },\r\n            { key: \"saldo_nota\", label: \"Saldo\" },\r\n            \"cubagem\",\r\n            \"actions\",\r\n          ],\r\n        },\r\n      },\r\n    };\r\n  },\r\n\r\n  beforeMount() {\r\n    this.buscaParempDeposito();\r\n\r\n    API.getLocalDBDocument(\"nfe\").then((doc) => {\r\n      if (doc) {\r\n        this.empresa = doc.data.empresa || [];\r\n        this.deposito = doc.data.deposito;\r\n        this.database = doc.data.database;\r\n        this.numero = doc.data.numero;\r\n        this.serie = doc.data.serie;\r\n        this.nomefornec = doc.data.nomefornec;\r\n        this.codigo_natureza = doc.data.codigo_natureza;\r\n        this.buscanfe();\r\n      } else {\r\n        this.buscanfe();\r\n      }\r\n    });\r\n  },\r\n\r\n  computed: {\r\n    ...mapGetters([\r\n      \"sysdevmode\",\r\n      \"gtxConfigDatetimePickerFormat\",\r\n      \"gtxParempEmpresaSelecionada\",\r\n      \"gtxParempDataDepositos\",\r\n      \"gtxConfigParemp\",\r\n    ]),\r\n    params() {\r\n      return {\r\n        empresa: this.gtxConfigParemp,\r\n        deposito: this.deposito,\r\n        database: this.database,\r\n        numero: this.numero,\r\n        serie: this.serie,\r\n        codigo_fornec: this.codigo_fornec,\r\n        nomefornec: this.nomefornec,\r\n        chaveacesso: this.chaveacesso,\r\n        codigo_natureza: this.codigo_natureza,\r\n      };\r\n    },\r\n    vmovimentar() {\r\n      return (\r\n        this.movimento.Empresa > 0 &&\r\n        this.movimento.Deposito > 0 &&\r\n        this.movimento.Box > 0 &&\r\n        this.movimento.Nivel > 0 &&\r\n        this.movimento.Item !== \"\" &&\r\n        this.movimento.Qtde > 0\r\n      );\r\n    },\r\n    tbl_nfe() {\r\n      return this.nfe.data.map((m) => ({\r\n        ...m,\r\n        nitens: m.itens.length,\r\n        qtde_nota: this.soma(m.itens, \"qtde_nota\"),\r\n        qtde_almox: this.soma(m.itens, \"qtde_almox\"),\r\n        qtde_saldo: this.soma(m.itens, \"saldo_nota\"),\r\n        _rowVariant:\r\n          this.soma(m.itens, \"qtde_nota\") == 0\r\n            ? \"success\"\r\n            : this.soma(m.itens, \"saldo_nota\") < this.soma(m.itens, \"qtde_nota\")\r\n            ? \"warning\"\r\n            : \"\",\r\n      }));\r\n    },\r\n  },\r\n\r\n  methods: {\r\n    //finds a specific item based on the provided ID and toggles details on that item\r\n    toggleDetails(row) {\r\n      if (row._showDetails) {\r\n        this.$set(row, \"_showDetails\", false);\r\n      } else {\r\n        this.currentItems.forEach((item) => {\r\n          this.$set(item, \"_showDetails\", false);\r\n        });\r\n\r\n        this.$nextTick(() => {\r\n          this.$set(row, \"_showDetails\", true);\r\n        });\r\n      }\r\n    },\r\n    buscanfe() {\r\n      API.get(\"v2/Servicos/NFE/Get\", this.params).then((res) => {\r\n        // console.log(\"buscanfe\", res.data);\r\n        if (res.data.Success) {\r\n          this.nfe.data = res.data.Data;\r\n          this.collapseformopen = false;\r\n          API.setLocalDBDocument({ data: this.$data }, \"nfe\");\r\n        } else {\r\n          this.nfe.data = [];\r\n          this.collapseformopen = true;\r\n        }\r\n      });\r\n    },\r\n    buscaParempDeposito() {\r\n      API.post(\"v2/Servicos/ParempDepositos/Get\", this.params).then((api) => {\r\n        console.log(api);\r\n        if (api.data.Success == \"True\" || api.data.Success) {\r\n          this.paremp_depositos = api.data.Data;\r\n        } else {\r\n          this.paremp_depositos = [];\r\n        }\r\n      });\r\n    },\r\n    soma(array, campo) {\r\n      return array.reduce((a, b) => a + b[campo], 0);\r\n    },\r\n    rowVariantSaldo(qtde_nota, saldo_nota) {\r\n      if (saldo_nota == 0) return \"success\";\r\n      // if (saldo_nota == qtde_nota) return \"danger\";\r\n      if (saldo_nota < qtde_nota) return \"warning\";\r\n    },\r\n    onStockClick(item) {\r\n      this.itensalmox = item;\r\n\r\n      this.$refs[\"modal-materiaisStock\"].show();\r\n\r\n      // this.$refs[\"AlmoxarifadoMovimentacoes\"].buscaindividual();\r\n    },\r\n    Movimentarshown(data) {\r\n      this.itenssearch = { value: data.item, text: data.item };\r\n      this.movimento.Empresa = this.empresa;\r\n      this.movimento.Deposito = 37; // TODO pegar do padrão\r\n      this.movimento.Box = 0;\r\n      this.movimento.Nivel = 1;\r\n      this.movimento.Item = data.item;\r\n      this.movimento.Descricao = data.descricao;\r\n      this.movimento.DataMovimento = new Date();\r\n      this.movimento.Qtde = data.saldo_nota;\r\n      this.movimento.Lote = data.idnfe;\r\n      this.movimento.Tipo = \"NFE\";\r\n      // this.movimento.idItNFE = data.id;\r\n\r\n      this.$refs[\"modal-Movimentar\"].show();\r\n    },\r\n    movimentar() {\r\n      API.post(\r\n        \"v2/Producao/Almoxarifado_Movimentacoes/Update\",\r\n        this.movimento\r\n      ).then((apidata) => {\r\n        console.log(\"movimentar.apidata:\", apidata);\r\n        if (apidata.data.Success) {\r\n          const res = API.prepareData(apidata.data);\r\n          console.log(\"atualiza.res:\", res);\r\n\r\n          const nfe = this.nfe.data.find((f) => f.id == res.data.Documento);\r\n          if (nfe) {\r\n            const item = nfe.itens.find((f) => f.item == res.data.Item);\r\n            if (item) {\r\n              item.qtde_almox += res.data.Qtde;\r\n              item.saldo_nota -= res.data.Qtde;\r\n              nfe._showDetails = true;\r\n              item._rowVariant =\r\n                item.qtde_nota == 0\r\n                  ? \"success\"\r\n                  : item.saldo_nota < item.qtde_nota\r\n                  ? \"warning\"\r\n                  : \"\";\r\n            }\r\n          }\r\n        } else {\r\n          this.$root.toastdanger(apidata.data.Error);\r\n        }\r\n        this.$refs[\"modal-Movimentar\"].hide();\r\n        // this.toggleDetails(item);\r\n      });\r\n    },\r\n    AlmoxarifadoMovimentacoesshown() {\r\n      // console.log(\"AlmoxarifadoMovimentacoesshown\", this.itensalmox);\r\n      this.$refs.AlmoxarifadoMovimentacoes.empresa = 8;\r\n      this.$refs.AlmoxarifadoMovimentacoes.deposito = 37;\r\n      this.$refs.AlmoxarifadoMovimentacoes.box = 0;\r\n      this.$refs.AlmoxarifadoMovimentacoes.nivel = 0;\r\n      this.$refs.AlmoxarifadoMovimentacoes.itens = [this.itensalmox.item];\r\n      this.$refs.AlmoxarifadoMovimentacoes.itensreq = [\r\n        {\r\n          item: this.itensalmox.item,\r\n          qtde: this.itensalmox.saldo_nota,\r\n          lote: this.itensalmox.idnfe,\r\n        },\r\n      ];\r\n\r\n      this.$refs.AlmoxarifadoMovimentacoes.busca();\r\n    },\r\n    AlmoxarifadoMovimentacoeshidden() {\r\n      // this.buscanfe();\r\n    },\r\n  },\r\n};\r\n</script>\r\n\r\n<style scoped>\r\n.trunc {\r\n  max-width: 300px;\r\n  -webkit-line-clamp: 2;\r\n  -webkit-box-orient: vertical;\r\n  overflow: hidden;\r\n  text-overflow: ellipsis;\r\n  display: -webkit-box;\r\n}\r\n</style>\r\n"]}]}