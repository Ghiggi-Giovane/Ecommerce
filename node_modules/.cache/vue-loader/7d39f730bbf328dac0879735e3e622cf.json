{"remainingRequest":"C:\\k1-services\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\k1-services\\src\\components\\SearchApi3.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\k1-services\\src\\components\\SearchApi3.vue","mtime":1670977910589},{"path":"C:\\k1-services\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1670977934221},{"path":"C:\\k1-services\\node_modules\\babel-loader\\lib\\index.js","mtime":1670977935138},{"path":"C:\\k1-services\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1670977934221},{"path":"C:\\k1-services\\node_modules\\vue-loader\\lib\\index.js","mtime":1670977935327}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KDQppbXBvcnQgQVBJIGZyb20gIi4uL3NlcnZpY2VzL2FwaS5zZXJ2aWNlIjsNCmltcG9ydCBUYWJsZUVkaXRBcGkgZnJvbSAiLi9UYWJsZUVkaXRBcGkudnVlIjsNCmV4cG9ydCBkZWZhdWx0IHsNCiAgbmFtZTogIlNlYXJjaEFQSTMiLA0KICBjb21wb25lbnRzOiB7DQogICAgVGFibGVFZGl0QXBpLA0KICB9LA0KICBwcm9wczogew0KICAgIHZhbHVlOiB7DQogICAgICB0eXBlOiBTdHJpbmcsDQogICAgICBkZWZhdWx0OiAiIiwNCiAgICB9LA0KICAgIHRpdGxlOiB7DQogICAgICB0eXBlOiBTdHJpbmcsDQogICAgICBkZWZhdWx0OiAiUGVzcXVpc2FyLi4uIiwNCiAgICB9LA0KICAgIHJvdXRlOiB7DQogICAgICB0eXBlOiBTdHJpbmcsDQogICAgICBkZWZhdWx0OiAiIiwNCiAgICB9LA0KICAgIGxvb2t1cDogew0KICAgICAgdHlwZTogT2JqZWN0LA0KICAgICAgZGVmYXVsdCgpIHsNCiAgICAgICAgcmV0dXJuIHsgdmFsdWU6ICJ2YWx1ZSIsIHRleHQ6ICJ0ZXh0IiB9Ow0KICAgICAgfSwNCiAgICB9LA0KICB9LA0KICBkYXRhKCkgew0KICAgIHJldHVybiB7DQogICAgICBzZWFyY2h2YWx1ZTogMCwNCiAgICAgIHNlYXJjaHRleHQ6IHRoaXMudmFsdWUgfHwgIiIsDQogICAgICBzZWFyY2hmbGRzOiB0aGlzLmxvb2t1cCwNCiAgICAgIGRhdGE6IFtdLA0KICAgICAgZGlydHk6IGZhbHNlLA0KICAgICAgbW9kYWxpZDogYG1vZGFsXyR7DQogICAgICAgIE1hdGgucmFuZG9tKDMyKQ0KICAgICAgICAgIC50b1N0cmluZygzMikNCiAgICAgICAgICAuc3BsaXQoIi4iKVsxXQ0KICAgICAgfWAsDQogICAgfTsNCiAgfSwNCiAgY29tcHV0ZWQ6IHsNCiAgICBwYXJhbXMoKSB7DQogICAgICByZXR1cm4gew0KICAgICAgICBwZXNxdWlzYTogdGhpcy5zZWFyY2h0ZXh0LA0KICAgICAgICBib2R5OiB0aGlzLnNlYXJjaHRleHQsDQogICAgICB9Ow0KICAgIH0sDQogICAgYXBpKCkgew0KICAgICAgcmV0dXJuIGBodHRwczovL2FwaS5ncnVwb2sxLmNvbS5ici9hcGkvdjIvJHt0aGlzLnJvdXRlfWA7DQogICAgfSwNCiAgfSwNCiAgbWV0aG9kczogew0KICAgIGJ1c2NhcigpIHsNCiAgICAgIC8qDQogICAgICBjb25zdCBkYXRhID0gew0KICAgICAgICBTdWNjZXNzOiB0cnVlLA0KICAgICAgICBEYXRhOiBbDQogICAgICAgICAgeyBtYXJjYTogIklERUxMSSIsIGlkOiAyIH0sDQogICAgICAgICAgeyBtYXJjYTogIk1ZIEhPTUUiLCBpZDogNiB9LA0KICAgICAgICBdLA0KICAgICAgfTsNCiAgICAgIHRoaXMuZGF0YSA9IGRhdGEuRGF0YTsNCiAgICAgIGlmICh0aGlzLmRhdGEubGVuZ3RoID09IDEpIHsNCiAgICAgICAgdGhpcy5zZWxlY3RkYXRhKHRoaXMuZGF0YSk7DQogICAgICB9IGVsc2Ugew0KICAgICAgICB0aGlzLiRidk1vZGFsLnNob3codGhpcy5tb2RhbGlkKTsNCiAgICAgIH0NCiAgICAgICovDQogICAgICBpZiAodGhpcy5kaXJ0eSkgew0KICAgICAgICBBUEkucG9zdCh0aGlzLnJvdXRlLCB0aGlzLnBhcmFtcykudGhlbigocmVzKSA9PiB7DQogICAgICAgICAgaWYgKHJlcy5kYXRhLlN1Y2Nlc3MpIHsNCiAgICAgICAgICAgIHRoaXMuZGF0YSA9IHJlcy5kYXRhLkRhdGE7DQogICAgICAgICAgICBpZiAodGhpcy5kYXRhLmxlbmd0aCA9PSAxKSB7DQogICAgICAgICAgICAgIHRoaXMuc2VsZWN0ZGF0YSh0aGlzLmRhdGEpOw0KICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgdGhpcy4kYnZNb2RhbC5zaG93KHRoaXMubW9kYWxpZCk7DQogICAgICAgICAgICB9DQogICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgIHRoaXMuZGF0YSA9IFtdOw0KICAgICAgICAgIH0NCiAgICAgICAgfSk7DQogICAgICB9DQogICAgfSwNCiAgICBldnRzZWxlY3QoZGF0YSkgew0KICAgICAgY29uc29sZS5sb2coImV2dHNlbGVjdDoiLCBkYXRhKTsNCiAgICAgIHRoaXMuc2VsZWN0ZGF0YShkYXRhKTsNCiAgICAgIHRoaXMuJGJ2TW9kYWwuaGlkZSh0aGlzLm1vZGFsaWQpOw0KICAgIH0sDQogICAgZXZ0cGFnZShkYXRhKSB7DQogICAgICBjb25zb2xlLmxvZygiZXZ0cGFnZToiLCBkYXRhKTsNCiAgICB9LA0KICAgIHNlbGVjdGRhdGEoZGF0YSkgew0KICAgICAgdGhpcy5zZWFyY2h2YWx1ZSA9IGRhdGFbMF1bdGhpcy5zZWFyY2hmbGRzLnZhbHVlXS50b1N0cmluZygpOw0KICAgICAgdGhpcy5zZWFyY2h0ZXh0ID0gZGF0YVswXVt0aGlzLnNlYXJjaGZsZHMudGV4dF07DQogICAgICB0aGlzLiRlbWl0KCJpbnB1dCIsIHRoaXMuc2VhcmNodmFsdWUpOw0KICAgICAgdGhpcy5kaXJ0eSA9IGZhbHNlOw0KICAgIH0sDQogIH0sDQogIHdhdGNoOiB7DQogICAgc2VhcmNodGV4dCh0ZXh0KSB7DQogICAgICB0aGlzLmRpcnR5ID0gdHJ1ZTsNCiAgICAgIGlmICh0ZXh0ID09ICIiKSB0aGlzLnNlYXJjaHZhbHVlID0gIjAiOw0KICAgIH0sDQogIH0sDQp9Ow0K"},{"version":3,"sources":["SearchApi3.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAsCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"SearchApi3.vue","sourceRoot":"src/components","sourcesContent":["<template>\r\n  <div>\r\n    <!-- TODO:\r\n    1-resolver a questão da prop value poder ser any pois vai ter casos onde deverá ser atribuído valores numéricos e string\r\n    -->\r\n    <b-input-group :prepend=\"searchvalue.toString()\">\r\n      <b-form-input type=\"search\" v-model=\"searchtext\" @keyup.enter=\"buscar\" />\r\n      <b-input-group-append>\r\n        <b-button\r\n          text=\"Button\"\r\n          variant=\"primary\"\r\n          :disabled=\"!dirty\"\r\n          @click=\"buscar\"\r\n          >Buscar</b-button\r\n        >\r\n      </b-input-group-append>\r\n    </b-input-group>\r\n\r\n    <b-modal\r\n      :id=\"modalid\"\r\n      okOnly\r\n      size=\"xl\"\r\n      scrollable\r\n      no-close-on-backdrop\r\n      :title=\"title\"\r\n    >\r\n      <TableEditApi\r\n        :items=\"data\"\r\n        :page=\"1\"\r\n        :perPage=\"10\"\r\n        :buttons=\"[]\"\r\n        @evt-page=\"evtpage\"\r\n        @evt-select=\"evtselect\"\r\n      />\r\n    </b-modal>\r\n  </div>\r\n</template>\r\n<script>\r\nimport API from \"../services/api.service\";\r\nimport TableEditApi from \"./TableEditApi.vue\";\r\nexport default {\r\n  name: \"SearchAPI3\",\r\n  components: {\r\n    TableEditApi,\r\n  },\r\n  props: {\r\n    value: {\r\n      type: String,\r\n      default: \"\",\r\n    },\r\n    title: {\r\n      type: String,\r\n      default: \"Pesquisar...\",\r\n    },\r\n    route: {\r\n      type: String,\r\n      default: \"\",\r\n    },\r\n    lookup: {\r\n      type: Object,\r\n      default() {\r\n        return { value: \"value\", text: \"text\" };\r\n      },\r\n    },\r\n  },\r\n  data() {\r\n    return {\r\n      searchvalue: 0,\r\n      searchtext: this.value || \"\",\r\n      searchflds: this.lookup,\r\n      data: [],\r\n      dirty: false,\r\n      modalid: `modal_${\r\n        Math.random(32)\r\n          .toString(32)\r\n          .split(\".\")[1]\r\n      }`,\r\n    };\r\n  },\r\n  computed: {\r\n    params() {\r\n      return {\r\n        pesquisa: this.searchtext,\r\n        body: this.searchtext,\r\n      };\r\n    },\r\n    api() {\r\n      return `https://api.grupok1.com.br/api/v2/${this.route}`;\r\n    },\r\n  },\r\n  methods: {\r\n    buscar() {\r\n      /*\r\n      const data = {\r\n        Success: true,\r\n        Data: [\r\n          { marca: \"IDELLI\", id: 2 },\r\n          { marca: \"MY HOME\", id: 6 },\r\n        ],\r\n      };\r\n      this.data = data.Data;\r\n      if (this.data.length == 1) {\r\n        this.selectdata(this.data);\r\n      } else {\r\n        this.$bvModal.show(this.modalid);\r\n      }\r\n      */\r\n      if (this.dirty) {\r\n        API.post(this.route, this.params).then((res) => {\r\n          if (res.data.Success) {\r\n            this.data = res.data.Data;\r\n            if (this.data.length == 1) {\r\n              this.selectdata(this.data);\r\n            } else {\r\n              this.$bvModal.show(this.modalid);\r\n            }\r\n          } else {\r\n            this.data = [];\r\n          }\r\n        });\r\n      }\r\n    },\r\n    evtselect(data) {\r\n      console.log(\"evtselect:\", data);\r\n      this.selectdata(data);\r\n      this.$bvModal.hide(this.modalid);\r\n    },\r\n    evtpage(data) {\r\n      console.log(\"evtpage:\", data);\r\n    },\r\n    selectdata(data) {\r\n      this.searchvalue = data[0][this.searchflds.value].toString();\r\n      this.searchtext = data[0][this.searchflds.text];\r\n      this.$emit(\"input\", this.searchvalue);\r\n      this.dirty = false;\r\n    },\r\n  },\r\n  watch: {\r\n    searchtext(text) {\r\n      this.dirty = true;\r\n      if (text == \"\") this.searchvalue = \"0\";\r\n    },\r\n  },\r\n};\r\n</script>\r\n"]}]}